<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>gagl</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">

    <script type="module">
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

        window.supabase = createClient(
            "https://piafesfywtvpachbfoxr.supabase.co",
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBpYWZlc2Z5d3R2cGFjaGJmb3hyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ3ODQwMTgsImV4cCI6MjA2MDM2MDAxOH0.1aDNwRZXac48nD9HDicXvDYk4wfcY1MC487_qf3hF5c"
        );

    </script>

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: black;
            margin: 0;
            padding: 0;
            color: white;
            display: flex;
            /* justify-content: center; */
            align-items: center;
            flex-direction: column;
            height: 100vh;
            font-size: 14px;
            /* position: fixed; */
            /* 화면고정배치 스크롤해도 안움직임 */
            /* justify-content: space-between; */
            /* 양쪽정렬 */
            font-weight: 500;
        }

        .가로정렬 {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .세로정렬 {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
        }

        .양쪽정렬 {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            gap: 10px;
        }

        .사백픽셀 {
            width: 400px;
            min-width: 400px;
            max-width: 400px;
        }

        .버튼 {
            border-radius: 5px;
            padding: 5px;
            text-align: center;
        }

        .공격버튼 {
            margin-top: 15px;
            background-color: #fafafa;
            color: black;
            border-radius: 5px;
            padding: 7px 17px;
            text-align: center;
        }

        .공격버튼:hover {
            background-color: #9e9e9e;
            cursor: pointer;
        }

        .레어몬스터 {
            margin-top: 7px;
            background-color: #a853f7;
            color: black;
            border-radius: 5px;
            padding: 7px 17px;
            text-align: center;
        }

        .레어몬스터:hover {
            background-color: #9019ff;
            cursor: pointer;
        }

        .보스몬스터 {
            margin-top: 7px;
            margin-bottom: 7px;
            background-color: #f753b8;
            color: black;
            border-radius: 5px;
            padding: 7px 17px;
            text-align: center;
        }

        .보스몬스터:hover {
            background-color: #f753b8;
            cursor: pointer;
        }

        .버튼:hover {
            background-color: #333;
            cursor: pointer;
        }

        .커서호버:hover {
            cursor: pointer;
        }

        .밑줄 {
            border-bottom: 0.2px solid #4b4b4b;
            width: 100%;
            height: 56px;
            min-height: 56px;
            /* ✅ 추가 */
            max-height: 56px;
            /* ✅ 추가 */
            display: flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
            /* ✅ 추가 */
            overflow: hidden;
            /* ✅ 추가 */
        }

        .사백픽셀테두리 {
            margin-top: 15px;
            width: 400px;
            border: 0.2px solid #4b4b4b;
            border-radius: 10px;
            padding: 15px;
        }

        .기본테두리 {
            margin-top: 15px;
            width: 100%;
            box-sizing: border-box;
            border: 0.2px solid #4b4b4b;
            border-radius: 10px;
            padding: 15px;
        }

        .타락테두리 {
            border: 0.2px solid #CD7F32;
            /* 브론즈 색 */
            box-shadow: 0 0 10px #CD7F32;
        }

        .타락텍스트 {
            color: #CD7F32;
            font-weight: bold;

        }

        .에너지바 {
            background-color: #eab308;
            height: 5px;
            border-radius: 10px;
            width: 100%;
        }

        .유저테두리 {
            border: 0.2px solid #3b82f6;
            border-radius: 10px;
            padding: 15px;
            /* width: 100%; */
        }

        .몬스터테두리 {
            border: 0.2px solid #f63b3b;
            border-radius: 10px;
            padding: 15px;
            /* width: 100%; */

        }

        .경험치골드숙련도 {
            background-color: #121212;
            height: 85px;
            border-radius: 10px;
            width: 100px;
            padding: 15px;
        }

        .레벨 {
            color: #00c851;
        }

        .총경험치 {
            color: #ffffff;
            font-size: 16px;
            font-weight: bold;
        }

        .획득경험치 {
            color: #7a7a7a;
            font-size: 10px;
            font-weight: lighter;
        }

        .골드 {
            color: #b0b0b0;
        }

        .총골드 {
            color: #f5c400;
            font-size: 16px;
            font-weight: bold;
        }

        .획득골드 {
            color: #00c851;
            font-size: 10px;
            font-weight: lighter;
        }

        .숙련도 {
            color: #b0b0b0;
        }

        .총숙련도 {
            color: #3b82f6;
            font-size: 16px;
            font-weight: bold;
        }

        .획득숙련도 {
            color: #00c851;
            font-size: 10px;
            font-weight: lighter;
        }

        .콘솔로그창 {
            color: #ffffff;
            border-radius: 10px;
            position: fixed;
            left: 0;
            bottom: 0;
            font-weight: bold;
        }

        .로딩컨테이너 {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-family: sans-serif;
            font-size: 16px;
        }

        .로딩스피너 {
            width: 50px;
            height: 50px;
            border: 6px solid #ccc;
            border-top-color: #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .네온박스 {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;

            width: 320px;
            padding: 10px 20px;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            color: #c653ff;
            border-radius: 10px;

            background-color: black;
            background-image: linear-gradient(to right, rgba(198, 83, 255, 0.15), rgba(255, 0, 150, 0.15));
            background-blend-mode: overlay;

            box-shadow:
                0 0 8px 0px rgba(198, 83, 255, 0.5),
                0 0 14px 0px rgba(255, 0, 150, 0.4),
                inset 0 0 4px #000;

            animation: 네온펄스 1.5s ease-in-out infinite alternate;
        }


        @keyframes 네온펄스 {
            0% {
                box-shadow:
                    0 0 15px 5px rgba(198, 83, 255, 0.3),
                    0 0 30px 5px rgba(255, 0, 150, 0.2),
                    inset 0 0 6px #000;
                color: #b366ff;
            }

            100% {
                box-shadow:
                    0 0 10px 10px rgba(198, 83, 255, 0.5),
                    0 0 50px 10px rgba(255, 0, 150, 0.4),
                    inset 0 0 10px #000;
                color: #ff99ff;
            }
        }

        .유물드랍박스 {
            position: fixed;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;

            width: 320px;
            padding: 10px 20px;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            color: #ffd700;
            /* 골드 */

            border-radius: 10px;

            background-color: black;
            background-image: linear-gradient(to right, rgba(255, 215, 0, 0.15), rgba(255, 255, 255, 0.1));
            background-blend-mode: overlay;

            box-shadow:
                0 0 10px 0px rgba(255, 215, 0, 0.5),
                0 0 16px 0px rgba(255, 255, 255, 0.4),
                inset 0 0 4px #000;

            animation: 유물네온펄스 1.5s ease-in-out infinite alternate;
        }

        @keyframes 유물네온펄스 {
            0% {
                box-shadow:
                    0 0 18px 6px rgba(255, 215, 0, 0.4),
                    0 0 30px 6px rgba(255, 255, 255, 0.2),
                    inset 0 0 6px #000;
                color: #ffe066;
                /* 밝은 골드 */
            }

            100% {
                box-shadow:
                    0 0 14px 10px rgba(255, 215, 0, 0.6),
                    0 0 40px 12px rgba(255, 255, 255, 0.5),
                    inset 0 0 10px #000;
                color: #ffffff;
                /* 하얀색 */
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* 
        #사냥로그박스 {
            max-height: 220px;
            overflow-y: hidden;
        } */

        /* 자동으로 사라지게 하는 페이드 아웃 */
        @keyframes fadeOut {
            0% {
                opacity: 1;
            }

            70% {
                opacity: 1;
            }

            100% {
                opacity: 0;
                display: none;
            }
        }



        #승리패배로그 {
            font-size: 16px;
            margin-top: 10px;
        }

        #획득로그 {
            color: #00c851;
        }

        #레벨업표시 {
            color: #00c851;
        }

        #층조절 {
            background: transparent;
            /* 내부 배경 제거 */
            border: 2px solid #ff3300;
            box-shadow:
                0 0 12px #ff0000,
                /* 바깥쪽 발광 효과 */
                0 0 24px #440000,
                /* 바깥쪽 어두운 발광 */
                0 0 0 4px rgba(255, 0, 0, 0.2) inset;
            /* 안쪽 테두리 강조 */
            animation: 마계불길 4s ease-in-out infinite;
            gap: 30px;
            position: relative;
            border-radius: 10px;
            /* 둥글게 유지 */
            color: white;
        }

        @keyframes 마계불길 {

            0%,
            100% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.3);
            }
        }

        .crown-icon {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }

        .금 {
            stroke: gold;
        }

        .은 {
            stroke: silver;
        }

        .동 {
            stroke: #cd7f32;
        }

        #보유숙련도:hover {
            cursor: pointer;
            text-decoration: underline;
            color: #3b82f6;
        }

        .target-icon {
            width: 16px;
            height: 16px;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            margin-right: 4px;
        }

        .내아이디강조 {
            background-color: #505050;
            /* font-weight: bold; */
            border-radius: 6px;
        }

        .색상실험 {
            background-color: #8b5cf6;
            background-color: #3bf0f6;
            background-color: #5cf669;
            background-color: #f6ec5c;
        }

        #전투버튼박스 {
            position: relative;
            /* ✅ 추가 */
        }

        #전투화면 {
            position: relative;
        }

        .자동사냥 {
            border-radius: 5px;
            padding: 5px;
            background-color: #fafafa;
            color: black;
        }

        @keyframes 악마강림효과 {
            0% {
                box-shadow: 0 0 10px 5px red, inset 0 0 10px red;
                filter: brightness(1.5) blur(0px);
            }

            50% {
                box-shadow: 0 0 20px 10px darkred, inset 0 0 20px darkred;
                filter: brightness(2) blur(1px);
                transform: scale(1.02) rotate(1deg);
            }

            100% {
                box-shadow: 0 0 10px 5px red, inset 0 0 10px red;
                filter: brightness(1.2) blur(0px);
                transform: scale(1) rotate(0deg);
            }
        }

        * {
            user-select: none;
        }

        @keyframes 깜빡임 {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }

        html {
            overflow-y: scroll;
            /* 스크롤 항상 표시 */
        }

        .마법의팔레트가글 {
            background: linear-gradient(90deg, #ff6ec4, #7873f5, #4adede, #4adede, #ff6ec4);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        @keyframes 무지개흐름 {
            to {
                background-position: 200% center;
            }
        }

        .마법의팔레트지옥 {
            background: linear-gradient(90deg, #8a0404, #8B0000, #FF0000, #FF8C00, #6e0202);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트블라섬 {
            background: linear-gradient(90deg, #ffe6f0, #ffb6c1, #ff69b4, #ffa7c4, #ffe6f0);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트숲 {
            background: linear-gradient(90deg, #1e9f8d, #08e0c7, #52d1c2, #a6e5de, #21a58f);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트겨울 {
            background: linear-gradient(90deg, #7d96ff, #c6efff, #ffe1f0, #a9dfff, #2eb2ff);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }


        #유물컨테이너 {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            /* ✅ 중앙정렬 */
        }


        /* css추가 */
    </style>
</head>

<body>
    <div style="position: fixed; top: 6px; left: 10px; display: flex; align-items: center; z-index: 9999;">
        <div id="버전표시" style="color: #bebebe; font-size: 20px; opacity: 0.8; cursor: pointer;">
        </div>
        <span id="메뉴얼힌트" style="margin-left: 8px; color: #bebebe; font-size: 14px; animation: 깜빡임 1.2s infinite;">
            &lt;&lt; 클릭 시 메뉴얼 오픈
        </span>
    </div>
    <div class="네온박스" id="네온박스">
        gagl에 찾아와주셔서 감사합니다
    </div>
    <div class="유물드랍박스" id="유물드랍박스" style="display: none;">

    </div>


    <div class="밑줄" id="상단바">
        <div class="사백픽셀">
            <div class="양쪽정렬">
                <div id="타이틀을아이디로" class="커서호버">gagl</div>

                <div id="전투스킬설정버튼" style="display: none;">
                    <div class="가로정렬">
                        <div class="버튼" id="전투">전투</div>
                        <div class="버튼" id="장비">장비</div>
                        <div class="버튼" id="유물">유물</div>
                        <div class="버튼" id="보스">보스</div>
                        <div class="버튼" id="전당">전당</div>
                        <div class="버튼" id="탈퇴" onclick="회원탈퇴()">탈퇴</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="사백픽셀테두리 세로정렬" id="에너지박스" style="display: none;">
        <div class="양쪽정렬">
            <div style="color: #eab308;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-zap-icon lucide-zap">
                    <path
                        d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z" />
                </svg>
            </div>
            <div id="스태미너표시" style="color: white;">
                ♾️
            </div>
        </div>
        <div class="에너지바">

        </div>
    </div>



    <div id="유물화면" style="display: none;">
        <div class="사백픽셀테두리" id="유물컨테이너">

        </div>
    </div>

    <div id="보스화면" style="display: none;">
        <div id="보스컨테이너" style="justify-content: flex-start;">
            <div id="보스아이콘">

            </div>
            <div id="누적데미지순위">

            </div>
        </div>

        <div id="보스사냥컨테이너">
            <div class="사백픽셀테두리 세로정렬">
                <div class="보스몬스터" id="보스몬스터">
                </div>
                <div id="최종데미지">
                </div>

            </div>

        </div>

    </div>

    <div id="전직화면" style="display: none;">
        <div id="전직컨테이너" class="세로정렬">
            <div id="전직화면타이틀" class="밑줄" style="text-align: left; font-weight: bold;  font-size: 24px;">
                전직
            </div>
            <div class="양쪽정렬" id="경험치와포인트">

            </div>

        </div>
    </div>




    <div id="인증화면" class="사백픽셀테두리 세로정렬">
        <input id="이메일입력" type="text" placeholder="한글x, 영문아이디 입력" autocomplete="off" />
        <input id="비번입력" type="password" placeholder="비밀번호 입력" autocomplete="off" />
        <button onclick="회원가입()">회원가입</button>
        <button onclick="로그인()">로그인</button>
    </div>



    <div id="전투화면" style="display: none;">
        <div class="사백픽셀테두리 가로정렬" id="층조절">
            <div id="아래층으로">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-arrow-big-down-dash-icon lucide-arrow-big-down-dash">
                    <path d="M15 5H9" />
                    <path d="M15 9v3h4l-7 7-7-7h4V9z" />
                </svg>
            </div>
            <div id="현재층">
                1층
            </div>
            <div id="위층으로">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-arrow-big-up-dash-icon lucide-arrow-big-up-dash">
                    <path d="M9 19h6" />
                    <path d="M9 15v-3H5l7-7 7 7h-4v3H9z" />
                </svg>
            </div>

        </div>

        <div id="사냥결과1">
            <div class="사백픽셀테두리 세로정렬">
                <div class="가로정렬">
                    <div class="경험치골드숙련도 세로정렬" id="경험치테두리안표시">
                        <div class="레벨" id="레벨">
                            레벨 129
                        </div>
                        <div class="총경험치 커서호버" id="총경험치">
                            12,932
                        </div>
                        <div class="획득경험치" id="획득경험치">
                            45
                        </div>
                    </div>
                    <div class="경험치골드숙련도 세로정렬" id="골드테두리안표시">
                        <div class="골드" id="골드">
                            골드
                        </div>
                        <div class="총골드 커서호버" id="총골드">
                            999,999
                        </div>
                        <div class="획득골드" id="획득골드">
                            999
                        </div>

                    </div>
                    <div class="경험치골드숙련도 세로정렬" id="숙련도테두리안표시">
                        <div class="숙련도" id="숙련도">
                            숙련도
                        </div>
                        <div class="총숙련도 커서호버" id="총숙련도">
                            999,999
                        </div>
                        <div class="획득숙련도" id="획득숙련도">
                            999
                        </div>

                    </div>
                </div>
            </div>

            <div class="사백픽셀테두리 세로정렬" id="등급외테두리">
                <div class="세로정렬" id="전투버튼박스">
                    <div>
                        <div style="display: inline-block;" class="공격버튼" id="공격버튼">악마성</div>
                    </div>
                    <div style="display: none;" class="레어몬스터" id="레어몬스터">레어몬스터</div>

                </div>


                <div class="가로정렬" id="승리패배로그">
                </div>
                <div class="가로정렬" id="획득로그">
                </div>
                <div class="가로정렬" id="추가획득로그">
                </div>

                <div class="가로정렬" id="레벨업표시">

                </div>
            </div>
        </div>

        <div class="사백픽셀테두리 유저테두리 양쪽정렬" id="유저테두리안표시">
            <div id="유저아이디">
                영자
            </div>
            <div class="세로정렬">
                <div id="유저공격력">
                    공격력 100
                </div>
                <div id="유저체력">
                    체력 100
                </div>
            </div>

        </div>
        <div id="몬스터테두리안표시">
            <div class="사백픽셀테두리 몬스터테두리 양쪽정렬">
                <div id="악마이름">
                    몬스터
                </div>
                <div class="세로정렬">
                    <div id="악마체력">
                        체력 100
                    </div>
                    <div id="악마방어력">
                        방어력 10
                    </div>
                </div>

            </div>
        </div>

    </div>

    <div id="전당화면" style="display: none;">
        <div id="전당컨테이너" class="사백픽셀테두리 세로정렬">
        </div>
    </div>



    <div id="블로커" style="
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0);
  z-index: 9999;
  display: none;
  cursor: wait;
"></div>

    <div id="장비화면" style="display: none;">
        <div class="밑줄 양쪽정렬">
            <div>강림카운트</div>
            <div style="flex: 1; display: flex; justify-content: flex-end;">
                <div id="장비목록"></div>
            </div>
        </div>

        <div id="장비골드표시" style="color: #f5c400;">0 Gold</div>

        <div class="사백픽셀테두리 세로정렬" id="장비컨테이너">
        </div>
    </div>

    <div id="스킬화면" style="display: none;">
        <div class="밑줄" id="보유숙련도">

        </div>
        <div style="font-size: 12px; color: #888" id="필요숙련도">

        </div>

        <div class="사백픽셀테두리" id="스킬컨테이너">
        </div>
    </div>

    <div id="미니장비창" class="사백픽셀테두리" style="
    position: fixed;
    top: 57px;
    left: 300px;
    z-index: 99999;
    background: black;
    color: white;
    display: none;
    max-height: 600px;
    overflow-y: auto;
  "></div>

    <div id="메시지표시박스" style="
    position: fixed;
    top: 0;
    left: 40%;
    right: 40%;
    height: 50%;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
    padding: 10px;
    box-sizing: border-box;
    pointer-events: none;
"></div>

    <!-- 기존 도박창 div -->
    <div id="도박창" class="기본테두리 세로정렬" style="
  display: none;
  position: absolute;
  background: black;
  color: white;
  z-index: 9998;
  padding: 20px;
  text-align: center;
  width: auto;
">
        <div id="도박타이틀" style="font-size: 20px; font-weight: bold;"></div>
        <div style="margin-top: 15px;">
            <!-- <div class="버튼" onclick="도박시도('일반')">일반 (2만)</div>
            <div class="버튼" onclick="도박시도('레어')">레어 (4만)</div>
            <div class="버튼" onclick="도박시도('신화')">신화 (8만)</div> -->
            <div class="버튼" onclick="도박시도('고대')">고대 (16만)</div>
            <div class="버튼" onclick="도박시도('태초')">태초 (32만)</div>
            <div class="버튼" onclick="도박시도('공허')">공허 (64만)</div>
            <div class="버튼" onclick="도박시도('타락')">타락 (128만)</div>
        </div>
    </div>


    <!-- 객체추가 -->

    <script>
        // 최초 접속 시 기기ID를 localStorage에 저장
        let 기기ID = localStorage.getItem("기기ID");

        if (!기기ID) {
            기기ID = crypto.randomUUID();  // 브라우저 내장 UUID 생성기
            localStorage.setItem("기기ID", 기기ID);
        }

        window.addEventListener("load", () => {
            setTimeout(() => {
                document.getElementById("네온박스").style.display = "none";
            }, 3000);
        });

        const 색상맵 = {
            "일반": "#c8c8c8",
            "레어": "#00c000",
            "신화": "#0000ff",
            "고대": "#c8c800",
            "태초": "#800080",
            "공허": "#ff0000",
            "타락": "#CD7F32",

            "빨": "#ff0000",
            "주": "#ff8000",
            "노": "#ffff00",
            "초": "#00ff00",
            "파": "#0080ff",
            "남": "#8a2be2",
            "보": "#800080",

            "빨주": "#ff4000",
            "주노": "#ffbf00",
            "노초": "#80ff00",
            "초파": "#00ff80",
            "파남": "#4455d0",
            "남보": "#851bb1"
        };

        //루시드아이콘콘
        const 크리티컬아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-axe-icon lucide-axe"><path d="m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9"/><path d="M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z"/></svg>`;
        const 버서커아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>`;
        const 드레인아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-droplet-icon lucide-droplet"><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z"/></svg>`;
        const 인사이트아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-diamond-plus-icon lucide-diamond-plus"><path d="M12 8v8"/><path d="M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41L13.7 2.71a2.41 2.41 0 0 0-3.41 0z"/><path d="M8 12h8"/></svg>`;
        const 아이언바디아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-biceps-flexed-icon lucide-biceps-flexed"><path d="M12.409 13.017A5 5 0 0 1 22 15c0 3.866-4 7-9 7-4.077 0-8.153-.82-10.371-2.462-.426-.316-.631-.832-.62-1.362C2.118 12.723 2.627 2 10 2a3 3 0 0 1 3 3 2 2 0 0 1-2 2c-1.105 0-1.64-.444-2-1"/><path d="M15 14a5 5 0 0 0-7.584 2"/><path d="M9.964 6.825C8.019 7.977 9.5 13 8 15"/></svg>`;
        const 퀵니스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-history-icon lucide-history"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>`;
        const 발굴아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gem-icon lucide-gem"><path d="M6 3h12l4 6-10 13L2 9Z"/><path d="M11 3 8 9l4 13 4-13-3-6"/><path d="M2 9h20"/></svg>`;
        const 머니아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-coins-icon lucide-coins"><circle cx="8" cy="8" r="6"/><path d="M18.09 10.37A6 6 0 1 1 10.34 18"/><path d="M7 6h1v4"/><path d="m16.71 13.88.7.71-2.82 2.82"/></svg>`;
        const 성공아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-party-popper-icon lucide-party-popper"><path d="M5.8 11.3 2 22l10.7-3.79"/><path d="M4 3h.01"/><path d="M22 8h.01"/><path d="M15 2h.01"/><path d="M22 20h.01"/><path d="m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10"/><path d="m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17"/><path d="m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7"/><path d="M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z"/></svg>`;
        const 실패아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ban-icon lucide-ban"><circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/></svg>`;
        const 마스터아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-graduation-cap-icon lucide-graduation-cap"><path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z"/><path d="M22 10v6"/><path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5"/></svg>`;
        const 버닝아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-battery-charging-icon lucide-battery-charging"><path d="M15 7h1a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-2"/><path d="M6 7H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h1"/><path d="m11 7-3 5h4l-3 5"/><line x1="22" x2="22" y1="11" y2="13"/></svg>`;
        const 도박아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dices-icon lucide-dices"><rect width="12" height="12" x="2" y="10" rx="2" ry="2"/><path d="m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6"/><path d="M6 18h.01"/><path d="M10 14h.01"/><path d="M15 6h.01"/><path d="M18 9h.01"/></svg>`;
        const 인텔리전스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-plus-icon lucide-copy-plus"><line x1="15" x2="15" y1="12" y2="18"/><line x1="12" x2="18" y1="15" y2="15"/><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>`;
        const 브로큰아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield-off-icon lucide-shield-off"><path d="m2 2 20 20"/><path d="M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71"/><path d="M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264"/></svg>`;
        const 공격력아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-swords-icon lucide-swords"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" x2="19" y1="19" y2="13"/><line x1="16" x2="20" y1="16" y2="20"/><line x1="19" x2="21" y1="21" y2="19"/><polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5"/><line x1="5" x2="9" y1="14" y2="18"/><line x1="7" x2="4" y1="17" y2="20"/><line x1="3" x2="5" y1="19" y2="21"/></svg>`;
        const 체력아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-icon lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>`;
        const 즉사아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-skull-icon lucide-skull"><path d="m12.5 17-.5-1-.5 1h1z"/><path d="M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z"/><circle cx="15" cy="12" r="1"/><circle cx="9" cy="12" r="1"/></svg>`;

        //유물아이콘
        const 소드아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sword-icon lucide-sword"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" x2="19" y1="19" y2="13"/><line x1="16" x2="20" y1="16" y2="20"/><line x1="19" x2="21" y1="21" y2="19"/></svg>`;
        const 하트플러스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-plus-icon lucide-heart-plus"><path d="M13.5 19.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5A5.5 5.5 0 0 1 7.5 3c1.76 0 3 .5 4.5 2 1.5-1.5 2.74-2 4.5-2a5.5 5.5 0 0 1 5.402 6.5"/><path d="M15 15h6"/><path d="M18 12v6"/></svg>`;
        const 고스트아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost-icon lucide-ghost"><path d="M9 10h.01"/><path d="M15 10h.01"/><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"/></svg>`;
        const 쉴드밴아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield-ban-icon lucide-shield-ban"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/><path d="m4.243 5.21 14.39 12.472"/></svg>`;
        const 하트마이너스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-minus-icon lucide-heart-minus"><path d="M13.5 19.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5A5.5 5.5 0 0 1 7.5 3c1.76 0 3 .5 4.5 2 1.5-1.5 2.74-2 4.5-2a5.5 5.5 0 0 1 5.402 6.5"/><path d="M15 15h6"/></svg>`;
        const 엑스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-axe-icon lucide-axe"><path d="m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9"/><path d="M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z"/></svg>`;
        const 암포라아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-amphora-icon lucide-amphora"><path d="M10 2v5.632c0 .424-.272.795-.653.982A6 6 0 0 0 6 14c.006 4 3 7 5 8"/><path d="M10 5H8a2 2 0 0 0 0 4h.68"/><path d="M14 2v5.632c0 .424.272.795.652.982A6 6 0 0 1 18 14c0 4-3 7-5 8"/><path d="M14 5h2a2 2 0 0 1 0 4h-.68"/><path d="M18 22H6"/><path d="M9 2h6"/></svg>`;
        const 모루아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-anvil-icon lucide-anvil"><path d="M7 10H6a4 4 0 0 1-4-4 1 1 0 0 1 1-1h4"/><path d="M7 5a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1 7 7 0 0 1-7 7H8a1 1 0 0 1-1-1z"/><path d="M9 12v5"/><path d="M15 12v5"/><path d="M5 20a3 3 0 0 1 3-3h8a3 3 0 0 1 3 3 1 1 0 0 1-1 1H6a1 1 0 0 1-1-1"/></svg>`;
        const 클로버아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clover-icon lucide-clover"><path d="M16.17 7.83 2 22"/><path d="M4.02 12a2.827 2.827 0 1 1 3.81-4.17A2.827 2.827 0 1 1 12 4.02a2.827 2.827 0 1 1 4.17 3.81A2.827 2.827 0 1 1 19.98 12a2.827 2.827 0 1 1-3.81 4.17A2.827 2.827 0 1 1 12 19.98a2.827 2.827 0 1 1-4.17-3.81A1 1 0 1 1 4 12"/><path d="m7.83 7.83 8.34 8.34"/></svg>`;
        const 플라워아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flower-icon lucide-flower"><circle cx="12" cy="12" r="3"/><path d="M12 16.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 1 1 12 7.5a4.5 4.5 0 1 1 4.5 4.5 4.5 4.5 0 1 1-4.5 4.5"/><path d="M12 7.5V9"/><path d="M7.5 12H9"/><path d="M16.5 12H15"/><path d="M12 16.5V15"/><path d="m8 8 1.88 1.88"/><path d="M14.12 9.88 16 8"/><path d="m8 16 1.88-1.88"/><path d="M14.12 14.12 16 16"/></svg>`;
        const 모래시계아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hourglass-icon lucide-hourglass"><path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"/><path d="M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"/></svg>`;
        const 퍼즐아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-puzzle-icon lucide-puzzle"><path d="M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z"/></svg>`;
        const 로켓아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rocket-icon lucide-rocket"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>`;
        const 표창아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-fan-icon lucide-fan"><path d="M10.827 16.379a6.082 6.082 0 0 1-8.618-7.002l5.412 1.45a6.082 6.082 0 0 1 7.002-8.618l-1.45 5.412a6.082 6.082 0 0 1 8.618 7.002l-5.412-1.45a6.082 6.082 0 0 1-7.002 8.618l1.45-5.412Z"/><path d="M12 12v.01"/></svg>`;
        const 봄아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flower2-icon lucide-flower-2"><path d="M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1"/><circle cx="12" cy="8" r="2"/><path d="M12 10v12"/><path d="M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z"/><path d="M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z"/></svg>`;
        const 여름아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-icon lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>`;
        const 가을아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-leaf-icon lucide-leaf"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></svg>`;
        const 겨울아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-snowflake-icon lucide-snowflake"><path d="m10 20-1.25-2.5L6 18"/><path d="M10 4 8.75 6.5 6 6"/><path d="m14 20 1.25-2.5L18 18"/><path d="m14 4 1.25 2.5L18 6"/><path d="m17 21-3-6h-4"/><path d="m17 3-3 6 1.5 3"/><path d="M2 12h6.5L10 9"/><path d="m20 10-1.5 2 1.5 2"/><path d="M22 12h-6.5L14 15"/><path d="m4 10 1.5 2L4 14"/><path d="m7 21 3-6-1.5-3"/><path d="m7 3 3 6h4"/></svg>`;
        const 다이노아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 200; width: 200px;"><path d="M0 0h512v512H0z" fill="#000" fill-opacity="1"></path><g class="" transform="translate(0,0)" style=""><path d="m236.375 34.5-18.53 2.406 5.06 39.407c-9.114 1.973-18.22 4.657-27.28 8.062l-9.5-40.156-18.188 4.31 10.25 43.345a218.543 218.543 0 0 0-25.093 14.344l-17.28-42.876L118.5 70.31l19.03 47.22a206.258 206.258 0 0 0-14.25 12.468L89.47 89.625l-14.345 12 35.22 42.063a195.014 195.014 0 0 0-12.97 16.78L53.47 133.5l-9.782 15.938 43.874 26.906a193.797 193.797 0 0 0-9.812 20.53l-47.53-12.81-4.845 18.06L71.5 214.532a200.305 200.305 0 0 0-7.344 36.345l-39.656-2.25-1.03 18.688 39.56 2.218a207.24 207.24 0 0 0 2.47 35.19L31.375 311l3.375 18.375 34.47-6.344c2.885 11.524 6.74 22.782 11.56 33.595l-26.31 11.97 7.75 17 27-12.283A192.58 192.58 0 0 0 110 403.126l-20.53 16.813 11.843 14.468 21.5-17.625a184.811 184.811 0 0 0 29.406 23.126L141.53 456l15.564 10.344 11.437-17.22c11.12 5.558 23.014 10.1 35.626 13.47l3.563-17.72c-10.315-2.77-20.055-6.39-29.19-10.812l7.47-11.25-15.563-10.343-8.28 12.467c-9.12-5.807-17.506-12.456-25.157-19.78l13.906-11.407-11.844-14.438-14.843 12.157a177.534 177.534 0 0 1-18-25.908l22.5-10.25-7.75-17-23.19 10.563a188.384 188.384 0 0 1-10.218-29.22l32.313-5.967-3.375-18.375-32.72 6.03a188.112 188.112 0 0 1-2.25-30.78l40.032 2.25 1.063-18.657-39.97-2.25c.73-6.54 1.805-13.07 3.25-19.53 4.226.572 9.16 1.176 15.064 1.843 14.326 1.616 32.835 3.446 51.155 5.186 29.98 2.848 49.638 4.533 59.375 5.375l-33.063 72.345-5.78 12.656 1.343.064L234.563 365l9.406-16.156-29.94-17.375 51.782 2.092.75-18.687-49.343-2 33.593-13.22-6.844-17.405-35.407 13.938L234 240.53l5.5-12.06-13.22-1.126s-35.88-3.062-72.405-6.53c-18.263-1.736-36.696-3.565-50.813-5.158-4.618-.52-8.52-1.014-12.03-1.47 9.83-29.017 27.474-56.23 53.812-78.5l20.937 52 17.345-7-22.875-56.75c.296-.202.578-.42.875-.624a207.016 207.016 0 0 1 21.47-12.812l18.874 79.906 18.186-4.28-19.72-83.5c8.432-3.326 16.87-5.95 25.314-7.876l11.78 91.75 18.532-2.375-11.875-92.53c8.964-1.012 17.896-1.247 26.75-.814l3 96.19 18.688-.595-.344-11.25 34.22 39.28-37.28 17.064 7.78 17 32.313-14.782-15.688 32.343 16.813 8.19L353.344 226l2.72-5.563-4.064-4.656-41.375-47.468 50.53-47.843c23.78 15.006 45.428 35.18 63.533 59.343-23.814 6.14-44.022 24.153-50.688 53.718l47 103.064 16.875-2.406-26.938-68.625 17.407-6.844 28.562 72.75 34.813-5-8.408-138.626c-11.76-6.55-24.637-9.992-37.312-10.375a280.675 280.675 0 0 0-14.47-19.19l18.564-18.686-13.25-13.156-17.72 17.812a260.514 260.514 0 0 0-15.78-15.28l18.125-27.314-15.595-10.312-17 25.656a238.895 238.895 0 0 0-18.656-12.906l10.56-31.844-17.75-5.875-9.374 28.28a216.306 216.306 0 0 0-21.906-9.75l3.156-33.686-18.625-1.75-2.75 29.5a195.525 195.525 0 0 0-24.905-5.126l-.938-30.188L269 44.22l.875 27.936c-1.664-.064-3.33-.105-5-.125-1.19-.013-2.37-.007-3.563 0-6.633.05-13.29.455-19.968 1.22l-4.97-38.75zm52.844 58.22a179.002 179.002 0 0 1 22.53 5.155l-4.438 47.406.407.032-16.376 15.5-2.125-68.093zm40.717 11.56a198.143 198.143 0 0 1 14.25 6.532l-16.312 15.438 2.063-21.97zM441.5 195.5c.786-.023 1.572.006 2.375.063 12.852.9 22.34 11.843 21.438 24.687-.902 12.84-11.836 22.34-24.688 21.438-12.852-.902-22.34-11.848-21.438-24.688.845-12.037 10.52-21.152 22.313-21.5zM328.25 439.563a292.03 292.03 0 0 1-15.625 4.28l4 18.282c5.63-1.356 11.322-2.9 17.094-4.656l-5.47-17.908zm-33.906 8.093a238.418 238.418 0 0 1-20.97 2.656l.376 18.532a250.825 250.825 0 0 0 24.563-2.938l-3.97-18.25zM226 448.75l-3.594 17.78c10.464 1.76 21.356 2.75 32.656 2.876l-.375-18.344c-9.96-.06-19.515-.87-28.687-2.312z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 그루트아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"><path d="M0 0h512v512H0z" fill="#000" fill-opacity="1"></path><g class="" transform="translate(0,0)" style=""><path d="m125.5 24.44-15.2 9.64c4.7 7.36 4.1 9.89 2.6 12.91-8.4 11.18-22.25 15.83-32.31 23.89-6.38 5.2-12.53 13.64-10.92 23.76 2.17 13.46 12.66 22.56 23.15 29.76 12.38-.5 25.48.6 36.18.6l.2-.4c-11-5.5-39.08-21.1-41.75-32.85C97.5 75.04 120.3 71.43 128.9 55.13c4.3-8.5 3.4-19.93-3.4-30.69zm92.8.3c-1.8 17.62-4.3 32.04-7.1 44.98l28.3 17.12-33.5 5.31c-3.3 12.75-5.7 22.95-8.4 34.55-10.5 5-22.1 9.4-32.2 12 12.6 6.5 25.2 14.8 30.5 28.1 3.6 8.8 2.1 17.9-.9 25.7-2.9 7.7-7.3 14.8-11.2 21.4-3.9 6.6-7.2 12.7-8.5 17.3.4 23 31.4 26.9 47.4 22.7 1.1-6.6 5.6-13 9.8-17.2-7.4-2.6-14.7-6.3-20.1-12.9-5.9-7.2-7.8-18.4-3.2-29.1 3.7-6.6 11.1-10.7 17.6-11.7 11.5-.9 22.3 1.4 32.8 4.3.8-6.9 2.2-14 4.9-20.3 2.1-4.9 5.5-9.9 10.4-12.9l-11-10.8-17.5 16.5-17.6-17.5-16.8 13 7.3-44.6 14.1 14.7 10.2-15.1 9.1 21.1 18.2-26.5 7.7 47.4c2.7-1 5.3-1.3 7.9-1.3 8.1.5 14.9 5.5 19.3 11.3 5 7.3 8.5 15.4 10.7 22.7 1.4-.8 2.7-1.5 4.1-2.3 6.3-3.3 12.8-6.4 19.5-8-23.2-6.9-27.4-26-28.1-48.7-9.4-.8-16.4-.6-25.6-.4-2-11.2-3.6-23.2-4.8-33.07l-33.8-5.33 30.8-18.68c-1.9-13.34-4.4-26.41-8.9-39.3-14.4 3.78-33 3.98-51.4-4.48zm165.1 22.69s-37.8 20.36-34.6 36.93c1 5.29 5.3 10.28 10.7 13.98-2.5 6.06-3.5 12.06-3.9 18.16 5.9 1.8 11.6 3.8 17.2 5.9-.8-6.3-1.2-12.6-.6-18.8 5.2 1.1 10.3.6 14.1-1.9 15-10.11-2.9-54.27-2.9-54.27zm-53.2 81.07c2.2 14.8 2.2 27.2 17.4 29.4 14.6 3.3 29.9-2.2 42.2 1.2-2.1-4.2-4.2-8.5-6.1-12.8-17.3-7.4-34.3-14.1-53.5-17.8zm-226.1 13.9c-6.18 13.7-12.41 27.3-18.42 40.9-3.84-3-8.01-5.6-12.87-7.5 1.19-6.5.56-13.1-2.54-17.5-3.33-4.7-10.35-6.3-18.12-6.3-14.84-.1-32.45 5.5-32.45 5.5s19.21 43.5 36.96 39.9c4.45-1 8.29-4.3 11.18-8.8 3.97 3.1 7.5 6.8 10.82 10.8-9.36 22-17.81 44-24.12 66.5 21.79 2 39.71 9.7 55.46 19.4 8-32.7 15.2-60.4 30.3-84.9l29.1 2.4c4.3-8.4 13.5-19.9 9.9-29.2-13.1-16.5-29.9-23.6-49.1-30.5-9.2 0-17.7-.5-26.1-.7zm177 31.7c-1.4 3.3-2.6 8.2-3.3 13.4 3.5-1.1 7.2-1.7 11-1.7 3.3 0 6.4.4 9.4 1.2-1.9-5.5-4.3-10.6-6.7-13.8-5-6.6-8.2-4.2-10.4.9zm78.4 2.4c2.5 1.5 4.8 3.8 6.3 6.5 5.2 9.2 2.5 20-2.7 27.5-.8 1.1-1.6 2.3-2.5 3.3l40.2 68.1c1.7-8.8 3.5-20.4 4.7-33 2.4-26.1.2-55.5-9.3-67.2-9.6-8.6-24.9-5.6-36.7-5.2zm-13.4 15.3c-4.2.7-10.7 3.4-16.9 6.8-1.8 1-3.6 2-5.2 3 5.9 2.6 11.3 5.4 15.5 7.9 3.7-3.2 6.9-6.4 8.8-9.2 3.2-5.6 4.2-9.7-2.2-8.5zm-120.3 10c-4.2 3.5-1.8 7.8.5 10.6 2.3 2.7 7.6 5.9 14 8 3.9 1.2 8.1 2.2 11.9 2.9.1-6.5 1.6-13.3 4.2-18.2-7.9-2.2-25-6.2-30.6-3.3zm63 2c-10.5 0-18.6 8-18.6 17.8s8.1 17.8 18.6 17.8c10.5 0 18.6-8 18.6-17.8s-8.1-17.8-18.6-17.8zm135.7 9.9c.8 12.3 0 25-1.1 36.9-1.3 13.6-3.3 26-5.1 35.3 16.2-8.2 28.3-19.6 37.2-33.9-10.8-12.5-21.2-25.2-31-38.3zm-97.8 9.3c-3.3 6.4-4.3 13.9-8 19.1 3.4 3.1 7.5 6.5 12.3 10 5.3 3.8 10.9 7 14.8 8.3 7.2 3.3 9.8-7.3 8.6-11.6-1-3.9-4.8-9-10-13.6-6.1-5.4-12.6-9.3-17.7-12.2zM258 240.8c-6.3 4-14.7 7.6-17.4 15.1-1.1 6.1 5.7 14.7 12.2 13.2 8-3.6 12.7-10 16.8-17.1-4.7-2.8-8.6-6.6-11.6-11.2zm46.8 13c-4.7 2.2-10 3.5-15.5 3.6 1.7 10.3 4.1 29.9 11.4 35 8.7.7 9.9-33.4 4.1-38.6zm-136.2 4.9c-3.4 16.9-6.8 34-10.4 51 10.9 7.3 22.5 16.2 30.5 25 6.9 7.7 12.5 16.4 13.5 26.7.8 8.9-3.4 16.6-8.5 22.1s-11.1 9.8-16.7 13.9-10.7 7.9-13.6 11.2c-2.9 3.4-3.5 5.1-3 7.6 1.9 3.8 8.6 5.1 12.6 6.4 4.4 1.3 9.3 2.7 14.2 5.2 4.9 2.4 10.1 6.4 12.6 12.9v.1c6.9-48 12.3-90.5 27.5-128.5l51.8-1.4c3.9 14.9 7.9 30.8 11.3 43.7 9.1 13 18.4 25.9 30.7 35.2 6 4.4 11.2 6.3 14.9 6.1 5-10.9 8-25.1 19.8-27.9 5.2-1.1 10.3-1 15.3.1-4.3-10.6-8.4-21.1-12.4-31.7-8.4 3.9-18 7.5-28.3 4.7-12.6-3.4-21-13.3-27.7-24.2-1.3-2.2-2.6-4.4-3.8-6.7-7.5-.8-12.9-6.1-16.5-11.7-4-7.5-6.6-15.3-8.2-22.6-4.6 4.8-10.2 9.1-17.4 10.8-13.5.3-24.3-5.2-30.3-15.2-7.6 2-14.9 2.9-21.8 2.6-14.1-.6-26.4-6.2-36.1-15.4zm301.7 3.6c-3.4 5.4-7.2 10.4-11.5 15.1l10.9 3.7 4.8 30.4 17.8-2.8-6.6-41.2zm-145.8 7.2c-.1 8-.8 16.2-3.4 23.7-1.2 3.6-2.8 7-5.4 10 4.5 7.7 11.1 18.1 19.3 20.5 1.9.5 9.9-1.2 17.2-4.2-5.5-14.7-11-29.2-16.6-43.8-3.9-1.7-7.6-3.8-11.1-6.2zm-277.31 14-23.9 46.8 16.04 8.2 26.85-52.6c-5.92-1.4-12.22-2.2-18.99-2.4zm25.07 3.9-14.89 39.2-6.19 35.3 17.72 3.2 5.91-33.7L89.03 294c-5.33-2.6-10.88-4.8-16.77-6.6zm372.14 3.3c-4.7 3.6-9.7 6.8-15 9.8l29.2 48.9 15.4-9.2zm-349.93 6.2 2.64 39.7-14.34 18.6 14.26 11 18.47-24-2.2-33.1c-6.2-4.5-13-9-18.83-12.2zm324.03 8.9c-6.4 2.7-11.3 4.3-17.6 6.3l1.3 18.5 22.3 17.1 11-14.2-15.9-12.3zm-264.4 22.9c-3 14-6.1 27.9-9.4 41.9-14 22.5-35.4 46.8-53.15 56.4-9.69 5.3-17.05 6.2-22.71 3.4-5.67-2.8-12.14-10.9-16.34-29.5l-17.56 4c4.82 21.4 13.3 35.4 25.9 41.6 12.6 6.3 26.8 3.2 39.36-3.7 11.6-6.4 22.9-16.1 33.2-27.3-5.7 21.3-11.9 42.6-18.8 64 18.1 11.4 40.3 7.7 63 2.5 5-13.4 7.7-28.9 5.4-34.9-.4-.9-1.2-1.9-3.9-3.3-2.7-1.3-6.8-2.6-11.4-4-4.5-1.4-9.4-2.8-14.2-5.6-4.7-2.9-9.6-8-10.9-14.8-1.5-8.9 2.4-16.9 7.2-22.6 4.9-5.6 11-9.9 16.6-14 5.6-4.1 10.8-8 14-11.4 3.2-3.5 4.1-5.7 3.8-8.3v-.1c-.4-4.2-3.5-10.2-8.9-16.3-5.5-6.1-13-12.3-20.6-17.6-.2-.1-.4-.3-.6-.4zm202 65.6c-2.9 9.2-8.7 18.5-17.9 19.6-10.4 1-19.7-3.6-27.8-9.6-3-2.3-6-4.8-8.8-7.4 8.1 28.7 17.4 56.9 30.1 84.2 39.8 9.8 69.2 6.5 98 2.5-12.4-19-23.1-38.3-32.8-57.7 6.3-1.1 12.5-2.7 18.6-6 4.2 5 9.6 8.7 15 9.1 16.7 1.4 33-38.3 33-38.3s-17.9-5.1-33.4-5c-9.3 0-17.8 1.9-20.9 7.9-2.2 4-2 9.2-.4 14.2-6.5 1.4-13.2 1.6-19.9 1.4-2.6-5.5-5.1-11.1-7.5-16.6-14.3-9.3-20.2-13.7-25.3 1.7z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 락골렘아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"><path d="M0 0h512v512H0z" fill="#000" fill-opacity="1"></path><g class="" transform="translate(0,0)" style=""><path d="m227.7 25-57.9 57.96L183.4 151h145.2l13.6-68.04-32.8-32.84L282.5 64l16.3-24.53L284.3 25h-56.6zM195 88.44 240 111l-4 17h-41V88.44zm122 0V128h-41l-4-17 32-16.05 13-6.51zM154 109.1l-22 11 10.6 17.1-24.1-10.4L73 149.6v16l91.8-13.1-10.8-43.4zm204 0-10.8 43.4 91.8 13.1v-16l-81-40.5zm-152.4 60.1-63.3 4.7-6.6 1-9.2 62.3 50.2 25.1 44.5-14.8 5.6 17-51.5 17.2-44.4-22.2 20.4 84.5 95.7 13.6V196.8l-41.4-27.6zm100.8 0L265 196.8v160.8l95.7-13.6 20.4-84.5-23.8 11.9-19.6 38.6-18.8-34.2-33.7-11.3 5.6-17 44.5 14.8 50.2-25.1-9.2-62.3-6.6-1-63.3-4.7zm-189.6 8.4-61.32 8.7-30.04 40.1 3.64 25.5 25.38 10.4L33.09 280l6.47 45.3L103 312.7v-57.4l13.8-77.7zm278.4 0 13.8 77.6v57.4l52 10.4 13.7-13.7 11.9-82.9-30.1-40.1-28-4-4.2 17.9-9.9-19.9-19.2-2.7zM104.1 330.8 42.78 343l28 126 47.42-11.8-14.1-126.4zm303.8 0-14.1 126.4 22.6 5.6 7.9-25.8 17.8 28.1L469.2 343l-61.3-12.2zm-256 31.4L138.1 487h80.3l37.6-75.1 37.6 75.1h30.8l11.6-23 11.5 23h26.4l-13.8-124.8L256 377.1l-41.9-6-6.1 34.4-15.3-37.5-40.8-5.8z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 미노타우르스아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"><path d="M0 0h512v512H0z" fill="#000" fill-opacity="1"></path><g class="" transform="translate(0,0)" style=""><path d="M110 18.906c-3.766 9.014-2.938 15.91-2.938 28.032 0 26.995 24.076 48.413 52.563 52.562 19.28 2.807 39.315 4.758 59.594 5.813-8.56 7.39-13.907 18.092-13.907 35.124 0 17.576 6.436 37.856 16.562 52.97 10.126 15.112 23.233 24.374 36.03 24.374 12.8 0 25.906-9.26 36.033-24.374 10.126-15.113 16.562-35.392 16.562-52.97 0-17.186-5.43-27.946-14.125-35.342 19.053-1.09 37.854-2.952 56-5.594 28.487-4.147 51.47-23.72 52.563-52.563.368-9.723-1.637-18.74-2.938-28.03-2.943 27.71-26.205 45.69-54.313 49.656-59.833 8.443-123.54 8.443-183.375 0-28.107-3.966-51.37-21.945-54.312-49.657zm79.78 99.313c-248.928 7.213-200.628 194.293-22.124 242.5 40.812-39.456-6.55-101.937-43.72-57.033-23.22-43.474-20.674-82.77 4.5-95.03 48.72 27.067 83.566 88.52 86.126 148.405-33.595 23.148-59.625 63.032-59.625 63.032l26.344 38.78-41.31 23.5h82.124c-40.513-40.52-11.77-86.093 36.22-86.093 48.645 0 74.12 48.22 36.248 86.095h81.282l-40.47-23.5 26.345-38.78s-26.458-40.502-60.44-63.564c2.744-59.716 37.52-120.887 86.095-147.874 25.176 12.262 27.722 51.557 4.5 95.03-37.168-44.903-84.53 17.578-43.72 57.033 178.5-48.206 226.788-235.28-22.124-242.5 2.054 6.73 3.158 14.17 3.158 22.218 0 21.95-7.423 45.024-19.72 63.375-12.295 18.35-30.17 32.656-51.562 32.656-21.392 0-39.266-14.306-51.562-32.657-12.296-18.352-19.72-41.426-19.72-63.375 0-8.048 1.105-15.488 3.157-22.22z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 서클체크아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-check-big-icon lucide-circle-check-big"><path d="M21.801 10A10 10 0 1 1 17 3.335"/><path d="m9 11 3 3L22 4"/></svg>'

        const 아이콘맵 = {
            크리티컬아이콘,
            드레인아이콘,
            버서커아이콘,
            아이언바디아이콘,
            인사이트아이콘,
            퀵니스아이콘,
            발굴아이콘,
            머니아이콘,
            성공아이콘,
            실패아이콘,
            마스터아이콘,
            버닝아이콘,
            도박아이콘,
            인텔리전스아이콘,
            브로큰아이콘,
            즉사아이콘,
            소드아이콘,
            하트플러스아이콘,
            고스트아이콘,
            쉴드밴아이콘,
            하트마이너스아이콘,
            엑스아이콘,
            암포라아이콘,
            모루아이콘,
            클로버아이콘,
            플라워아이콘,
            모래시계아이콘,
            퍼즐아이콘,
            로켓아이콘,
            표창아이콘,
            봄아이콘,
            여름아이콘,
            가을아이콘,
            겨울아이콘,
            서클체크아이콘,
            다이노아이콘,
            그루트아이콘,
            락골렘아이콘,
            미노타우르스아이콘,
        };

        function 화면잠금() {
            document.body.style.pointerEvents = "none";
            document.body.style.opacity = "0.5";
            const 버튼들 = document.querySelectorAll("button");
            버튼들.forEach(btn => btn.disabled = true);
        }

        function 화면해제() {
            document.body.style.pointerEvents = "auto";
            document.body.style.opacity = "1";
            const 버튼들 = document.querySelectorAll("button");
            버튼들.forEach(btn => btn.disabled = false);
        }

        function 공격버튼잠금() {
            const 공격버튼 = document.getElementById("공격버튼");
            const 레어몬스터 = document.getElementById("레어몬스터");
            const 보스몬스터 = document.getElementById("보스몬스터");

            if (공격버튼) {
                공격버튼.style.pointerEvents = "none";
                공격버튼.style.opacity = "0.5"; // 시각적 효과
            }

            if (레어몬스터) {
                레어몬스터.style.pointerEvents = "none";
                레어몬스터.style.opacity = "0.5"; // 시각적 효과
            }

            if (보스몬스터) {
                보스몬스터.style.pointerEvents = "none";
                보스몬스터.style.opacity = "0.5"; // 시각적 효과
            }
        }

        function 공격버튼잠금해제() {
            const 공격버튼 = document.getElementById("공격버튼");
            const 레어몬스터 = document.getElementById("레어몬스터");
            const 보스몬스터 = document.getElementById("보스몬스터");

            if (공격버튼) {
                공격버튼.style.pointerEvents = "auto";
                공격버튼.style.opacity = "1";
            }

            if (레어몬스터) {
                레어몬스터.style.pointerEvents = "auto";
                레어몬스터.style.opacity = "1";
            }

            if (보스몬스터) {
                보스몬스터.style.pointerEvents = "auto";
                보스몬스터.style.opacity = "1";
            }
        }

        function 메시지표시(대상, 아이콘HTML, 텍스트, 글자색) {
            // const 대상 = document.getElementById("층조절");
            const rect = 대상.getBoundingClientRect();

            const el = document.createElement("div");
            el.innerHTML = `
        ${아이콘HTML}<span>${텍스트}</span>
    `;
            el.style.position = "absolute";
            el.style.left = `${rect.left + Math.random() * rect.width}px`;
            el.style.top = `${rect.top + Math.random() * rect.height}px`;
            el.style.color = 글자색;
            // el.style.background = ;
            el.style.padding = "8px 12px";
            el.style.borderRadius = "8px";
            // el.style.background = "rgba(0,0,0,0.7)";
            el.style.fontWeight = "bold";
            el.style.zIndex = 9999;
            el.style.pointerEvents = "none";
            el.style.animation = "fadeOut 2s ease-out forwards";
            el.style.whiteSpace = "nowrap";

            document.body.appendChild(el);
            setTimeout(() => el.remove(), 2000);
        }

        async function 회원가입() {
            화면잠금();

            const 아이디 = document.getElementById("이메일입력").value.trim();
            const 비번 = document.getElementById("비번입력").value.trim();
            const 이메일형식 = `${아이디}@gagl.com`;
            const 유저아이디 = 아이디;
            const 기기ID = localStorage.getItem("기기ID") || crypto.randomUUID();

            localStorage.setItem("기기ID", 기기ID);
            // const 허용기기ID = "010d9bbb-58ba-4f19-b12b-d0a7850d94bd";

            // if (기기ID !== 허용기기ID) {
            //     메시지표시(메시지표시박스, "❌", "회원가입이 제한된 상태입니다", "#ef4444");
            //     화면해제();
            //     return;
            // }

            const 아이디패턴 = /^[a-zA-Z0-9_]{3,12}$/;
            if (!아이디패턴.test(아이디)) {
                메시지표시(메시지표시박스, "❌", "아이디는 영문/숫자/밑줄 포함 3~12자여야 합니다", "#ef4444");
                화면해제();
                return;
            }

            try {
                const { data, error } = await supabase.auth.signUp({
                    email: 이메일형식,
                    password: 비번
                });

                if (error || !data.user) {
                    메시지표시(메시지표시박스, "❌", "회원가입 실패: " + error.message, "#ef4444");
                    화면해제();
                    return;
                }

                // ✅ 세션 초기화 후 로그인
                await supabase.auth.signOut();
                await supabase.auth.signInWithPassword({ email: 이메일형식, password: 비번 });

                const { data: { user }, error: 로그인오류 } = await supabase.auth.getUser();
                if (로그인오류 || !user) {
                    메시지표시(메시지표시박스, "❌", "재로그인 실패", "#ef4444");
                    화면해제();
                    return;
                }

                const 유저UID = user.id;

                const 응답 = await fetch("/register-user", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID, 유저아이디, 기기ID, 로그인이메일: 이메일형식 })
                });

                const 결과 = await 응답.json();

                if (!응답.ok) {
                    메시지표시(메시지표시박스, "❌", 결과.오류 || "서버 오류", "#ef4444");
                    화면해제();
                    return;
                }

                메시지표시(메시지표시박스, "✅", "회원가입 성공! 자동 로그인 완료", "#00c851");
                유저데이터 = 결과.유저데이터;

                // ✅ DOM이 완전히 준비된 이후 안전하게 화면 표시
                if (document.readyState === "complete" || document.readyState === "interactive") {
                    전투화면보여주기(유저데이터);
                } else {
                    document.addEventListener("DOMContentLoaded", () => {
                        전투화면보여주기(유저데이터);
                    });
                }

            } catch (e) {
                메시지표시(메시지표시박스, "❌", "예외 오류 발생: " + e.message, "#ef4444");
            }

            화면해제();
        }

        async function 로그인() {
            화면잠금();

            const 아이디 = document.getElementById("이메일입력").value.trim();
            const 비번 = document.getElementById("비번입력").value.trim();
            const 이메일형식 = `${아이디}@gagl.com`;

            if (!아이디 || !비번) {
                메시지표시(메시지표시박스, "⚠️", "아이디와 비밀번호를 입력하세요", "#ef4444");
                화면해제();
                return;
            }

            try {
                const { error: 로그인오류 } = await supabase.auth.signInWithPassword({
                    email: 이메일형식,
                    password: 비번
                });

                if (로그인오류) {
                    메시지표시(메시지표시박스, "", "로그인 실패: " + 로그인오류.message, "#ef4444");
                    화면해제();
                    return;
                }

                const { data: { user } } = await supabase.auth.getUser();
                if (!user || !user.id) {
                    메시지표시(메시지표시박스, "", "유저 인증 정보 없음", "#ef4444");
                    화면해제();
                    return;
                }

                const 응답 = await fetch("/get-user", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: user.id })
                });

                const 결과 = await 응답.json();
                const 유저정보 = 결과.유저데이터;

                if (!유저정보) {
                    메시지표시(메시지표시박스, "⚠️", "유저 정보가 존재하지 않습니다", "#ef4444");
                    화면해제();
                    return;
                }

                유저데이터 = {
                    ...유저정보,
                    스킬: 유저정보.스킬 || {},
                    조우기록: 유저정보.조우기록 || { 일반: 0, 레어: 0, 신화: 0, 고대: 0, 태초: 0, 공허: 0, 타락: 0 },
                    합성기록: 유저정보.합성기록 || {},
                    장비목록: 유저정보.장비목록 || [],
                    몇마리죽였나: 유저정보.킬카운트 || 0,
                    강림몬스터: 유저정보.강림몬스터 || null
                };

                메시지표시(메시지표시박스, "✅", "로그인 성공!", "#00c851");
                전투화면보여주기(유저데이터);

            } catch (e) {
                메시지표시(메시지표시박스, "", "오류 발생: " + e.message, "#ef4444");
            } finally {
                화면해제();
            }
        }

        async function 회원탈퇴() {
            const 확인 = confirm("돌이킬 수 없는 판단을 하시겠습니까?");
            if (!확인) return; // ❗ 확인 안 하면 탈퇴 중단

            화면잠금();

            try {
                const {
                    data: { user }
                } = await supabase.auth.getUser();

                if (!user) {
                    메시지표시(메시지표시박스, "", "로그인 정보 없음", "#ef4444");
                    return;
                }

                const 응답 = await fetch("/delete-user", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: user.id })
                });

                if (!응답.ok) {
                    console.warn("auth 삭제 실패", await 응답.text());
                }

                메시지표시(메시지표시박스, "✅", "탈퇴가 완료되었습니다.", "#00c851");

                await supabase.auth.signOut(); // 세션 삭제
                localStorage.removeItem("기기ID"); // UUID 삭제
                location.reload(); // 로그인 화면으로 새로고침

            } catch (e) {
                메시지표시(메시지표시박스, "", "탈퇴 중 오류 발생: " + e.message, "#ef4444");
            } finally {
                화면해제();
            }
        }

        document.getElementById("전투").addEventListener("click", () => {
            if (!유저데이터) return;
            전투화면보여주기(유저데이터);
        });

        async function 전투화면보여주기(유저) {
            모든화면숨기기();
            document.getElementById("전투화면").style.display = "block";
            document.getElementById("에너지박스").style.display = "block";


            const 최대 = 유저.최대스태미너 ?? 100;
            const 현재 = 유저.현재스태미너 ?? 0;

            // ✅ 스태미너 텍스트 표시
            const 스태미너표시 = document.getElementById("스태미너표시");
            if (스태미너표시) 스태미너표시.innerText = `${현재}/${최대}`;

            // ✅ 에너지바 길이 조절
            const 에너지바 = document.querySelector(".에너지바");
            if (에너지바) 에너지바.style.width = `${(현재 / 최대) * 100}%`;

            document.getElementById("등급외테두리").style.border = "0.2px solid #4b4b4b";
            // document.getElementById("레어몬스터").style.display = "inline-block";

            // document.getElementById("레어몬스터").style.display = "none";
            document.getElementById("인증화면").style.display = "none";

            let 닉네임표시 = 유저.유저아이디;

            const 팔레트 = 유저.마법의팔레트;
            if (팔레트 === "숲") {
                닉네임표시 = `<span class="마법의팔레트숲">${닉네임표시}</span>`;
            } else if (팔레트 === "지옥") {
                닉네임표시 = `<span class="마법의팔레트지옥">${닉네임표시}</span>`;
            } else if (팔레트 === "블라섬") {
                닉네임표시 = `<span class="마법의팔레트블라섬">${닉네임표시}</span>`;
            } else if (팔레트 === "가글") {
                닉네임표시 = `<span class="마법의팔레트가글">${닉네임표시}</span>`;
            } else if (팔레트 === "겨울") {
                닉네임표시 = `<span class="마법의팔레트겨울">${닉네임표시}</span>`;
            }

            document.getElementById("타이틀을아이디로").innerHTML = `${닉네임표시}`;
            document.getElementById("전투스킬설정버튼").style.display = "block";

            const 직위 = 최고전직명(유저.전직정보);
            document.getElementById("유저아이디").innerHTML = (직위 ? `[${직위}] ` : "") + (`${닉네임표시}` || "알 수 없음");
            document.getElementById("유저공격력").innerText = `공격력 ${유저.최종공격력 || 10}`;
            document.getElementById("유저체력").innerText = `체력 ${유저.남은체력}/${유저.최대체력}`;

            document.getElementById("몬스터테두리안표시").style.display = "none";
            document.getElementById("레벨").innerText = `레벨 ${유저.레벨 || 1}`;
            document.getElementById("총경험치").innerText = 유저.경험치?.toLocaleString() || "0";
            document.getElementById("총골드").innerText = (유저.골드 || 0).toLocaleString();
            document.getElementById("총숙련도").innerText = (유저.숙련도 || 0).toLocaleString();

            document.getElementById("획득경험치").innerText = "0";
            document.getElementById("획득골드").innerText = "0";
            document.getElementById("획득숙련도").innerText = "0";
            document.getElementById("승리패배로그").innerText = "";
            document.querySelectorAll(".전투로그컨테이너").forEach(e => e.remove());

            // 기본값 설정 (없을 수도 있음)
            if (!유저.현재층) 유저.현재층 = 1;

            document.getElementById("현재층").innerText = `${유저.현재층}층`;
        }

        function 최고전직명(전직정보) {
            const 전직순서 = ["백인장", "오백인장", "천인장", "만인장", "부장군", "장군", "대장군", "대사마", "승상", "후", "공", "제후", "왕", "황제", "천황", "제황", "태황", "천제"];

            let 마지막직위 = null;
            for (const 직위 of 전직순서) {
                if (전직정보?.[직위] === 1) {
                    마지막직위 = 직위;
                } else {
                    break;
                }
            }
            return 마지막직위;
        }


        // 풀자동사냥 구현중
        let 자동사냥허용 = false;
        let 풀자동사냥허용 = false;  // 기본값 false

        document.addEventListener("keydown", (e) => {
            if (e.altKey && e.key.toLowerCase() === "a") {
                풀자동사냥허용 = !풀자동사냥허용;

                if (풀자동사냥허용) {
                    자동사냥허용 = false;  // 기존 자동사냥 플래그는 끄기
                    document.getElementById("공격버튼").click(); // 시작 신호
                }
            }
        });


        document.getElementById("공격버튼").addEventListener("click", async () => {
            if (!유저데이터) return;

            if (!풀자동사냥허용) {
                자동사냥허용 = true;
            }

            if (레어몬스터 && getComputedStyle(레어몬스터).display === "block") {
                if (!풀자동사냥허용) {
                    자동사냥허용 = false;
                    return;
                }
            }

            공격버튼잠금();
            let 레어몬스터등장 = false;

            try {
                const 응답 = await fetch("/attack-normal", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저데이터 })
                });

                const 결과 = await 응답.json();
                const 등급외테두리 = document.getElementById("등급외테두리");

                // ✅ 스태미너 부족 시 처리
                if (결과.결과 === "불가") {
                    메시지표시(등급외테두리, 실패아이콘, 결과.메시지 || "스태미너 부족", "#ef4444");
                    화면해제();
                    자동사냥허용 = false;
                    풀자동사냥허용 = false;
                    return;
                }

                if (결과.스킬발동) {
                    if (결과.스킬발동.인사이트) {
                        메시지표시(숙련도테두리안표시, 인사이트아이콘, "", "#3b82f6");
                    }
                    if (결과.스킬발동.인텔리전스) {
                        메시지표시(경험치테두리안표시, 인텔리전스아이콘, "", "#00c851");
                    }
                    if (결과.스킬발동.발굴) {
                        메시지표시(골드테두리안표시, 발굴아이콘, "", "#f5c400");
                    }
                }


                // 기존 전투 로그 삭제
                const 기존로그들 = document.querySelectorAll(".전투로그컨테이너");
                기존로그들.forEach(e => e.remove());

                // 새로운 로그 생성
                if (결과.전투로그 && Array.isArray(결과.전투로그)) {
                    결과.전투로그.slice().reverse().forEach(로그 => {
                        const 로그컨테이너 = document.createElement("div");
                        로그컨테이너.className = "전투로그컨테이너";
                        로그컨테이너.style.marginTop = "15px";
                        로그컨테이너.style.border = "0.2px solid #4b4b4b";
                        로그컨테이너.style.borderRadius = "10px";
                        로그컨테이너.style.padding = "15px";

                        const 아이콘HTML = (로그.아이콘 || []).map(이름 => 아이콘맵[이름] || "").join(" ");

                        // 회복 로그는 데미지 표시 안 함
                        let 데미지텍스트 = "";
                        let 회복텍스트 = "";

                        if (로그.타입 === "공격") {
                            데미지텍스트 = `<span><span style="color: #f63b3b;">${로그.몬스터이름}</span>에게 ${로그.효과} 피해를 입혔다!</span>`;
                        } else if (로그.타입 === "회복") {
                            회복텍스트 = `<span><span style="color: #3b82f6;">${로그.유저아이디}</span> 체력 ${로그.효과} 회복</span>`;
                        }

                        로그컨테이너.innerHTML = `
            <div style="background: #4b4b4b; width: calc(100% + 30px); margin: -15px 0 0 -15px; padding: 6px 0; text-align: center; border-top-left-radius: 10px; border-top-right-radius: 10px;">
                <strong>Turn ${로그.턴}</strong>
            </div>

            <div class="가로정렬" style="margin: 4px 0; align-items: center; gap: 6px;">
                ${아이콘HTML}
                ${로그.타입 === "공격" ? 데미지텍스트 : ""}
                ${로그.타입 === "회복" ? 회복텍스트 : ""}
            </div>

<!-- 유저와 몬스터 정보 양쪽 정렬 -->
<div class="가로정렬" style="margin-top: 10px; justify-content: space-between; align-items: center; gap: 12px;">
    <div style="border: 0.2px solid #3b82f6; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.유저아이디}</div>
        <div>
            <div>공격력 ${로그.유저최종공격력}</div>
            <div>체력 ${로그.유저체력}/${로그.유저최대체력}</div>
        </div>
    </div>

    <div style="border: 0.2px solid #f63b3b; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.몬스터이름}</div>
        <div>
            <div>체력 ${Math.max(0, 로그.몬스터체력)}/${로그.몬스터최대체력}</div>
            <div>방어력 ${로그.몬스터방어력}</div>
        </div>
    </div>
</div>
        `;

                        const 타겟 = document.getElementById("몬스터테두리안표시");
                        if (타겟 && 타겟.parentNode) {
                            타겟.parentNode.insertBefore(로그컨테이너, 타겟.nextSibling);
                        }
                    });
                }

                if (결과.결과 === "패배") {
                    const 몬스터 = 결과.몬스터;
                    유저데이터 = 결과.유저데이터;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("획득경험치").innerText = "0";
                    document.getElementById("획득골드").innerText = "0";
                    document.getElementById("획득숙련도").innerText = "0";
                    document.getElementById("레벨업표시").innerText = "";
                    document.getElementById("획득로그").innerText = "";
                    document.getElementById("추가획득로그").innerText = "";

                    document.getElementById("유저체력").innerText = `체력 ${유저데이터.남은체력}/${유저데이터.최대체력}`;
                    document.getElementById("승리패배로그").innerText = "패배";
                    document.getElementById("승리패배로그").style.color = "#ef4444";
                } else {
                    const { 유저데이터: 새유저, 몬스터, 보상, 레벨업, 회복 } = 결과;
                    유저데이터 = 새유저;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    // document.getElementById("등급외테두리").style.border = `0.2px solid ${색상맵[몬스터.타입] || "#4b4b4b"}`;
                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("총경험치").innerText = 새유저.경험치.toLocaleString();
                    document.getElementById("총골드").innerText = 새유저.골드.toLocaleString();
                    document.getElementById("총숙련도").innerText = 새유저.숙련도.toLocaleString();
                    document.getElementById("획득경험치").innerText = `+${보상.경험치}`;
                    document.getElementById("획득골드").innerText = `+${보상.골드}`;
                    document.getElementById("획득숙련도").innerText = `+${보상.숙련도}`;
                    document.getElementById("레벨").innerText = `레벨 ${새유저.레벨}`;
                    document.getElementById("유저공격력").innerText = `공격력 ${새유저.최종공격력}`;
                    document.getElementById("유저체력").innerText = `체력 ${새유저.남은체력}/${새유저.최대체력}`;
                    document.getElementById("획득로그").innerText =
                        `${보상.경험치} EXP, ${보상.골드} Gold, ${보상.숙련도} 숙련도 획득`;
                    document.getElementById("추가획득로그").innerText = "";

                    if (레벨업.증가한레벨 > 0) {
                        document.getElementById("레벨업표시").innerText = `레벨 ${새유저.레벨} 달성!`;
                        document.getElementById("레벨업표시").style.color = "#3f84ec";
                    } else document.getElementById("레벨업표시").innerText = "";

                    if (결과.드랍유물) {
                        const 유물드랍박스 = document.getElementById("유물드랍박스");
                        const 유저테두리안표시 = document.getElementById("유저테두리안표시");

                        if (유물드랍박스) {
                            유물드랍박스.innerText = `유물 [${결과.드랍유물}]을(를) 획득했다!`;
                            유물드랍박스.style.display = "block";

                            // 위치 조정용 부모 변경
                            if (유저테두리안표시) {
                                // 등급외테두리에 위치 기준 설정
                                유저테두리안표시.style.position = "relative";

                                // 유물드랍박스를 등급외테두리 내부로 이동
                                유저테두리안표시.appendChild(유물드랍박스);

                                // 전투화면용 위치 조정
                                Object.assign(유물드랍박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100"
                                });
                            }
                        }
                        setTimeout(() => {
                            유물드랍박스.style.display = "none";
                        }, 3000);
                    }

                    document.getElementById("승리패배로그").innerText = "승리";
                    document.getElementById("승리패배로그").style.color = "#00c851";
                }

                const 레어몬스터 = document.getElementById("레어몬스터");

                if (결과.레어몬스터이름) {
                    document.getElementById("등급외테두리").style.border = "0.2px solid #c653ff";
                    레어몬스터.innerText = 결과.레어몬스터이름;
                    레어몬스터.style.display = "inline-block";
                    레어몬스터등장 = true;
                    자동사냥허용 = false;
                } else {
                    레어몬스터.style.display = "none";
                    document.getElementById("등급외테두리").style.border = "0.2px solid #4b4b4b";
                }


                // ✅ 유저데이터 변경 이후, 승리/패배 관계 없이 실행
                const 스태미너표시 = document.getElementById("스태미너표시");
                const 에너지바 = document.querySelector(".에너지바");
                if (스태미너표시 && 에너지바) {
                    const 최대 = 유저데이터.최대스태미너 ?? 100;
                    const 현재 = 유저데이터.현재스태미너 ?? 0;
                    스태미너표시.innerText = `${현재}/${최대}`;
                    에너지바.style.width = `${(현재 / 최대) * 100}%`;
                }
            } catch (e) {
                메시지표시(메시지표시박스, "", "전투 중 오류: " + e.message, "#ef4444");
                자동사냥허용 = false;
            } finally {
                if (레어몬스터등장) {
                    await new Promise(resolve => setTimeout(resolve, 1500)); // ✅ 1.5초 대기
                }
                공격버튼잠금해제();

                if (풀자동사냥허용) {
                    // 우선 레어몬스터 공격
                    const 레어 = document.getElementById("레어몬스터");
                    if (레어 && getComputedStyle(레어).display !== "none") {
                        레어.click();
                    } else {
                        document.getElementById("공격버튼").click();
                    }
                } else if (자동사냥허용) {
                    document.getElementById("공격버튼").click();
                }
            }

        });

        document.addEventListener("click", (e) => {
            // 공격버튼 또는 레어몬스터 버튼 누른 경우는 무시
            if (e.target.closest("#공격버튼") || e.target.closest("#레어몬스터")) return;

            자동사냥허용 = false;
            풀자동사냥허용 = false;
        });

        document.getElementById("레어몬스터").addEventListener("click", async () => {
            if (!유저데이터) return;

            const 이름 = document.getElementById("레어몬스터").innerText;
            공격버튼잠금();
            let 레어몬스터등장 = false;

            try {
                const 응답 = await fetch("/attack-rare", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저데이터, 레어몬스터이름: 이름 })
                });

                const 결과 = await 응답.json();
                const 등급외테두리 = document.getElementById("등급외테두리");

                // ✅ 스태미너 부족 시 처리
                if (결과.결과 === "불가") {
                    메시지표시(등급외테두리, 실패아이콘, 결과.메시지 || "스태미너 부족", "#ef4444");
                    화면해제();
                    자동사냥허용 = false;
                    풀자동사냥허용 = false;
                    return;
                }

                if (결과.스킬발동) {
                    if (결과.스킬발동.인사이트) {
                        메시지표시(숙련도테두리안표시, 인사이트아이콘, "", "#3b82f6");
                    }
                    if (결과.스킬발동.인텔리전스) {
                        메시지표시(경험치테두리안표시, 인텔리전스아이콘, "", "#00c851");
                    }
                    if (결과.스킬발동.발굴) {
                        메시지표시(골드테두리안표시, 발굴아이콘, "", "#f5c400");
                    }
                }

                // 기존 전투 로그 삭제
                const 기존로그들 = document.querySelectorAll(".전투로그컨테이너");
                기존로그들.forEach(e => e.remove());

                // 새로운 로그 생성
                if (결과.전투로그 && Array.isArray(결과.전투로그)) {
                    결과.전투로그.slice().reverse().forEach(로그 => {
                        const 로그컨테이너 = document.createElement("div");
                        로그컨테이너.className = "전투로그컨테이너";
                        로그컨테이너.style.marginTop = "15px";
                        로그컨테이너.style.border = "0.2px solid #4b4b4b";
                        로그컨테이너.style.borderRadius = "10px";
                        로그컨테이너.style.padding = "15px";

                        const 아이콘HTML = (로그.아이콘 || []).map(이름 => 아이콘맵[이름] || "").join(" ");

                        // 회복 로그는 데미지 표시 안 함
                        let 데미지텍스트 = "";
                        let 회복텍스트 = "";

                        if (로그.타입 === "공격") {
                            데미지텍스트 = `<span><span style="color: #f63b3b;">${로그.몬스터이름}</span>에게 ${로그.효과} 피해를 입혔다!</span>`;
                        } else if (로그.타입 === "회복") {
                            회복텍스트 = `<span><span style="color: #3b82f6;">${로그.유저아이디}</span> 체력 ${로그.효과} 회복</span>`;
                        }

                        로그컨테이너.innerHTML = `
            <div style="background: #4b4b4b; width: calc(100% + 30px); margin: -15px 0 0 -15px; padding: 6px 0; text-align: center; border-top-left-radius: 10px; border-top-right-radius: 10px;">
                <strong>Turn ${로그.턴}</strong>
            </div>

            <div class="가로정렬" style="margin: 4px 0; align-items: center; gap: 6px;">
                ${아이콘HTML}
                ${로그.타입 === "공격" ? 데미지텍스트 : ""}
                ${로그.타입 === "회복" ? 회복텍스트 : ""}
            </div>

<!-- 유저와 몬스터 정보 양쪽 정렬 -->
<div class="가로정렬" style="margin-top: 10px; justify-content: space-between; align-items: center; gap: 12px;">
    <div style="border: 0.2px solid #3b82f6; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.유저아이디}</div>
        <div>
            <div>공격력 ${로그.유저최종공격력}</div>
            <div>체력 ${로그.유저체력}/${로그.유저최대체력}</div>
        </div>
    </div>

    <div style="border: 0.2px solid #f63b3b; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.몬스터이름}</div>
        <div>
            <div>체력 ${로그.몬스터체력}/${로그.몬스터최대체력}</div>
            <div>방어력 ${로그.몬스터방어력}</div>
        </div>
    </div>
</div>
        `;

                        const 타겟 = document.getElementById("몬스터테두리안표시");
                        if (타겟 && 타겟.parentNode) {
                            타겟.parentNode.insertBefore(로그컨테이너, 타겟.nextSibling);
                        }
                    });
                }


                if (결과.결과 === "패배") {
                    const 몬스터 = 결과.몬스터;
                    유저데이터 = 결과.유저데이터;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    // document.getElementById("등급외테두리").style.border = `0.2px solid ${색상맵[몬스터.타입] || "#4b4b4b"}`;
                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("획득경험치").innerText = "0";
                    document.getElementById("획득골드").innerText = "0";
                    document.getElementById("획득숙련도").innerText = "0";
                    document.getElementById("레벨업표시").innerText = "";
                    document.getElementById("획득로그").innerText = "";
                    document.getElementById("추가획득로그").innerText = "";

                    document.getElementById("유저체력").innerText = `체력 ${유저데이터.남은체력}/${유저데이터.최대체력}`;
                    document.getElementById("승리패배로그").innerText = "패배";
                    document.getElementById("승리패배로그").style.color = "#ef4444";
                } else {
                    const { 유저데이터: 새유저, 몬스터, 보상, 레벨업, 회복 } = 결과;
                    유저데이터 = 새유저;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    // document.getElementById("등급외테두리").style.border = `0.2px solid ${색상맵[몬스터.타입] || "#4b4b4b"}`;
                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("총경험치").innerText = 새유저.경험치.toLocaleString();
                    document.getElementById("총골드").innerText = 새유저.골드.toLocaleString();
                    document.getElementById("총숙련도").innerText = 새유저.숙련도.toLocaleString();
                    document.getElementById("획득경험치").innerText = `+${보상.경험치}`;
                    document.getElementById("획득골드").innerText = `+${보상.골드}`;
                    document.getElementById("획득숙련도").innerText = `+${보상.숙련도}`;
                    document.getElementById("레벨").innerText = `레벨 ${새유저.레벨}`;
                    document.getElementById("유저공격력").innerText = `공격력 ${새유저.최종공격력}`;
                    document.getElementById("유저체력").innerText = `체력 ${새유저.남은체력}/${새유저.최대체력}`;
                    document.getElementById("획득로그").innerText =
                        `${보상.경험치} EXP, ${보상.골드} Gold, ${보상.숙련도} 숙련도 획득`;
                    document.getElementById("추가획득로그").innerHTML =
                        (결과.추가골드 > 0 ? `<span style="color: ${document.getElementById("보유골드")?.style.color || "#ffd700"};">추가획득 +${결과.추가골드} Gold</span> ` : "") +
                        (결과.추가숙련도 > 0 ? `<span style="color: #3b82f6;">추가획득 +${결과.추가숙련도} 숙련도</span>` : "");

                    if (레벨업.증가한레벨 > 0) {
                        document.getElementById("레벨업표시").innerText = `레벨 ${새유저.레벨} 달성!`;
                        document.getElementById("레벨업표시").style.color = "#3f84ec";
                    } else document.getElementById("레벨업표시").innerText = "";


                    if (결과.드랍장비) {
                        const 장비 = 결과.드랍장비;
                        const 네온박스 = document.getElementById("네온박스");
                        const 유저테두리안표시 = document.getElementById("유저테두리안표시");

                        if (네온박스) {
                            네온박스.innerText = `${장비.이름}을(를) 획득했다!`;
                            네온박스.style.display = "block";

                            // 위치 조정용 부모 변경
                            if (유저테두리안표시) {
                                // 유저테두리안표시에 위치 기준 설정
                                유저테두리안표시.style.position = "relative";

                                // 네온박스를 유저테두리안표시 내부로 이동
                                유저테두리안표시.appendChild(네온박스);

                                // 전투화면용 위치 조정
                                Object.assign(네온박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100"
                                });
                            }
                        }
                        setTimeout(() => {
                            네온박스.style.display = "none";
                        }, 3000);

                    }

                    if (결과.드랍유물) {
                        const 유물드랍박스 = document.getElementById("유물드랍박스");
                        const 유저테두리안표시 = document.getElementById("유저테두리안표시");

                        if (유물드랍박스) {
                            유물드랍박스.innerText = `유물 [${결과.드랍유물}]을(를) 획득했다!`;
                            유물드랍박스.style.display = "block";

                            // 위치 조정용 부모 변경
                            if (유저테두리안표시) {
                                // 유저테두리안표시에 위치 기준 설정
                                유저테두리안표시.style.position = "relative";

                                // 유물드랍박스를 유저테두리안표시 내부로 이동
                                유저테두리안표시.appendChild(유물드랍박스);

                                // 전투화면용 위치 조정
                                Object.assign(유물드랍박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100"
                                });
                            }
                        }
                        setTimeout(() => {
                            유물드랍박스.style.display = "none";
                        }, 3000);
                    }

                    document.getElementById("승리패배로그").innerText = "승리";
                    document.getElementById("승리패배로그").style.color = "#00c851";
                }

                const 레어몬스터 = document.getElementById("레어몬스터");

                if (결과.레어몬스터이름) {
                    레어몬스터.innerText = 결과.레어몬스터이름;
                    레어몬스터.style.display = "inline-block";
                    레어몬스터등장 = true;
                    document.getElementById("등급외테두리").style.border = "0.2px solid #c653ff";
                } else {
                    레어몬스터.style.display = "none";
                    document.getElementById("등급외테두리").style.border = "0.2px solid #4b4b4b";
                }

                // ✅ 유저데이터 변경 이후, 승리/패배 관계 없이 실행
                const 스태미너표시 = document.getElementById("스태미너표시");
                const 에너지바 = document.querySelector(".에너지바");
                if (스태미너표시 && 에너지바) {
                    const 최대 = 유저데이터.최대스태미너 ?? 100;
                    const 현재 = 유저데이터.현재스태미너 ?? 0;
                    스태미너표시.innerText = `${현재}/${최대}`;
                    에너지바.style.width = `${(현재 / 최대) * 100}%`;
                }

            } catch (e) {
                메시지표시(메시지표시박스, "", "레어 전투 오류: " + e.message, "#ef4444");
            } finally {
                if (레어몬스터등장) {
                    await new Promise(resolve => setTimeout(resolve, 1500)); // ✅ 1.5초 대기
                }
                공격버튼잠금해제();

                if (풀자동사냥허용) {
                    const 레어 = document.getElementById("레어몬스터");
                    if (레어 && getComputedStyle(레어).display !== "none") {
                        레어.click();
                    } else {
                        document.getElementById("공격버튼").click();
                    }
                }

            }

        });


        document.getElementById("장비").addEventListener("click", () => {
            if (!유저데이터) return;
            장비화면보여주기();
        });

        function 장비화면보여주기() {
            모든화면숨기기();
            document.getElementById("장비화면").style.display = "block";
            document.getElementById("획득로그").innerText = "";
            document.getElementById("추가획득로그").innerText = "";
            document.getElementById("레벨업표시").innerText = "";

            // 📌 조우 기록 표시
            const 기록 = 유저데이터.조우기록 || { 일반: 0, 레어: 0, 신화: 0, 고대: 0, 태초: 0, 공허: 0, 타락: 0 };
            document.getElementById("장비목록").innerText =
                `일반:${기록.일반} 레어:${기록.레어} 신화:${기록.신화} 고대:${기록.고대} 태초:${기록.태초} 공허:${기록.공허} 타락:${기록.타락}`;

            // 📌 골드/공격력/체력 표시
            document.getElementById("장비골드표시").innerHTML =
                `${머니아이콘} ${유저데이터.골드.toLocaleString()} Gold | ${공격력아이콘} 공격력 ${유저데이터.최종공격력} | ${체력아이콘} 최대체력 ${유저데이터.최대체력}`;

            // 📌 장비 컨테이너 정리
            const 장비컨테이너 = document.getElementById("장비컨테이너");
            장비컨테이너.innerHTML = "";

            const 장비목록 = 유저데이터.장비목록 || [];

            if (장비목록.length === 0) {
                장비컨테이너.innerText = "획득한 장비가 없습니다.";
                return;
            }

            const 등급우선순위 = {
                "일반": 1,
                "레어": 2,
                "신화": 3,
                "고대": 4,
                "태초": 5,
                "공허": 6,
                "타락": 7,
            };

            장비목록.sort((a, b) => {
                const 순서A = 등급우선순위[a.등급] || 999;
                const 순서B = 등급우선순위[b.등급] || 999;
                return 순서A - 순서B;
            });

            // 📌 장비 개별 렌더링
            장비목록.forEach(장비 => {
                const 박스 = document.createElement("div");
                박스.className = "기본테두리 양쪽정렬";
                박스.style.marginBottom = "8px";
                // 박스.style.border = `0.2px solid white`;
                박스.style.color = 색상맵[장비.등급] || "#fff";
                박스.style.fontWeight = "bold";

                // 박스.style.border = `0.2px solid ${색상맵[장비.등급] || "#fff"}`;
                // if (장비.등급 === "타락") {
                //     박스.classList.add("타락텍스트");
                // } else {
                //     // 박스.style.border = `0.2px solid ${색상맵[장비.등급] || "#fff"}`;
                //     박스.style.color = 색상맵[장비.등급] || "#fff";
                //     박스.style.fontWeight = "bold";
                // }

                const 키 = `${장비.이름}|${장비.등급}`;
                const 합성수 = 유저데이터.합성기록?.[키] ?? 0;
                const 강화표시 = 장비.강화 ? `+${장비.강화}` : "";
                const 이름표시 = `${장비.이름} (${합성수}) ${강화표시}`;

                //         박스.innerHTML = `
                //     <div>[${장비.등급}] ${이름표시}</div>
                //     <div>
                //         <svg onclick="장비강화('${장비.이름}', '${장비.등급}', this.closest('.기본테두리'))"
                //             xmlns="http://www.w3.org/2000/svg"
                //             width="16" height="16" viewBox="0 0 24 24" fill="none"
                //             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                //             style="cursor:pointer; margin-right: 4px;">
                //             <path d="m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9"/>
                //             <path d="m18 15 4-4"/>
                //             <path d="m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5"/>
                //         </svg>
                //         공격력 +${장비.공격력}
                //     </div>
                // `;

                박스.innerHTML = `
    <div>[${장비.등급}] ${이름표시}</div>
    <div>
        공격력 +${장비.공격력}
    </div>
`;


                장비컨테이너.appendChild(박스);
            });
        }

        async function 장비강화(이름, 등급, 박스) {
            if (!유저데이터 || !유저데이터.유저UID) return;

            const 강화비용 = {
                "일반": 10000,
                "레어": 30000,
                "신화": 100000,
                "고대": 200000,
                "태초": 300000,
                "공허": 400000,
                "타락": 1000000,
            }[등급];

            const 비용 = 강화비용;

            if ((유저데이터.골드 || 0) < 비용) {
                메시지표시(메시지표시박스, "", `골드 부족: ${비용.toLocaleString()} 필요`, "#ef4444");
                return;
            }

            const 확인 = confirm(`[${등급}] 장비를 ${비용} Gold로 강화하시겠습니까?`);
            if (!확인) return;

            화면잠금();

            try {
                const 응답 = await fetch("/upgrade-item", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID,
                        이름,
                        등급
                    })
                });

                const 결과 = await 응답.json();

                if (!응답.ok || 결과.오류) {
                    메시지표시(메시지표시박스, "", 결과.오류 || "강화 실패..", "#ef4444");
                    return;
                }

                // ✅ 메시지 출력
                메시지표시(박스, 결과.성공 ? "✅" : "", 결과.메시지, 결과.성공 ? "#00c851" : "#ef4444");

                // ✅ 항상 장비정보 갱신
                const 장비 = 유저데이터.장비목록.find(j => j.이름 === 이름 && j.등급 === 등급);
                if (장비) {
                    장비.강화 = 결과.강화;
                    장비.공격력 = 결과.무기공격력;
                }

                유저데이터.공격력 = 결과.공격력;
                유저데이터.장비공격력 = 결과.장비공격력;
                유저데이터.최종공격력 = 결과.최종공격력;
                유저데이터.골드 = 결과.골드;

                장비화면보여주기();
            } catch (e) {
                메시지표시(메시지표시박스, "", "오류: " + e.message, "#ef4444");
            } finally {
                화면해제();
            }
        }

        document.getElementById("총숙련도").addEventListener("click", () => {
            if (!유저데이터) return;
            스킬화면보여주기();
        });

        function 스킬정보불러오기() {
            return {
                인텔리전스: {
                    단계: ["알파 인텔리전스",
                        "베타 인텔리전스",
                        "감마 인텔리전스",
                        "델타 인텔리전스",
                        "엡실론 인텔리전스",
                        "제타 인텔리전스",
                        "에타 인텔리전스",
                        "쎄타 인텔리전스",
                        "아이오타 인텔리전스",
                        "카파 인텔리전스",
                        // "람다 인텔리전스",
                        // "뮤 인텔리전스",
                        // "뉴 인텔리전스",
                        // "크사이 인텔리전스",
                        // "오미크론 인텔리전스",
                        // "파이 인텔리전스",
                        // "로 인텔리전스",
                        // "시그마 인텔리전스",
                        // "타우 인텔리전스",
                        // "윕실론 인텔리전스",
                        // "카이 인텔리전스",
                        // "프사이 인텔리전스",
                        // "오메가 인텔리전스"
                    ],
                    설명: ["경험치 +5%",
                        "경험치 +10%",
                        "경험치 +15%",
                        "경험치 +20%",
                        "경험치 +25%",
                        "경험치 +30%",
                        "경험치 +35%",
                        "경험치 +40%",
                        "경험치 +45%",
                        "경험치 +50%"
                        // "경험치 +55%",
                        // "경험치 +60%",
                        // "경험치 +65%",
                        // "경험치 +70%",
                        // "경험치 +75%",
                        // "경험치 +80%",
                        // "경험치 +85%",
                        // "경험치 +90%",
                        // "경험치 +95%",
                        // "경험치 +100%",
                        // "경험치 +105%",
                        // "경험치 +110%",
                        // "경험치 +115%"
                    ],
                    아이콘: 인텔리전스아이콘
                },

                발굴: {
                    단계: ["루비 발굴", "사파이어 발굴", "에메랄드 발굴", "다이아몬드 발굴", "토파즈 발굴"],
                    설명: ["골드획득 1.2배", "골드획득 1.4배", "골드획득 1.6배", "골드획득 1.8배", "골드획득 2.0배"],
                    아이콘: 발굴아이콘
                },

                인사이트: {
                    단계: ["마이크로 인사이트", "나노 인사이트"],
                    설명: ["숙련도 + 1", "숙련도 + 2"],
                    아이콘: 인사이트아이콘
                },

                아이언바디: {
                    단계: ["알파 아이언바디",
                        "베타 아이언바디",
                        "감마 아이언바디",
                        "델타 아이언바디",
                        "엡실론 아이언바디",
                        "제타 아이언바디",
                        "에타 아이언바디",
                        "쎄타 아이언바디",
                        "아이오타 아이언바디",
                        "카파 아이언바디",
                        "람다 아이언바디",
                        "뮤 아이언바디",
                        "뉴 아이언바디",
                        "크사이 아이언바디",
                        "오미크론 아이언바디",
                        "파이 아이언바디",
                        "로 아이언바디",
                        "시그마 아이언바디",
                        "타우 아이언바디",
                        "윕실론 아이언바디",
                        "카이 아이언바디",
                        "프사이 아이언바디",
                        "오메가 아이언바디"],
                    설명: [
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +1"
                    ],
                    아이콘: 아이언바디아이콘
                },
                드레인: {
                    단계: ["알파 드레인",
                        "베타 드레인",
                        "감마 드레인",
                        "델타 드레인",
                        "엡실론 드레인",
                        "제타 드레인",
                        "에타 드레인",
                        "쎄타 드레인",
                        "아이오타 드레인",
                        "카파 드레인",
                        "람다 드레인",
                        "뮤 드레인",
                        "뉴 드레인",
                        "크사이 드레인",
                        "오미크론 드레인",
                        "파이 드레인",
                        "로 드레인",
                        "시그마 드레인",
                        "타우 드레인",
                        "윕실론 드레인",
                        "카이 드레인",
                        "프사이 드레인",
                        "오메가 드레인"],
                    설명: [
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +1"
                    ],
                    아이콘: 드레인아이콘
                },

                크리티컬: {
                    단계: [
                        "알파 크리티컬",
                        "베타 크리티컬",
                        "감마 크리티컬",
                        "델타 크리티컬",
                        "엡실론 크리티컬",
                        "제타 크리티컬",
                        "에타 크리티컬",
                        "쎄타 크리티컬",
                        "아이오타 크리티컬",
                        "카파 크리티컬",
                        "람다 크리티컬",
                        "뮤 크리티컬",
                        "뉴 크리티컬",
                        "크사이 크리티컬",
                        "오미크론 크리티컬",
                        "파이 크리티컬",
                        "로 크리티컬",
                        "시그마 크리티컬",
                        "타우 크리티컬",
                        "윕실론 크리티컬",
                        "카이 크리티컬",
                        "프사이 크리티컬",
                        "오메가 크리티컬"
                    ],
                    설명: [
                        "최종데미지 1.1배",
                        "최종데미지 1.2배",
                        "최종데미지 1.3배",
                        "최종데미지 1.4배",
                        "최종데미지 1.5배",
                        "최종데미지 1.6배",
                        "최종데미지 1.7배",
                        "최종데미지 1.8배",
                        "최종데미지 1.9배",
                        "최종데미지 2.0배",
                        "최종데미지 2.1배",
                        "최종데미지 2.2배",
                        "최종데미지 2.3배",
                        "최종데미지 2.4배",
                        "최종데미지 2.5배",
                        "최종데미지 2.6배",
                        "최종데미지 2.7배",
                        "최종데미지 2.8배",
                        "최종데미지 2.9배",
                        "최종데미지 3.0배",
                        "최종데미지 3.1배",
                        "최종데미지 3.2배",
                        "최종데미지 3.3배"
                    ],
                    아이콘: 크리티컬아이콘
                },
                버서커: {
                    단계: [
                        "알파 버서커",
                        "베타 버서커",
                        "감마 버서커",
                        "델타 버서커",
                        "엡실론 버서커",
                        "제타 버서커",
                        "에타 버서커",
                        "쎄타 버서커",
                        "아이오타 버서커",
                        "카파 버서커",
                        "람다 버서커",
                        "뮤 버서커",
                        "뉴 버서커",
                        "크사이 버서커",
                        "오미크론 버서커",
                        "파이 버서커",
                        "로 버서커",
                        "시그마 버서커",
                        "타우 버서커",
                        "윕실론 버서커",
                        "카이 버서커",
                        "프사이 버서커",
                        "오메가 버서커"],
                    설명: [
                        "턴당 체력-1, 데미지 1.2배",
                        "턴당 체력-1, 데미지 1.4배",
                        "턴당 체력-1, 데미지 1.6배",
                        "턴당 체력-1, 데미지 1.8배",
                        "턴당 체력-1, 데미지 2.0배",
                        "턴당 체력-1, 데미지 2.2배",
                        "턴당 체력-1, 데미지 2.4배",
                        "턴당 체력-1, 데미지 2.6배",
                        "턴당 체력-1, 데미지 2.8배",
                        "턴당 체력-1, 데미지 3.0배",
                        "턴당 체력-1, 데미지 3.2배",
                        "턴당 체력-1, 데미지 3.4배",
                        "턴당 체력-1, 데미지 3.6배",
                        "턴당 체력-1, 데미지 3.8배",
                        "턴당 체력-1, 데미지 4.0배",
                        "턴당 체력-1, 데미지 4.2배",
                        "턴당 체력-1, 데미지 4.4배",
                        "턴당 체력-1, 데미지 4.6배",
                        "턴당 체력-1, 데미지 4.8배",
                        "턴당 체력-1, 데미지 5.0배",
                        "턴당 체력-1, 데미지 5.2배",
                        "턴당 체력-1, 데미지 5.4배",
                        "턴당 체력-1, 데미지 5.6배"
                    ],
                    아이콘: 버서커아이콘
                },

                버닝: {
                    단계: ["알파 버닝",
                        "베타 버닝",
                        "감마 버닝",
                        "델타 버닝",
                        "엡실론 버닝",
                        "제타 버닝",
                        "에타 버닝",
                        "쎄타 버닝",
                        "아이오타 버닝",
                        "카파 버닝",
                        "람다 버닝",
                        "뮤 버닝",
                        "뉴 버닝",
                        "크사이 버닝",
                        "오미크론 버닝",
                        "파이 버닝",
                        "로 버닝",
                        "시그마 버닝",
                        "타우 버닝",
                        "윕실론 버닝",
                        "카이 버닝",
                        "프사이 버닝",
                        "오메가 버닝"],
                    설명: [
                        "체력50%이하 데미지1.2배",
                        "체력50%이하 데미지1.4배",
                        "체력50%이하 데미지1.6배",
                        "체력50%이하 데미지1.8배",
                        "체력50%이하 데미지2.0배",
                        "체력50%이하 데미지2.2배",
                        "체력50%이하 데미지2.4배",
                        "체력50%이하 데미지2.6배",
                        "체력50%이하 데미지2.8배",
                        "체력50%이하 데미지3.0배",
                        "체력50%이하 데미지3.2배",
                        "체력50%이하 데미지3.4배",
                        "체력50%이하 데미지3.6배",
                        "체력50%이하 데미지3.8배",
                        "체력50%이하 데미지4.0배",
                        "체력50%이하 데미지4.2배",
                        "체력50%이하 데미지4.4배",
                        "체력50%이하 데미지4.6배",
                        "체력50%이하 데미지4.8배",
                        "체력50%이하 데미지5.0배",
                        "체력50%이하 데미지5.2배",
                        "체력50%이하 데미지5.4배",
                        "체력50%이하 데미지5.6배"
                    ],
                    아이콘: 버닝아이콘
                },
                브로큰: {
                    단계: [
                        "알파 브로큰",
                        "베타 브로큰",
                        "감마 브로큰",
                        "델타 브로큰",
                        "엡실론 브로큰",
                        "제타 브로큰",
                        "에타 브로큰",
                        "쎄타 브로큰",
                        "아이오타 브로큰",
                        "카파 브로큰",
                        "람다 브로큰",
                        "뮤 브로큰",
                        "뉴 브로큰",
                        "크사이 브로큰",
                        "오미크론 브로큰",
                        "파이 브로큰",
                        "로 브로큰",
                        "시그마 브로큰",
                        "타우 브로큰",
                        "윕실론 브로큰",
                        "카이 브로큰",
                        "프사이 브로큰",
                        "오메가 브로큰"
                    ],
                    설명: [
                        "방어력 무시 1%",
                        "방어력 무시 1.25%",
                        "방어력 무시 1.5%",
                        "방어력 무시 1.75%",
                        "방어력 무시 2%",
                        "방어력 무시 2.25%",
                        "방어력 무시 2.5%",
                        "방어력 무시 2.75%",
                        "방어력 무시 3%",
                        "방어력 무시 3.25%",
                        "방어력 무시 3.5%",
                        "방어력 무시 3.75%",
                        "방어력 무시 4%",
                        "방어력 무시 4.25%",
                        "방어력 무시 4.5%",
                        "방어력 무시 4.75%",
                        "방어력 무시 5%",
                        "방어력 무시 5.25%",
                        "방어력 무시 5.5%",
                        "방어력 무시 5.75%",
                        "방어력 무시 6%",
                        "방어력 무시 6.25%",
                        "방어력 무시 6.5%"
                    ],
                    아이콘: 브로큰아이콘
                },
                즉사: {
                    단계: ["일급 즉사", "이급 즉사", "삼급 즉사"],
                    설명: ["11번째 몬스터 즉사", "8번째 몬스터 즉사", "5번째 몬스터 즉사"],
                    아이콘: 즉사아이콘
                },
            };
        }

        function 스킬화면보여주기() {
            모든화면숨기기();
            document.getElementById("스킬화면").style.display = "block";

            document.getElementById("획득로그").innerText = "";
            document.getElementById("추가획득로그").innerText = "";
            document.getElementById("레벨업표시").innerText = "";
            document.getElementById("보유숙련도").innerText = "보유 숙련도 " + 유저데이터.숙련도;

            const 총투자 = Object.values(유저데이터.스킬 || {}).reduce((a, b) => a + b, 0);
            const 다음필요숙련도 = (2 * 총투자 + 11) * 5;
            document.getElementById("필요숙련도").innerText = "필요숙련도 " + 다음필요숙련도;

            const 컨테이너 = document.getElementById("스킬컨테이너");
            컨테이너.innerHTML = "";

            const 스킬정보 = 스킬정보불러오기();

            for (const 키 in 스킬정보) {
                const 설정 = 스킬정보[키];
                const 전체레벨 = 유저데이터.스킬?.[키] || 0;
                const 단계수 = 설정.단계.length;
                const 단계당레벨 = 10;
                const 현재단계 = Math.min(Math.floor(전체레벨 / 단계당레벨), 단계수 - 1);

                let 단계레벨 = 전체레벨 % 단계당레벨;
                if (단계레벨 === 0 && 전체레벨 > 0 && 전체레벨 % 단계당레벨 === 0) {
                    단계레벨 = 단계당레벨;
                }
                const 발동확률 = 단계레벨 * 10;
                const 아이콘 = 설정.아이콘; // ✅ 함수가 아니라 문자열이므로 그대로 사용

                let 이름, 설명, 발동표시;

                if (전체레벨 >= 단계수 * 단계당레벨) {
                    // 💎 최종단계까지 마스터했을 때 (예: 뉴 크리티컬 +10, 확률 100%)
                    이름 = 설정.단계[단계수 - 1];
                    설명 = 설정.설명[단계수 - 1];
                    발동표시 = `<span style="color: #3b82f6;">발동확률(100%)</span>`;
                    단계레벨 = 10;
                } else if (단계레벨 === 10) {
                    이름 = 설정.단계[현재단계];
                    설명 = 설정.설명[현재단계];
                    발동표시 = `<span style="color: #3b82f6;">발동확률(0%)</span>`;
                    단계레벨 = 0;
                } else {
                    // ⚙️ 일반 상태
                    이름 = 설정.단계[현재단계];
                    설명 = 설정.설명[현재단계];
                    발동표시 = `<span style="color: #3b82f6;">발동확률(${발동확률}%)</span>`;
                }

                // const 설명표시 = `<div style="font-size: 12px; color: #888; margin-top: 2px;">${설명} ${발동표시}</div>`;
                const 설명표시 = `<div style="font-size: 12px; color: #888; margin-top: 2px;">${설명}</div>`;

                const 줄 = document.createElement("div");
                줄.className = "양쪽정렬 기본테두리";
                //   <div>${아이콘} ${이름} +${단계레벨}${설명표시}</div>

                줄.innerHTML = `
  <div>${아이콘} ${이름} ${설명표시}</div>

  <div class="가로정렬">
    <div class="버튼">+</div>
    <div class="버튼">-</div>
  </div>
`;
                컨테이너.appendChild(줄);
                // <div class="버튼">M</div>
                // <div class="버튼">R</div>

                줄.style.position = "relative"; // ⭐ 절대 위치를 위해 추가

                // ⭐ 마스터한 단계 수 계산
                const 마스터단계수 = Math.floor(전체레벨 / 단계당레벨);

                // ⭐ 아이콘 SVG 정의
                const 루시드아이콘SVG = `
<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24"
fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
stroke-linejoin="round" class="lucide lucide-star-icon lucide-star"
style="margin-right: 2px;">
<path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"/>
</svg>`;

                if (마스터단계수 > 0) {
                    const 아이콘박스 = document.createElement("div");
                    아이콘박스.style.position = "absolute";
                    아이콘박스.style.top = "-10px";
                    아이콘박스.style.left = "6px";
                    아이콘박스.style.zIndex = "10";
                    아이콘박스.style.display = "flex";

                    const 황금색 = "#facc15";
                    const 전부마스터 = 마스터단계수 === 단계수;

                    for (let i = 0; i < 마스터단계수; i++) {
                        const 아이콘 = document.createElement("div");
                        아이콘.innerHTML = 루시드아이콘SVG;
                        if (전부마스터) {
                            아이콘.style.color = 황금색; // ⭐ 전부 마스터 시 황금색
                        }
                        아이콘박스.appendChild(아이콘);
                    }

                    줄.appendChild(아이콘박스);
                }

                줄.querySelectorAll(".버튼").forEach(버튼 => {
                    버튼.addEventListener("click", async () => {
                        const 행동맵 = {
                            "+": "투자",
                            "-": "회수",
                            "M": "마스터",
                            "R": "초기화"
                        };

                        const 행동 = 행동맵[버튼.innerText];
                        if (!행동) return;

                        화면잠금();
                        try {
                            const 응답 = await fetch("/update-skill", {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify({
                                    유저UID: 유저데이터.유저UID,
                                    스킬이름: 키,
                                    행동
                                })
                            });

                            const 결과 = await 응답.json();

                            if (!응답.ok || 결과.오류) {
                                메시지표시(줄, "", 결과.오류 || "실패", "#ef4444");
                                return;
                            }

                            유저데이터.스킬 = 결과.스킬;
                            유저데이터.숙련도 = 결과.숙련도;
                            메시지표시(줄, "✅", `${행동} 완료`, "#00c851");

                            스킬화면보여주기();
                        } catch (e) {
                            메시지표시(줄, "", "서버 오류: " + e.message, "#ef4444");
                        } finally {
                            화면해제();
                        }
                    });
                });
            }
        }

        document.getElementById("보유숙련도").addEventListener("click", async () => {
            화면잠금();

            try {
                const 응답 = await fetch("/update-skill", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID,
                        스킬이름: "전체", // 특별 키워드
                        행동: "초기화"
                    })
                });

                const 결과 = await 응답.json();

                if (!응답.ok || 결과.오류) {
                    메시지표시(스킬화면, "", 결과.오류 || "초기화 실패", "#ef4444");
                    return;
                }

                유저데이터.숙련도 = 결과.숙련도;
                유저데이터.스킬 = 결과.스킬;

                메시지표시(스킬화면, "🔁", "모든 스킬 초기화 완료", "#3b82f6");
                스킬화면보여주기();
            } catch (e) {
                메시지표시(스킬화면, "", "서버 오류: " + e.message, "#ef4444");
            } finally {
                화면해제();
            }
        });

        document.getElementById("전당").addEventListener("click", () => {
            if (!유저데이터) return;
            전당화면보여주기();
        });

        async function 전당화면보여주기() {
            화면잠금();
            모든화면숨기기();
            document.getElementById("전당화면").style.display = "block";

            document.getElementById("획득로그").innerText = "";
            document.getElementById("추가획득로그").innerText = "";
            document.getElementById("레벨업표시").innerText = "";

            const 컨테이너 = document.getElementById("전당컨테이너");
            컨테이너.innerHTML = "";

            const 응답 = await fetch("/ranking", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
            });

            const 결과 = await 응답.json();
            const 유저들 = 결과.유저들 || [];
            // const 내순위 = 결과.내순위;

            유저들.forEach((유저, index) => {
                const 줄 = document.createElement("div");
                줄.className = "밑줄 양쪽정렬";
                줄.style.display = "flex";
                줄.style.justifyContent = "space-between";
                줄.style.width = "100%";

                if (유저.유저아이디 === 유저데이터.유저아이디) 줄.classList.add("내아이디강조");

                let 왼쪽표시;
                if (index === 0) {
                    왼쪽표시 = `<svg class="lucide lucide-crown" style="color: gold;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"/><path d="M5 21h14"/></svg>`;
                } else if (index === 1) {
                    왼쪽표시 = `<svg class="lucide lucide-crown" style="color: silver;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"/><path d="M5 21h14"/></svg>`;
                } else if (index === 2) {
                    왼쪽표시 = `<svg class="lucide lucide-crown" style="color: peru;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"/><path d="M5 21h14"/></svg>`;
                } else {
                    왼쪽표시 = `<span style="width:24px; display:inline-block;">${index + 1}</span>`;
                }

                // 왼쪽 div (순위/왕관)
                const 왼쪽 = document.createElement("div");
                왼쪽.innerHTML = 왼쪽표시;
                왼쪽.style.flex = "0 0 auto";

                // 오른쪽 div (유저정보)
                const 오른쪽 = document.createElement("div");

                let 닉네임표시 = 유저.유저아이디;

                const 팔레트 = 유저.마법의팔레트;
                if (팔레트 === "숲") {
                    닉네임표시 = `<span class="마법의팔레트숲">${닉네임표시}</span>`;
                } else if (팔레트 === "지옥") {
                    닉네임표시 = `<span class="마법의팔레트지옥">${닉네임표시}</span>`;
                } else if (팔레트 === "블라섬") {
                    닉네임표시 = `<span class="마법의팔레트블라섬">${닉네임표시}</span>`;
                } else if (팔레트 === "가글") {
                    닉네임표시 = `<span class="마법의팔레트가글">${닉네임표시}</span>`;
                } else if (팔레트 === "겨울") {
                    닉네임표시 = `<span class="마법의팔레트겨울">${닉네임표시}</span>`;
                }

                오른쪽.innerHTML = `${유저.직위 ? `[${유저.직위}] ` : ""}${닉네임표시} (lv.${유저.레벨 || 1}) - 공격력 ${유저.최종공격력} / ${유저.현재층}층`;
                오른쪽.style.flex = "1";
                오른쪽.style.textAlign = "right";

                줄.appendChild(왼쪽);
                줄.appendChild(오른쪽);

                줄.addEventListener("click", (e) => {
                    e.stopPropagation();

                    const 창 = document.getElementById("미니장비창");
                    창.style.display = "block";
                    창.innerHTML = `<div style="font-weight:bold; margin-bottom:8px;">🔍 ${유저.유저아이디} 장비</div>`;

                    const 장비들 = 유저.장비목록 || [];
                    const 기록 = 유저.합성기록 || {};

                    if (장비들.length === 0) {
                        창.innerHTML += "장비 없음";
                        return;
                    }

                    const 등급순서 = {
                        "일반": 1,
                        "레어": 2,
                        "신화": 3,
                        "고대": 4,
                        "태초": 5,
                        "공허": 6,
                        "타락": 7,
                    };

                    장비들.sort((a, b) => {
                        const 순서A = 등급순서[a.등급] ?? 99;
                        const 순서B = 등급순서[b.등급] ?? 99;
                        return 순서A - 순서B;
                    });

                    for (const 장비 of 장비들) {
                        const 키 = `${장비.이름}|${장비.등급}`;
                        const 합성수 = 기록[키] ?? 0;
                        const 강화표시 = 장비.강화 ? ` +${장비.강화}` : "";
                        const 이름표시 = `${장비.이름} (${합성수})${강화표시}`;

                        const 박스 = document.createElement("div");
                        박스.className = "기본테두리";
                        박스.style.marginBottom = "6px";
                        박스.style.color = 색상맵[장비.등급] || "#fff";
                        박스.style.fontWeight = "bold";

                        박스.innerHTML = `[${장비.등급}] ${이름표시} - 🗡 ${장비.공격력}`;
                        창.appendChild(박스);
                    }
                });

                컨테이너.appendChild(줄);
            });
            화면해제();
        }

        // ✅ 장비창 내부 클릭 시 document에 이벤트 안 퍼지도록 막기
        document.getElementById("미니장비창").addEventListener("click", (e) => {
            e.stopPropagation();
        });

        // ✅ 장비창 외부 클릭 시 닫기
        document.addEventListener("click", (e) => {
            const 창 = document.getElementById("미니장비창");

            if (창.style.display !== "block") return;

            if (!창.contains(e.target)) {
                창.style.display = "none";
            }
        });

        //유물화면보여주기
        document.getElementById("유물").addEventListener("click", () => {
            if (!유저데이터) return;

            모든화면숨기기();

            document.getElementById("유물화면").style.display = "block";

            const 컨테이너 = document.getElementById("유물컨테이너");
            컨테이너.innerHTML = "";

            const 유물목록 = 유저데이터.유물목록 || {};
            if (Object.keys(유물목록).length === 0) {
                컨테이너.innerText = "획득한 유물이 없습니다";
                return;
            }

            for (const 유물이름 in 유물목록) {
                const 수량 = 유물목록[유물이름] || 0;

                const 아이콘HTML = 아이콘맵[`${유물이름}아이콘`] || "";

                const div = document.createElement("div");
                div.className = "기본테두리 커서호버";
                div.style.position = "relative";
                div.style.display = "flex";
                div.style.alignItems = "center";
                div.style.justifyContent = "center";
                div.style.width = "50px"; // 루시드아이콘 크기 기준
                div.style.height = "50px";
                div.style.margin = "5px";
                div.style.padding = "2px";

                div.innerHTML = `
            ${아이콘HTML}
<div style="
    position: absolute;
    bottom: 0px;
    right: 2px;
    font-size: 10px;
    color: #aaa;
">x${수량}</div>
        `;

                div.addEventListener("mouseover", () => {
                    const 기존설명 = div.querySelector(".유물설명");
                    if (기존설명) 기존설명.remove();

                    const 데이터 = 유물데이터[유물이름];

                    const 설명div = document.createElement("div");
                    설명div.className = "유물설명";
                    설명div.style.position = "absolute";
                    설명div.style.top = "100%";
                    설명div.style.left = "50%";
                    설명div.style.transform = "translateX(-50%)";
                    설명div.style.backgroundColor = "transparent";  // ✅ 완전 투명
                    설명div.style.color = "yellow";
                    설명div.style.fontSize = "12px";
                    설명div.style.padding = "2px 4px";
                    설명div.style.borderRadius = "3px";
                    설명div.style.whiteSpace = "nowrap";
                    설명div.style.zIndex = "10";
                    설명div.style.textAlign = "center"; // ✅ 가운데 정렬

                    if (데이터) {
                        설명div.innerHTML = `<b>${유물이름}</b><br>${데이터.설명}`;
                    } else {
                        설명div.innerText = "정보 없음";
                    }

                    div.appendChild(설명div);
                });

                // ✅ 마우스 아웃 시 설명 div 삭제
                div.addEventListener("mouseout", () => {
                    const 기존설명 = div.querySelector(".유물설명");
                    if (기존설명) 기존설명.remove();
                });


                컨테이너.appendChild(div);
            }
        });

        const 현재보스이름 = "그루트"; // 이 줄만 수정하면 전부 연동됨

        // 보스화면보여주기
        document.getElementById("보스").addEventListener("click", () => {
            if (!유저데이터) return;
            const 보스버튼 = document.getElementById("보스");

            return 메시지표시(보스버튼, "", "구현중입니다", "");

            모든화면숨기기();
            document.getElementById("에너지박스").style.display = "block";
            document.getElementById("보스화면").style.display = "block";

            // 보스화면보여주기 내부에서
            const 보스컨테이너 = document.getElementById("보스컨테이너");
            보스컨테이너.style.marginTop = "15px";
            보스컨테이너.style.width = "400px";
            보스컨테이너.style.border = "0.2px solid #4b4b4b";
            보스컨테이너.style.borderRadius = "10px";
            보스컨테이너.style.padding = "15px";
            보스컨테이너.style.display = "flex";
            보스컨테이너.style.alignItems = "center";
            보스컨테이너.style.justifyContent = "flex-start";
            보스컨테이너.style.gap = "10px";

            // 보스아이콘만 따로 바꾸기
            const 보스아이콘 = document.getElementById("보스아이콘");
            보스아이콘.innerHTML = `
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <div style="width: 200px; height: 200px;">
            ${아이콘맵[현재보스이름 + "아이콘"]
                    .replace(/height:\s*\d+px/, 'height: 200px')
                    .replace(/width:\s*\d+px/, 'width: 200px')}
        </div>
    </div>
`;

            const 보스몬스터 = document.getElementById("보스몬스터");
            보스몬스터.innerText = 현재보스이름;


            const 누적데미지순위 = document.getElementById("누적데미지순위");
            누적데미지순위.innerHTML = "";
            누적데미지순위.style.display = "flex";
            누적데미지순위.style.flexDirection = "column";
            누적데미지순위.style.alignItems = "flex-start";
            누적데미지순위.style.justifyContent = "flex-start";
            누적데미지순위.style.gap = "10px";
            누적데미지순위.style.textAlign = "left";



            // 누적데미지순위.innerHTML = "";
            // 누적데미지순위.style.textAlign = "left"; // 👈 왼쪽 정렬

            // 👇 제목 줄 추가
            const 제목 = document.createElement("div");
            제목.innerText = "누적데미지 순위";
            누적데미지순위.appendChild(제목);


            // for (let i = 0; i < 9; i++) {
            //     const 줄 = document.createElement("div");
            //     줄.id = `순위줄${i}`; // id로 접근하기 쉽게
            //     줄.innerText = `${i + 1}.`; // 일단 등수만 표시
            //     누적데미지순위.appendChild(줄);
            // }

            fetch("/boss-ranking", {
                method: "POST",
                headers: { "Content-Type": "application/json" }
            })
                .then(res => res.json())
                .then(결과 => {
                    const 유저들 = 결과.순위 || [];
                    유저들.forEach((유저, index) => {
                        if (index >= 10) return; // 10명까지만 표시
                        const div = document.createElement("div");
                        div.innerText = `${index + 1}. ${유저.보스누적데미지} [${유저.유저아이디}]`;
                        누적데미지순위.appendChild(div);
                    });
                })
                .catch(err => {
                    console.error("보스 순위 조회 실패", err);
                });



        });

        document.getElementById("보스몬스터").addEventListener("click", async () => {
            공격버튼잠금();

            try {
                const 응답 = await fetch("/attack-boss", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저데이터,
                        보스이름: 현재보스이름  // ✅ 서버가 이름으로 보스정보 결정
                    })
                });

            } catch (e) {
                메시지표시(스킬화면, "", "서버 오류: " + e.message, "#ef4444");
            } finally {
                공격버튼잠금해제();
            }
        });

        document.getElementById("타이틀을아이디로").addEventListener("click", async function 아이디변경시작() {
            if (!유저데이터) return;

            const 기존표시 = document.getElementById("타이틀을아이디로");
            const 원래아이디 = 유저데이터.유저아이디;

            // 입력창 생성
            const 입력창 = document.createElement("input");
            입력창.type = "text";
            입력창.maxLength = 8;
            입력창.placeholder = "새 아이디 입력";
            입력창.style.background = "white";
            입력창.style.color = "black";
            입력창.style.border = "none";
            입력창.style.fontSize = "14px";
            입력창.size = 6;
            입력창.style.outline = "none";
            입력창.value = "";
            기존표시.replaceWith(입력창);
            입력창.focus();

            // 외부 클릭 감지 핸들러
            const 외부클릭취소 = (e) => {
                if (!입력창.contains(e.target)) {
                    const 복원 = document.createElement("div");
                    복원.id = "타이틀을아이디로";
                    복원.className = "커서호버";
                    복원.innerText = 원래아이디;
                    입력창.replaceWith(복원);
                    복원.addEventListener("click", 아이디변경시작);
                    document.removeEventListener("click", 외부클릭취소);
                }
            };

            // 입력창 클릭 제외하고 바깥 클릭 시 취소
            setTimeout(() => {
                document.addEventListener("click", 외부클릭취소);
            }, 0);

            입력창.addEventListener("keydown", async (e) => {
                if (e.key !== "Enter") return;

                const 새아이디 = 입력창.value.trim();
                if (!새아이디 || 새아이디.length > 6) {
                    메시지표시(메시지표시박스, "⚠️", "1~6자 이내로 입력하세요", "#ef4444");
                    return;
                }

                화면잠금();

                try {
                    const 응답 = await fetch("/update-username", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            유저UID: 유저데이터.유저UID,
                            새아이디
                        })
                    });

                    const 결과 = await 응답.json();

                    if (!응답.ok) {
                        메시지표시(메시지표시박스, "", 결과.오류 || "아이디 변경 실패", "#ef4444");
                        화면해제();
                        return;
                    }

                    유저데이터.유저아이디 = 새아이디;

                    const 복원 = document.createElement("div");
                    복원.id = "타이틀을아이디로";
                    복원.className = "커서호버";
                    복원.innerText = 새아이디;
                    입력창.replaceWith(복원);
                    복원.addEventListener("click", 아이디변경시작);

                    document.getElementById("유저아이디").innerText = 새아이디;
                    메시지표시(메시지표시박스, "✅", "아이디 변경 완료", "#00c851");

                    document.removeEventListener("click", 외부클릭취소);
                } catch (e) {
                    메시지표시(메시지표시박스, "", "네트워크 오류", "#ef4444");
                } finally {
                    화면해제();
                }
            });
        });

        // 🟡 무지개 타이틀 애니메이션
        let 색상인덱스 = 0;
        const 무지개색들 = ["#ff0000", "#ff7f00", "#ffff00", "#00ff00", "#0000ff", "#4b0082", "#9400d3"];
        setInterval(() => {
            const 타이틀 = document.getElementById("도박타이틀");
            // 타이틀.style.display = "flex";
            // 타이틀.style.alignItems = "center";
            // 타이틀.style.gap = "6px";
            타이틀.innerHTML = `${도박아이콘} 도박장`;
            if (타이틀) {
                타이틀.style.color = 무지개색들[색상인덱스 % 무지개색들.length];
                색상인덱스++;
            }
        }, 250);

        // 🟢 도박창 외부 클릭 시 닫기
        document.addEventListener("click", (e) => {
            const 도박창 = document.getElementById("도박창");
            if (도박창.style.display === "none") return;
            if (!도박창.contains(e.target) && e.target.id !== "총골드") {
                도박창.style.display = "none";
            }
        });

        // 🟢 총골드 클릭 시 도박창 표시
        document.getElementById("총골드").addEventListener("click", () => {
            if (!유저데이터) return;
            const 도박창 = document.getElementById("도박창");
            도박창.style.display = "block";
        });

        // 🟡 도박 시도
        async function 도박시도(등급) {
            const 비용맵 = {
                "일반": 20000,
                "레어": 40000,
                "신화": 80000,
                "고대": 160000,
                "태초": 320000,
                "공허": 640000,
                "타락": 1280000
            };
            const 도박창 = document.getElementById("도박창");

            const 비용 = 비용맵[등급];
            if (유저데이터.골드 < 비용) {
                메시지표시(도박창, "", "골드 부족!", "#ef4444");
                return;
            }

            const 확인 = confirm(`[${등급}] 장비 도박을 ${비용.toLocaleString()} 골드로 진행하시겠습니까?`);
            if (!확인) return;

            화면잠금();
            try {
                const 응답 = await fetch("/gamble", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID,
                        등급
                    })
                });


                const 결과 = await 응답.json();
                if (!응답.ok || 결과.오류) {
                    메시지표시(도박창, "", 결과.오류 || "도박 실패", "#ef4444");
                    return;
                }

                유저데이터 = 결과.유저데이터;
                if (결과.결과 === "성공" && 결과.장비) {
                    const 네온박스 = document.getElementById("네온박스");
                    const 등급외테두리 = document.getElementById("등급외테두리");

                    if (네온박스) {
                        네온박스.innerText = `도파민 폭발! ${결과.장비.이름} 도박성공!`;
                        네온박스.style.display = "block";

                        // 위치 조정용 부모 변경
                        if (등급외테두리) {
                            // 등급외테두리에 위치 기준 설정
                            등급외테두리.style.position = "relative";

                            // 네온박스를 등급외테두리 내부로 이동
                            등급외테두리.appendChild(네온박스);

                            // 전투화면용 위치 조정
                            Object.assign(네온박스.style, {
                                position: "absolute",
                                top: "50%",
                                left: "50%",
                                transform: "translate(-50%, -50%)",
                                zIndex: "100"
                            });
                        }
                    }
                    setTimeout(() => {
                        네온박스.style.display = "none";
                    }, 3000);



                } else if (결과.결과 === "실패") {
                    메시지표시(도박창, "", "도박에 실패했습니다!", "#ef4444");
                }

                document.getElementById("총골드").innerText = 유저데이터.골드.toLocaleString();
            } catch (e) {
                메시지표시(도박창, "", "도박 중 오류: " + e.message, "#ef4444");
            } finally {
                화면해제();
            }
        }


        document.getElementById("아래층으로").addEventListener("click", async () => {
            if (!유저데이터) return;
            if (유저데이터.현재층 <= 1) return 메시지표시(층조절, "", "지하로 내려갈 수 없습니다", "#ef4444");

            유저데이터.현재층--;
            document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;
        });

        document.getElementById("위층으로").addEventListener("click", async () => {
            if (!유저데이터) return;

            유저데이터.현재층++;
            document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;
        });


        async function 전직화면보여주기() {
            화면잠금();
            const 응답 = await fetch("/get-job-info", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
            });

            const 결과 = await 응답.json();
            if (!응답.ok) {
                메시지표시(메시지표시박스, "", "전직정보 조회 실패: " + 결과.오류, "");
                화면해제();
                return;
            }

            const 전직정보 = 결과.전직정보;
            const 경험치 = 결과.경험치 ?? 0;

            const 전직순서 = ["백인장", "오백인장", "천인장", "만인장", "부장군", "장군", "대장군", "대사마", "승상", "후", "공", "제후", "왕", "황제", "천황", "제황", "태황", "천제"];

            const container = document.getElementById("전직컨테이너");

            // 🔷 기존 전직 항목만 삭제 (타이틀/경험치 영역은 유지)
            document.querySelectorAll(".전직항목").forEach(e => e.remove());

            // 🔷 경험치 표시 갱신
            const 경험치div = document.getElementById("경험치와포인트");
            경험치div.innerHTML = `
        <div>경험치</div>
        <div>${경험치.toLocaleString()} 포인트</div>
    `;

            // 🔷 전직 리스트 추가
            for (let i = 0; i < 전직순서.length; i++) {
                const 직위 = 전직순서[i];
                const 완료여부 = 전직정보[직위] ?? 0;

                // 완료된 직위는 건너뜀
                if (완료여부 === 1) continue;

                // 첫 번째 안 배운 직위만 표시하고, 이후는 표시하지 않음
                const div = document.createElement("div");
                div.className = "사백픽셀테두리 양쪽정렬 전직항목";
                div.style.marginTop = "5px";

                const 왼쪽 = document.createElement("div");
                왼쪽.style.display = "flex";
                왼쪽.style.flexDirection = "column";  // 세로로 쌓기
                왼쪽.style.fontWeight = "bold";

                const 직위텍스트 = document.createElement("div");
                직위텍스트.textContent = 직위;

                // 🔶 효과 설명 추가
                const 효과텍스트 = document.createElement("div");
                효과텍스트.textContent = `최종공격력 x${2 + i}`;  // 2배부터 시작
                효과텍스트.style.fontSize = "12px";
                효과텍스트.style.color = "gray";
                효과텍스트.style.marginTop = "3px";

                왼쪽.appendChild(직위텍스트);
                왼쪽.appendChild(효과텍스트);

                const 오른쪽 = document.createElement("div");
                오른쪽.style.borderRadius = "7px";
                오른쪽.style.padding = "7px";
                오른쪽.style.paddingLeft = "10px";
                오른쪽.style.paddingRight = "10px";
                오른쪽.style.fontSize = "13px";

                const 비용 = (i + 1) * 50000;
                오른쪽.textContent = `전직(${비용.toLocaleString()}p)`;
                오른쪽.style.backgroundColor = "white";
                오른쪽.style.color = "black";
                오른쪽.style.cursor = "pointer";

                오른쪽.onclick = () => {
                    전직하기(직위, 왼쪽);
                };

                div.appendChild(왼쪽);
                div.appendChild(오른쪽);
                container.appendChild(div);

                break;  // 첫 번째 미완료 항목만 보여줌
            }
            화면해제();
        }

        async function 전직하기(직위, 위치참조) {
            화면잠금();

            const 응답 = await fetch("/promote-job", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    유저UID: 유저데이터.유저UID,
                    직위: 직위
                })
            });

            const 결과 = await 응답.json();

            if (!응답.ok) {
                메시지표시(위치참조, "", "전직 실패: " + 결과.오류, "");
                화면해제();
                return;
            }
            유저데이터.레벨 = 결과.레벨;
            유저데이터.경험치 = 결과.경험치;
            유저데이터.최종공격력 = 결과.최종공격력;

            // 성공하면 화면 갱신
            메시지표시(위치참조, "", 직위 + " 전직 성공!", "");
            전직화면보여주기();
        }

        const 유물데이터 = {
            "소드": { 설명: "공격력이 증가합니다" }, //완료
            "하트플러스": { 설명: "체력이 증가합니다" }, //완료
            "고스트": { 설명: "히든몬스터 등장률이 증가합니다" }, //완료
            "쉴드밴": { 설명: "악마들의 방어력을 감소시킵니다" }, //완료
            "하트마이너스": { 설명: "악마들의 체력을 감소시킵니다" }, //완료
            "클로버": { 설명: "장비 드랍율을 증가시킵니다" }, //완료
            "모래시계": { 설명: "스태미너 소모를 무시합니다" }, //완료
            // "모루": { 설명: "장비 강화확률을 증가시킵니다" }, //완료
            // "표창": { 설명: "추가로 공격합니다" },
            // "암포라": { 설명: "숙련도 소모량을 감소시킵니다" },
            // "엑스": { 설명: "최종 데미지를 증가시킵니다" },
            // "퍼즐": { 설명: "미정" },
            // "로켓": { 설명: "미정" },
            // "플라워": { 설명: "미정" },
            // "봄": { 설명: "미정" },
            // "여름": { 설명: "미정" },
            // "가을": { 설명: "미정" },
            // "겨울": { 설명: "미정" }
        };



        const 버전버튼 = document.getElementById("버전표시");
        버전버튼.style.cursor = "pointer";

        const 메뉴얼창 = document.createElement("div");
        메뉴얼창.id = "메뉴얼창";
        메뉴얼창.className = "사백픽셀테두리";
        메뉴얼창.style.position = "fixed";
        메뉴얼창.style.top = "40px";
        메뉴얼창.style.left = "10px";
        메뉴얼창.style.background = "#000";
        메뉴얼창.style.color = "white";
        메뉴얼창.style.zIndex = "9999";
        메뉴얼창.style.width = "fit-content";
        // 메뉴얼창.style.whiteSpace = "nowrap";
        메뉴얼창.style.display = "none";
        메뉴얼창.innerHTML = `
  <div style="font-weight: bold; margin-bottom: 10px;">📘 gagl 메뉴얼</div>
  <div>
- gagl은 자동사냥 게임입니다. 악마성을 클릭하세요<br>
- https://open.kakao.com/o/gbnmdWvh 톡방에 오셔서 정보를 공유하세요<br>
- 스태미너는 시간당 60씩 회복됩니다<br>
- 최상단 아이디를 클릭하시면 아이디 변경이 가능합니다<br>
- 전투화면의 경험치를 클릭하시면 전직창이 열립니다<br>
- 전투화면의 보유골드를 클릭하시면 도박창이 열립니다<br>
- 전투화면의 숙련도를 클릭하시면 스킬창이 열립니다<br>
- 도박은 등급당 10번 실패시 11번 째 확정드랍됩니다<br>
- 전당화면에서 유저를 클릭하면 해당 유저의 장비열람 가능합니다<br>
- 단축키 Alt + A 로 레어몬스터를 우선 공격하는 풀자동 사냥이 가능합니다<br>
☆누르고 계시면 안되고, 알트에이 딸깍 한번만 실행하시면 됩니다☆<br>
- 스킬화면의 보유숙련도를 클릭하시면 투자된 모든 숙련도가 회수됩니다<br>
- 모든팝업창은 외부를 클릭 시 닫힙니다<br>
- 오픈 전 마지막 버전입니다. 6월 1일 전까지 충분히 즐겨주세요<br>
- 6월 1일에 모든 데이터는 초기화됩니다<br>
- 오픈톡에 오셔서 피드백 부탁드리겠습니다<br>

<br>
행운을 빕니다<br>
<br>
ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ<br>
<br>
gagl 패치노트<br>
- 스태미너 로직을 개선했습니다. 지금부턴 시간당 60의 스태미너가 회복됩니다<br>
- 획득메시지 위치를 조정했습니다<br>
</div>
`;
        document.getElementById("버전표시").innerText = "v9";
        // git add . && git commit -m "fix: gagl.html serving enabled" && git push origin main
        // npm install -g nodemon
        // nodemon index.js

        document.body.appendChild(메뉴얼창);

        버전버튼.addEventListener("click", () => {
            메뉴얼창.style.display = (메뉴얼창.style.display === "none") ? "block" : "none";
        });

        document.addEventListener("click", (e) => {
            const target = e.target;

            switch (target.id) {
                // case "객체아이디":
                //     실행함수();
                //     break;

            }

            if (
                메뉴얼창.style.display === "block" &&
                !메뉴얼창.contains(e.target) &&
                !버전버튼.contains(e.target)
            ) {
                메뉴얼창.style.display = "none";
            }

            if (
                target.matches("#총경험치")
            ) {
                모든화면숨기기();
                document.getElementById("전직화면").style.display = "block";
                전직화면보여주기();
            }
        });

        document.addEventListener("DOMContentLoaded", async () => {
            const { data: { user }, error: 인증오류 } = await supabase.auth.getUser();

            if (인증오류) {
                // 메시지표시(메시지표시박스, "", "유저 인증 확인 실패", "#ef4444");
                return;
            }

            if (user && user.id) {
                try {
                    const 응답 = await fetch("/get-user", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ 유저UID: user.id })
                    });
                    const 결과 = await 응답.json();
                    const 유저정보 = 결과.유저데이터;

                    if (!유저정보 || 유저정보.버전업 !== 5) {
                        await fetch("/delete-user", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ 유저UID: user.id })
                        });

                        await supabase.auth.signOut();
                        alert("드락실 벨고르 마하 투라크... 에이라스 노 크살. 메테오!");
                        location.reload();
                        alert("메테오를 맞고 새로 태어납니다.");
                        return;
                    }

                    유저데이터 = 유저정보;
                    메시지표시(메시지표시박스, "✅", "자동 로그인 완료", "#00c851");

                    // ✅ 스태미너 갱신 요청
                    try {
                        const 응답 = await fetch("/refresh-stamina", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ 유저UID: 유저정보.유저UID })
                        });

                        const 결과 = await 응답.json();
                        if (응답.ok && 결과.유저데이터) {
                            유저정보.현재스태미너 = 결과.유저데이터.현재스태미너;
                        }
                    } catch (e) {
                        console.warn("스태미너 갱신 실패", e);
                    }

                    전투화면보여주기(유저데이터);

                } catch (e) {
                    메시지표시(메시지표시박스, "", "자동 로그인 오류: " + e.message, "#ef4444");
                }
            } else {
                메시지표시(메시지표시박스, "🔒", "로그인된 유저 없음", "#aaa");
            }

        });


        function 모든화면숨기기() {
            const 화면ID들 = [
                "전투화면", "장비화면", "스킬화면", "전당화면",
                "유물화면", "전직화면", "보스화면", "에너지박스",

            ];
            화면ID들.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = "none";
            });
        }

        //장비도박
        //장비드랍
        //장비강화
        //스킬
        //악마전투
        //레어악마전투


    </script>
</body>

</html>