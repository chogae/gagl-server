<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>gagl</title>

    <meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">

    <script type="module">
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

        window.supabase = createClient(
            "https://piafesfywtvpachbfoxr.supabase.co",
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBpYWZlc2Z5d3R2cGFjaGJmb3hyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ3ODQwMTgsImV4cCI6MjA2MDM2MDAxOH0.1aDNwRZXac48nD9HDicXvDYk4wfcY1MC487_qf3hF5c"
        );

    </script>

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: black;
            margin: 0;
            padding: 0;
            color: white;
            display: flex;
            /* justify-content: center; */
            align-items: center;
            flex-direction: column;
            height: 100vh;
            font-size: 14px;
            /* position: fixed; */
            /* 화면고정배치 스크롤해도 안움직임 */
            /* justify-content: space-between; */
            /* 양쪽정렬 */
            font-weight: 500;
        }

        .가로정렬 {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .세로정렬 {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
        }

        .양쪽정렬 {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            gap: 10px;
        }

        .사백픽셀 {
            width: 400px;
            min-width: 400px;
            max-width: 400px;
        }

        .버튼 {
            border-radius: 5px;
            padding: 5px;
            text-align: center;
        }

        .공격버튼 {
            margin-top: 15px;
            background-color: #fafafa;
            color: black;
            border-radius: 5px;
            padding: 7px 17px;
            text-align: center;
        }

        .공격버튼:hover {
            background-color: #9e9e9e;
            cursor: pointer;
        }

        .지하버튼 {
            margin-top: 15px;
            background-color: #ff3737;
            color: black;
            border-radius: 5px;
            padding: 7px 17px;
            text-align: center;
        }

        .지하버튼:hover {
            opacity: 0.8;
            cursor: pointer;
        }



        .레어몬스터 {
            margin-top: 7px;
            background-color: #a853f7;
            color: black;
            border-radius: 5px;
            padding: 7px 17px;
            text-align: center;
        }

        .레어몬스터:hover {
            background-color: #9019ff;
            cursor: pointer;
        }

        .풀자동 {
            /* border: 0.2px solid #4b4b4b; */
            /* background-color: #ffffff; */
            /* color: black; */
            border-radius: 5px;
            padding: 3px 5px;
            text-align: center;
        }

        .풀자동:hover {
            /* background-color: #f7535b; */
            cursor: pointer;
            opacity: 0.8;
        }

        .보스몬스터 {
            margin-top: 7px;
            margin-bottom: 7px;
            background-color: #f753b8;
            color: black;
            border-radius: 5px;
            padding: 7px 17px;
            text-align: center;
        }

        .보스몬스터:hover {
            background-color: #f753b8;
            cursor: pointer;
        }

        .버튼:hover {
            background-color: #333;
            cursor: pointer;
        }

        .커서호버:hover {
            cursor: pointer;
        }

        .밑줄 {
            border-bottom: 0.2px solid #4b4b4b;
            width: 100%;
            height: 56px;
            min-height: 56px;
            /* ✅ 추가 */
            max-height: 56px;
            /* ✅ 추가 */
            display: flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
            /* ✅ 추가 */
            overflow: hidden;
            /* ✅ 추가 */
        }

        .사백픽셀테두리 {
            margin-top: 15px;
            width: 400px;
            border: 0.2px solid #4b4b4b;
            border-radius: 10px;
            padding: 15px;
        }

        .기본테두리 {
            margin-top: 15px;
            width: 100%;
            box-sizing: border-box;
            border: 0.2px solid #4b4b4b;
            border-radius: 10px;
            padding: 15px;
        }

        .타락테두리 {
            border: 0.2px solid #CD7F32;
            /* 브론즈 색 */
            box-shadow: 0 0 10px #CD7F32;
        }

        .타락텍스트 {
            color: #CD7F32;
            font-weight: bold;

        }

        .에너지바 {
            background-color: #eab308;
            height: 5px;
            border-radius: 10px;
            width: 100%;
        }

        .유저테두리 {
            border: 0.2px solid #3b82f6;
            border-radius: 10px;
            padding: 15px;
            /* width: 100%; */
        }

        .몬스터테두리 {
            border: 0.2px solid #f63b3b;
            border-radius: 10px;
            padding: 15px;
            /* width: 100%; */

        }

        .경험치골드숙련도 {
            background-color: #121212;
            height: 85px;
            border-radius: 10px;
            width: 100px;
            padding: 15px;
        }

        .레벨 {
            color: #00c851;
        }

        .총경험치 {
            color: #ffffff;
            font-size: 16px;
            font-weight: bold;
        }

        .획득경험치 {
            color: #7a7a7a;
            font-size: 10px;
            font-weight: lighter;
        }

        .골드 {
            color: #b0b0b0;
        }

        .총골드 {
            color: #f5c400;
            font-size: 16px;
            font-weight: bold;
        }

        .획득골드 {
            color: #00c851;
            font-size: 10px;
            font-weight: lighter;
        }

        .숙련도 {
            color: #b0b0b0;
        }

        .총숙련도 {
            color: #3b82f6;
            font-size: 16px;
            font-weight: bold;
        }

        .획득숙련도 {
            color: #00c851;
            font-size: 10px;
            font-weight: lighter;
        }

        .콘솔로그창 {
            color: #ffffff;
            border-radius: 10px;
            position: fixed;
            left: 0;
            bottom: 0;
            font-weight: bold;
        }

        .로딩컨테이너 {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-family: sans-serif;
            font-size: 16px;
        }

        .로딩스피너 {
            width: 50px;
            height: 50px;
            border: 6px solid #ccc;
            border-top-color: #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .네온박스 {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;

            width: 320px;
            padding: 10px 20px;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            color: #c653ff;
            border-radius: 10px;

            background-color: black;
            background-image: linear-gradient(to right, rgba(198, 83, 255, 0.15), rgba(255, 0, 150, 0.15));
            background-blend-mode: overlay;

            box-shadow:
                0 0 8px 0px rgba(198, 83, 255, 0.5),
                0 0 14px 0px rgba(255, 0, 150, 0.4),
                inset 0 0 4px #000;

            animation: 네온펄스 1.5s ease-in-out infinite alternate;
        }


        @keyframes 네온펄스 {
            0% {
                box-shadow:
                    0 0 15px 5px rgba(198, 83, 255, 0.3),
                    0 0 30px 5px rgba(255, 0, 150, 0.2),
                    inset 0 0 6px #000;
                color: #b366ff;
            }

            100% {
                box-shadow:
                    0 0 10px 10px rgba(198, 83, 255, 0.5),
                    0 0 50px 10px rgba(255, 0, 150, 0.4),
                    inset 0 0 10px #000;
                color: #ff99ff;
            }
        }

        .유물드랍박스 {
            position: fixed;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;

            width: 320px;
            padding: 10px 20px;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            color: #ffd700;
            /* 골드 */

            border-radius: 10px;

            background-color: black;
            background-image: linear-gradient(to right, rgba(255, 215, 0, 0.15), rgba(255, 255, 255, 0.1));
            background-blend-mode: overlay;

            box-shadow:
                0 0 10px 0px rgba(255, 215, 0, 0.5),
                0 0 16px 0px rgba(255, 255, 255, 0.4),
                inset 0 0 4px #000;

            animation: 유물네온펄스 1.5s ease-in-out infinite alternate;
        }

        @keyframes 유물네온펄스 {
            0% {
                box-shadow:
                    0 0 18px 6px rgba(255, 215, 0, 0.4),
                    0 0 30px 6px rgba(255, 255, 255, 0.2),
                    inset 0 0 6px #000;
                color: #ffe066;
                /* 밝은 골드 */
            }

            100% {
                box-shadow:
                    0 0 14px 10px rgba(255, 215, 0, 0.6),
                    0 0 40px 12px rgba(255, 255, 255, 0.5),
                    inset 0 0 10px #000;
                color: #ffffff;
                /* 하얀색 */
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* 
        #사냥로그박스 {
            max-height: 220px;
            overflow-y: hidden;
        } */

        /* 자동으로 사라지게 하는 페이드 아웃 */
        @keyframes fadeOut {
            0% {
                opacity: 1;
            }

            70% {
                opacity: 1;
            }

            100% {
                opacity: 0;
                display: none;
            }
        }



        #승리패배로그 {
            font-size: 16px;
            margin-top: 10px;
        }

        #획득로그 {
            color: #00c851;
        }

        #레벨업표시 {
            color: #00c851;
        }

        #층조절 {
            background: transparent;
            /* 내부 배경 제거 */
            border: 2px solid #ff3300;
            box-shadow:
                0 0 12px #ff0000,
                /* 바깥쪽 발광 효과 */
                0 0 24px #440000,
                /* 바깥쪽 어두운 발광 */
                0 0 0 4px rgba(255, 0, 0, 0.2) inset;
            /* 안쪽 테두리 강조 */
            animation: 마계불길 4s ease-in-out infinite;
            gap: 30px;
            position: relative;
            border-radius: 10px;
            /* 둥글게 유지 */
            color: white;
        }

        @keyframes 마계불길 {

            0%,
            100% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.3);
            }
        }

        .crown-icon {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }

        .금 {
            stroke: gold;
        }

        .은 {
            stroke: silver;
        }

        .동 {
            stroke: #cd7f32;
        }

        #보유숙련도:hover {
            cursor: pointer;
            text-decoration: underline;
            color: #3b82f6;
        }

        #전직화면타이틀:hover {
            cursor: pointer;
            text-decoration: underline;
            color: #3b82f6;
        }

        .target-icon {
            width: 16px;
            height: 16px;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            margin-right: 4px;
        }

        .내아이디강조 {
            background-color: #505050;
            /* font-weight: bold; */
            border-radius: 6px;
        }

        .색상실험 {
            background-color: #8b5cf6;
            background-color: #3bf0f6;
            background-color: #5cf669;
            background-color: #f6ec5c;
        }

        #전투버튼박스 {
            position: relative;
            /* ✅ 추가 */
        }

        #전투화면 {
            position: relative;
        }



        @keyframes 악마강림효과 {
            0% {
                box-shadow: 0 0 10px 5px red, inset 0 0 10px red;
                filter: brightness(1.5) blur(0px);
            }

            50% {
                box-shadow: 0 0 20px 10px darkred, inset 0 0 20px darkred;
                filter: brightness(2) blur(1px);
                transform: scale(1.02) rotate(1deg);
            }

            100% {
                box-shadow: 0 0 10px 5px red, inset 0 0 10px red;
                filter: brightness(1.2) blur(0px);
                transform: scale(1) rotate(0deg);
            }
        }

        * {
            user-select: none;
        }

        @keyframes 깜빡임 {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }

        html {
            overflow-y: scroll;
        }

        .마법의팔레트가글 {
            background: linear-gradient(90deg, #ff6ec4, #7873f5, #4adede, #4adede, #ff6ec4);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        @keyframes 무지개흐름 {
            to {
                background-position: 200% center;
            }
        }

        .마법의팔레트지옥 {
            background: linear-gradient(90deg, #8a0404, #8B0000, #FF0000, #FF8C00, #6e0202);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트블라섬 {
            background: linear-gradient(90deg, #ffe6f0, #ffb6c1, #ff69b4, #ffa7c4, #ffe6f0);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트민초 {
            background: linear-gradient(90deg, #1e9f8d, #08e0c7, #52d1c2, #a6e5de, #21a58f);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트겨울 {
            background: linear-gradient(90deg, #7d96ff, #c6efff, #ffe1f0, #a9dfff, #2eb2ff);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트핑크오션 {
            background: linear-gradient(90deg, #ff9a9e, #fad0c4, #fad0c4, #ff9a9e);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트네온사인 {
            background: linear-gradient(90deg, #00f260, #0575e6, #00f260);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 2.5s linear infinite;
        }

        .마법의팔레트에메랄드숲 {
            background: linear-gradient(90deg, #11998e, #38ef7d, #11998e);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3s linear infinite;
        }

        .마법의팔레트황혼하늘 {
            background: linear-gradient(90deg, #f7971e, #ffd200, #f7971e);
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            animation: 무지개흐름 3.5s linear infinite;
        }

        #유물컨테이너 {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            /* ✅ 중앙정렬 */
        }


        /* css추가 */
    </style>
</head>

<body>
    <div class="유물드랍박스" id="유물드랍박스" style="display: none;">

    </div>


    <div class="밑줄" id="상단바">
        <div class="사백픽셀">
            <div class="양쪽정렬">
                <div id="타이틀을아이디로" class="커서호버">gagl</div>

                <div id="전투스킬설정버튼" style="display: none;">
                    <div class="가로정렬">
                        <!-- <div class="마법의팔레트지옥 버튼">마법의팔레트</div> -->
                        <div class="버튼" id="전투">전투</div>
                        <div class="버튼" id="장비">장비</div>
                        <div class="버튼" id="유물">유물</div>
                        <div class="버튼" id="월드">월드</div>
                        <div class="버튼" id="전당">전당</div>
                        <div class="버튼" id="정보">정보</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 로그인화면 -->
    <div class="사백픽셀 밑줄">
        <div id="화면설명" style="text-align: center;">
            25년 5월 26일 오후 3시 정식오픈<br>유물화면에서 [샐러드]를 확인하세요
        </div>
    </div>

    <div class="사백픽셀테두리 세로정렬" id="에너지박스" style="display: none;">
        <div class="양쪽정렬">
            <div style="color: #eab308;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-zap-icon lucide-zap">
                    <path
                        d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z" />
                </svg>
            </div>
            <div id="스태미너표시" style="color: white;">
                ♾️
            </div>
        </div>
        <div class="에너지바">

        </div>
    </div>



    <div id="메뉴얼화면" style="display: none;">
        <div class="사백픽셀테두리 세로정렬" id="메뉴얼컨테이너">

        </div>
    </div>

    <div id="내정보화면" style="display: none;">
        <div class="사백픽셀테두리 세로정렬" id="내정보컨테이너">

        </div>
    </div>

    <div id="지하던전화면" style="display: none;">
        <div class="세로정렬" id="지하던전컨테이너">
            <div class="사백픽셀테두리 세로정렬" id="던전아이콘">

            </div>

            <div class="사백픽셀테두리 세로정렬" id="지하등반">
                <div class="지하버튼" id="지하층수">

                </div>
                <div style="margin-bottom: 15px; font-size: 16px;" id="지하승패">

                </div>

            </div>
        </div>
    </div>



    <div id="유물화면" style="display: none;">
        <div class="사백픽셀테두리" id="유물컨테이너">

        </div>
    </div>

    <div id="보스화면" style="display: none;">
        <div id="보스컨테이너" style="justify-content: flex-start;">
            <div id="보스아이콘">

            </div>
            <div id="누적데미지순위">

            </div>
        </div>

        <div id="보스사냥컨테이너">
            <div class="사백픽셀테두리 세로정렬">
                <div class="보스몬스터" id="보스몬스터">
                </div>
                <div id="최종데미지">
                </div>

            </div>

        </div>

    </div>

    <div id="전직화면" style="display: none;">
        <div id="전직컨테이너" class="세로정렬">
            <div id="전직화면타이틀" class="밑줄" style="text-align: left; font-weight: bold;  font-size: 24px;">
                전직
            </div>
            <div class="양쪽정렬" id="경험치와포인트">

            </div>

        </div>
    </div>

    <div id="인증화면" class="사백픽셀테두리 세로정렬">
        <input id="이메일입력" type="text" placeholder="한글x, 영문아이디 입력" autocomplete="off" />
        <input id="비번입력" type="password" placeholder="비밀번호 입력" autocomplete="off" />
        <button onclick="회원가입()">회원가입</button>
        <button onclick="로그인()">로그인</button>
        <div class="네온박스" id="네온박스">
            gagl에 찾아와주셔서 감사합니다
        </div>
    </div>

    <div id="전투화면" style="display: none;">
        <div class="사백픽셀테두리 가로정렬" id="층조절">
            <div id="아래층으로">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-arrow-big-down-dash-icon lucide-arrow-big-down-dash">
                    <path d="M15 5H9" />
                    <path d="M15 9v3h4l-7 7-7-7h4V9z" />
                </svg>
            </div>
            <div id="현재층">
                1층
            </div>
            <div id="위층으로">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-arrow-big-up-dash-icon lucide-arrow-big-up-dash">
                    <path d="M9 19h6" />
                    <path d="M9 15v-3H5l7-7 7 7h-4v3H9z" />
                </svg>
            </div>

        </div>

        <div id="사냥결과1">
            <div class="사백픽셀테두리 세로정렬">
                <div class="가로정렬">
                    <div class="경험치골드숙련도 세로정렬" id="경험치테두리안표시">
                        <div class="레벨" id="레벨">
                        </div>
                        <div class="총경험치 커서호버" id="총경험치">
                        </div>
                        <div class="획득경험치" id="획득경험치">
                        </div>
                    </div>
                    <div class="경험치골드숙련도 세로정렬" id="골드테두리안표시">
                        <div class="골드" id="골드">
                            골드
                        </div>
                        <div class="총골드 커서호버" id="총골드">
                        </div>
                        <div class="획득골드" id="획득골드">
                        </div>

                    </div>
                    <div class="경험치골드숙련도 세로정렬" id="숙련도테두리안표시">
                        <div class="숙련도" id="숙련도">
                            숙련도
                        </div>
                        <div class="총숙련도 커서호버" id="총숙련도">
                        </div>
                        <div class="획득숙련도" id="획득숙련도">
                        </div>

                    </div>
                </div>
            </div>

            <div class="사백픽셀테두리 세로정렬" id="등급외테두리" style="position: relative;">
                <div class="풀자동" id="반자동"
                    style="position: absolute; top: 5px; left: 10px; cursor: pointer; font-size: 16px;">
                    반자동
                </div>
                <div class="풀자동" id="풀자동"
                    style="position: absolute; top: 5px; right: 10px; cursor: pointer; font-size: 16px;">
                    풀자동
                </div>

                <div class="세로정렬" id="전투버튼박스">
                    <div>
                        <div style="display: inline-block;" class="공격버튼" id="공격버튼">악마성</div>
                    </div>
                    <div style="display: none;" class="레어몬스터" id="레어몬스터">레어몬스터</div>

                </div>


                <div class="가로정렬" id="승리패배로그">
                </div>
                <div class="가로정렬" id="획득로그">
                </div>
                <div class="가로정렬" id="추가획득로그">
                </div>

                <div class="가로정렬" id="레벨업표시">

                </div>
            </div>
        </div>

        <div class="사백픽셀테두리 유저테두리 양쪽정렬" id="유저테두리안표시">
            <div id="유저아이디">

            </div>
            <div class="세로정렬">
                <div id="유저공격력">
                </div>
                <div id="유저체력">
                </div>
            </div>

        </div>
        <div id="몬스터테두리안표시">
            <div class="사백픽셀테두리 몬스터테두리 양쪽정렬">
                <div id="악마이름">
                </div>
                <div class="세로정렬">
                    <div id="악마체력">
                    </div>
                    <div id="악마방어력">
                    </div>
                </div>

            </div>
        </div>

    </div>

    <div id="전당화면" style="display: none;">
        <div id="전당컨테이너" class="사백픽셀테두리 세로정렬">
        </div>
    </div>



    <div id="블로커" style="
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0);
  z-index: 9999;
  display: none;
  cursor: wait;
"></div>

    <div id="장비화면" style="display: none;">
        <div class="양쪽정렬">
            <div id="장비골드표시" style="color: #f5c400; margin-top: 10px;">

            </div>
            <div id="장비자동합성" style="cursor: pointer; margin-top: 15px; margin-right: 15px">

            </div>
        </div>

        <div class="사백픽셀테두리 세로정렬" id="장비컨테이너">
        </div>
    </div>

    <div id="스킬화면" style="display: none;">
        <div class="밑줄" id="보유숙련도">

        </div>
        <div style="font-size: 12px; color: #888" id="필요숙련도">

        </div>

        <div class="사백픽셀테두리" id="스킬컨테이너">
        </div>
    </div>

    <div id="캐시샵화면" style="display: none;">
        <div class="사백픽셀테두리" id="캐시샵컨테이너">

        </div>
    </div>


    <div id="미니정보창" class="사백픽셀테두리" style="
    position: fixed;
    top: 57px;
    left: 300px;
    z-index: 99999;
    background: black;
    color: white;
    display: none;
    max-height: 600px;
    overflow-y: auto;
  "></div>

    <div id="메시지표시박스" style="
    position: fixed;
    top: 130px;
    left: 740px;
    right: 900px;
    height: 500px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
    padding: 10px;
    box-sizing: border-box;
    pointer-events: none;
"></div>
    <!-- background: rgba(23, 221, 33, 0.897); -->

    <div id="뽑기창" class="기본테두리 세로정렬" style="
  display: none;
  position: fixed;
  top: 20%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: black;
  color: white;
  z-index: 9998;
  padding: 20px;
  text-align: center;
  width:auto;
">
        <div id="뽑기타이틀" style="font-size: 20px; font-weight: bold;"></div>
        <div style="margin-top: 15px;">
            <div class="버튼" onclick="장비뽑기시도('일반')">일반장비뽑기 (10만)</div>
            <div class="버튼" onclick="장비뽑기시도('연속일반')">연속일반장비뽑기 (100만)</div>
            <div class="버튼" onclick="장비뽑기시도('고급')">고급장비뽑기 (티켓)</div>
            <div class="버튼" onclick="장비뽑기시도('연속고급')">연속고급장비뽑기(10+1) (티켓열장)</div>
            <div class="버튼" onclick="유물뽑기시도('일반')">유물뽑기 (10만)</div>
            <div class="버튼" onclick="유물뽑기시도('연속일반')">연속유물뽑기 (100만)</div>
        </div>
    </div>

    <div id="펫컨테이너" style="
  position: fixed;
  top: 200px;
  left: 200px;
  pointer-events: none;
  z-index: 99999;
  transform: scale(0.1);
  background: transparent;
">
    </div>
    <!-- 객체추가 -->

    <script>
        let 기기ID = localStorage.getItem("기기ID");

        if (!기기ID) {
            기기ID = crypto.randomUUID();
            localStorage.setItem("기기ID", 기기ID);
        }

        window.addEventListener("load", () => {
            setTimeout(() => {
                document.getElementById("네온박스").style.display = "none";
            }, 3000);
        });

        const 색상맵 = {
            "일반": "#c8c8c8",
            "레어": "#00c000",
            "신화": "#4141ff",
            "고대": "#c8c800",
            "태초": "#d400d4",
            "타락": "#ff0000",
            // "공허": "#ff0000",
            // "공허": "#CD7F32",

            "빨": "#ff0000",
            "주": "#ff8000",
            "노": "#ffff00",
            "초": "#00ff00",
            "파": "#0080ff",
            "남": "#8a2be2",
            "보": "#800080",

            "빨주": "#ff4000",
            "주노": "#ffbf00",
            "노초": "#80ff00",
            "초파": "#00ff80",
            "파남": "#4455d0",
            "남보": "#851bb1"
        };

        //잡아이콘
        const 서클체크아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-check-big-icon lucide-circle-check-big"><path d="M21.801 10A10 10 0 1 1 17 3.335"/><path d="m9 11 3 3L22 4"/></svg>'
        const 머니아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-coins-icon lucide-coins"><circle cx="8" cy="8" r="6"/><path d="M18.09 10.37A6 6 0 1 1 10.34 18"/><path d="M7 6h1v4"/><path d="m16.71 13.88.7.71-2.82 2.82"/></svg>`;
        const 성공아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-party-popper-icon lucide-party-popper"><path d="M5.8 11.3 2 22l10.7-3.79"/><path d="M4 3h.01"/><path d="M22 8h.01"/><path d="M15 2h.01"/><path d="M22 20h.01"/><path d="m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10"/><path d="m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17"/><path d="m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7"/><path d="M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z"/></svg>`;
        const 실패아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ban-icon lucide-ban"><circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/></svg>`;
        const 마스터아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-graduation-cap-icon lucide-graduation-cap"><path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z"/><path d="M22 10v6"/><path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5"/></svg>`;
        const 뽑기아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dices-icon lucide-dices"><rect width="12" height="12" x="2" y="10" rx="2" ry="2"/><path d="m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6"/><path d="M6 18h.01"/><path d="M10 14h.01"/><path d="M15 6h.01"/><path d="M18 9h.01"/></svg>`;
        const 공격력아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-swords-icon lucide-swords"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" x2="19" y1="19" y2="13"/><line x1="16" x2="20" y1="16" y2="20"/><line x1="19" x2="21" y1="21" y2="19"/><polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5"/><line x1="5" x2="9" y1="14" y2="18"/><line x1="7" x2="4" y1="17" y2="20"/><line x1="3" x2="5" y1="19" y2="21"/></svg>`;
        const 체력아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-icon lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>`;
        const 마법진아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-aperture-icon lucide-aperture"><circle cx="12" cy="12" r="10"/><path d="m14.31 8 5.74 9.94"/><path d="M9.69 8h11.48"/><path d="m7.38 12 5.74-9.94"/><path d="M9.69 16 3.95 6.06"/><path d="M14.31 16H2.83"/><path d="m16.62 12-5.74 9.94"/></svg>`;

        //루시드아이콘
        const 크리티컬아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-axe-icon lucide-axe"><path d="m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9"/><path d="M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z"/></svg>`;
        const 버서커아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>`;
        const 드레인아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-droplet-icon lucide-droplet"><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z"/></svg>`;
        const 인사이트아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-diamond-plus-icon lucide-diamond-plus"><path d="M12 8v8"/><path d="M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41L13.7 2.71a2.41 2.41 0 0 0-3.41 0z"/><path d="M8 12h8"/></svg>`;
        const 아이언바디아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-biceps-flexed-icon lucide-biceps-flexed"><path d="M12.409 13.017A5 5 0 0 1 22 15c0 3.866-4 7-9 7-4.077 0-8.153-.82-10.371-2.462-.426-.316-.631-.832-.62-1.362C2.118 12.723 2.627 2 10 2a3 3 0 0 1 3 3 2 2 0 0 1-2 2c-1.105 0-1.64-.444-2-1"/><path d="M15 14a5 5 0 0 0-7.584 2"/><path d="M9.964 6.825C8.019 7.977 9.5 13 8 15"/></svg>`;
        const 퀵니스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-history-icon lucide-history"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>`;
        const 발굴아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gem-icon lucide-gem"><path d="M6 3h12l4 6-10 13L2 9Z"/><path d="M11 3 8 9l4 13 4-13-3-6"/><path d="M2 9h20"/></svg>`;
        const 버닝아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-battery-charging-icon lucide-battery-charging"><path d="M15 7h1a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-2"/><path d="M6 7H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h1"/><path d="m11 7-3 5h4l-3 5"/><line x1="22" x2="22" y1="11" y2="13"/></svg>`;
        const 인텔리전스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-plus-icon lucide-copy-plus"><line x1="15" x2="15" y1="12" y2="18"/><line x1="12" x2="18" y1="15" y2="15"/><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>`;
        const 브로큰아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield-off-icon lucide-shield-off"><path d="m2 2 20 20"/><path d="M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71"/><path d="M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264"/></svg>`;
        const 즉사아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-skull-icon lucide-skull"><path d="m12.5 17-.5-1-.5 1h1z"/><path d="M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z"/><circle cx="15" cy="12" r="1"/><circle cx="9" cy="12" r="1"/></svg>`;
        const 봄아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flower2-icon lucide-flower-2"><path d="M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1"/><circle cx="12" cy="8" r="2"/><path d="M12 10v12"/><path d="M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z"/><path d="M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z"/></svg>`;
        const 여름아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-icon lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>`;
        const 가을아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-leaf-icon lucide-leaf"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></svg>`;
        const 겨울아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-snowflake-icon lucide-snowflake"><path d="m10 20-1.25-2.5L6 18"/><path d="M10 4 8.75 6.5 6 6"/><path d="m14 20 1.25-2.5L18 18"/><path d="m14 4 1.25 2.5L18 6"/><path d="m17 21-3-6h-4"/><path d="m17 3-3 6 1.5 3"/><path d="M2 12h6.5L10 9"/><path d="m20 10-1.5 2 1.5 2"/><path d="M22 12h-6.5L14 15"/><path d="m4 10 1.5 2L4 14"/><path d="m7 21 3-6-1.5-3"/><path d="m7 3 3 6h4"/></svg>`;
        const 현질아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wand-sparkles-icon lucide-wand-sparkles"><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72"/><path d="m14 7 3 3"/><path d="M5 6v4"/><path d="M19 14v4"/><path d="M10 2v2"/><path d="M7 8H3"/><path d="M21 16h-4"/><path d="M11 3H9"/></svg>`;
        const 해머아이콘 = `<svg xmlns="http://www.w3.org/2000/svg"
     width="18" height="18" viewBox="0 0 24 24"
     fill="none" stroke="currentColor" stroke-width="2"
     stroke-linecap="round" stroke-linejoin="round"
     class="lucide lucide-hammer-icon lucide-hammer"
     style="cursor:pointer">
  <path d="m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9"/>
  <path d="m18 15 4-4"/>
  <path d="m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5"/>
</svg>`;

        //유물아이콘
        const 소드아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sword-icon lucide-sword"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" x2="19" y1="19" y2="13"/><line x1="16" x2="20" y1="16" y2="20"/><line x1="19" x2="21" y1="21" y2="19"/></svg>`;
        const 하트플러스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-plus-icon lucide-heart-plus"><path d="M13.5 19.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5A5.5 5.5 0 0 1 7.5 3c1.76 0 3 .5 4.5 2 1.5-1.5 2.74-2 4.5-2a5.5 5.5 0 0 1 5.402 6.5"/><path d="M15 15h6"/><path d="M18 12v6"/></svg>`;
        const 고스트아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost-icon lucide-ghost"><path d="M9 10h.01"/><path d="M15 10h.01"/><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"/></svg>`;
        const 쉴드밴아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield-ban-icon lucide-shield-ban"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/><path d="m4.243 5.21 14.39 12.472"/></svg>`;
        const 하트마이너스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-minus-icon lucide-heart-minus"><path d="M13.5 19.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5A5.5 5.5 0 0 1 7.5 3c1.76 0 3 .5 4.5 2 1.5-1.5 2.74-2 4.5-2a5.5 5.5 0 0 1 5.402 6.5"/><path d="M15 15h6"/></svg>`;
        const 엑스아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-axe-icon lucide-axe"><path d="m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9"/><path d="M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z"/></svg>`;
        const 암포라아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-amphora-icon lucide-amphora"><path d="M10 2v5.632c0 .424-.272.795-.653.982A6 6 0 0 0 6 14c.006 4 3 7 5 8"/><path d="M10 5H8a2 2 0 0 0 0 4h.68"/><path d="M14 2v5.632c0 .424.272.795.652.982A6 6 0 0 1 18 14c0 4-3 7-5 8"/><path d="M14 5h2a2 2 0 0 1 0 4h-.68"/><path d="M18 22H6"/><path d="M9 2h6"/></svg>`;
        const 모루아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-anvil-icon lucide-anvil"><path d="M7 10H6a4 4 0 0 1-4-4 1 1 0 0 1 1-1h4"/><path d="M7 5a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1 7 7 0 0 1-7 7H8a1 1 0 0 1-1-1z"/><path d="M9 12v5"/><path d="M15 12v5"/><path d="M5 20a3 3 0 0 1 3-3h8a3 3 0 0 1 3 3 1 1 0 0 1-1 1H6a1 1 0 0 1-1-1"/></svg>`;
        const 클로버아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clover-icon lucide-clover"><path d="M16.17 7.83 2 22"/><path d="M4.02 12a2.827 2.827 0 1 1 3.81-4.17A2.827 2.827 0 1 1 12 4.02a2.827 2.827 0 1 1 4.17 3.81A2.827 2.827 0 1 1 19.98 12a2.827 2.827 0 1 1-3.81 4.17A2.827 2.827 0 1 1 12 19.98a2.827 2.827 0 1 1-4.17-3.81A1 1 0 1 1 4 12"/><path d="m7.83 7.83 8.34 8.34"/></svg>`;
        const 플라워아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flower-icon lucide-flower"><circle cx="12" cy="12" r="3"/><path d="M12 16.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 1 1 12 7.5a4.5 4.5 0 1 1 4.5 4.5 4.5 4.5 0 1 1-4.5 4.5"/><path d="M12 7.5V9"/><path d="M7.5 12H9"/><path d="M16.5 12H15"/><path d="M12 16.5V15"/><path d="m8 8 1.88 1.88"/><path d="M14.12 9.88 16 8"/><path d="m8 16 1.88-1.88"/><path d="M14.12 14.12 16 16"/></svg>`;
        const 티켓아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ticket-icon lucide-ticket"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M13 5v2"/><path d="M13 17v2"/><path d="M13 11v2"/></svg>`;
        const 모래시계아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hourglass-icon lucide-hourglass"><path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"/><path d="M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"/></svg>`;
        const 퍼즐아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-puzzle-icon lucide-puzzle"><path d="M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z"/></svg>`;
        const 로켓아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rocket-icon lucide-rocket"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>`;
        const 표창아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-fan-icon lucide-fan"><path d="M10.827 16.379a6.082 6.082 0 0 1-8.618-7.002l5.412 1.45a6.082 6.082 0 0 1 7.002-8.618l-1.45 5.412a6.082 6.082 0 0 1 8.618 7.002l-5.412-1.45a6.082 6.082 0 0 1-7.002 8.618l1.45-5.412Z"/><path d="M12 12v.01"/></svg>`;
        const 소생아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="height: 24px; width: 24px;"></path><g class="" transform="translate(0,0)" style=""><path d="m192 17.65 16 34h96l16-34zm-9 53v51.95h32v22.2c-19.3-9-42.6-8.2-55-8.2-50.5 0-82.1 21.9-99.5 48-17.4 26.1-21.5 55.5-21.5 73 0 52.5 38.6 94.4 83.3 131C167 425.1 219 457.3 249.6 488l6.4 6.3 6.4-6.3c30.6-30.7 82.6-62.9 127.3-99.4 44.7-36.6 83.3-78.5 83.3-131 0-17.5-4.1-46.9-21.5-73s-49-48-99.5-48c-12.4 0-35.7-.8-55 8.2v-22.2h32V70.65zm18 18h110v15.95H201zm32 33.95h46v60.7l15.4-15.3c11.7-11.8 41.6-13.4 57.6-13.4 45.5 0 69.9 18.1 84.5 40 14.6 21.9 18.5 48.5 18.5 63 0 43.5-33.4 81.7-76.7 117-40.7 33.4-89 63.5-122.3 94.7-33.3-31.2-81.6-61.3-122.3-94.7-43.3-35.3-76.7-73.5-76.7-117 0-14.5 3.9-41.1 18.5-63s39-40 84.5-40c16 0 45.9 1.6 57.6 13.4l15.4 15.3zm-41 71c-64 0-80 48-80 80 0 64 80 96 144 144 64-48 144-80 144-144 0-32-16-80-80-80-32 0-48 0-64 48-16-48-32-48-64-48zm125.7 14.6c3.6-.1 5.9.3 5.8.6-16.5 7.3-33.9 24.4-44.6 41.7 0 0-3.2-17.7 9.9-31.9 7.4-8.1 21.1-10.3 28.9-10.4zM192 209.6c-24 21.5-41.3 58.2-47.2 90.4 0 0-19.5-23.7-7.7-53.4 9.8-24.5 50.1-36.5 54.9-37z" fill="#fff" fill-opacity="1"></path></g></svg>`;
        const 샐러드아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-salad-icon lucide-salad"><path d="M7 21h10"/><path d="M12 21a9 9 0 0 0 9-9H3a9 9 0 0 0 9 9Z"/><path d="M11.38 12a2.4 2.4 0 0 1-.4-4.77 2.4 2.4 0 0 1 3.2-2.77 2.4 2.4 0 0 1 3.47-.63 2.4 2.4 0 0 1 3.37 3.37 2.4 2.4 0 0 1-1.1 3.7 2.51 2.51 0 0 1 .03 1.1"/><path d="m13 12 4-4"/><path d="M10.9 7.25A3.99 3.99 0 0 0 4 10c0 .73.2 1.41.54 2"/></svg>`;
        const 햄버거아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hamburger-icon lucide-hamburger"><path d="M12 16H4a2 2 0 1 1 0-4h16a2 2 0 1 1 0 4h-4.25"/><path d="M5 12a2 2 0 0 1-2-2 9 7 0 0 1 18 0 2 2 0 0 1-2 2"/><path d="M5 16a2 2 0 0 0-2 2 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 2 2 0 0 0-2-2q0 0 0 0"/><path d="m6.67 12 6.13 4.6a2 2 0 0 0 2.8-.4l3.15-4.2"/></svg>`;
        const 마법의팔레트아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-palette-icon lucide-palette"><path d="M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z"/><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/></svg>`;
        const 뼈다구아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bone-icon lucide-bone"><path d="M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z"/></svg>`;

        //보스아이콘
        const 그루트아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"></path><g class="" transform="translate(0,0)" style=""><path d="m125.5 24.44-15.2 9.64c4.7 7.36 4.1 9.89 2.6 12.91-8.4 11.18-22.25 15.83-32.31 23.89-6.38 5.2-12.53 13.64-10.92 23.76 2.17 13.46 12.66 22.56 23.15 29.76 12.38-.5 25.48.6 36.18.6l.2-.4c-11-5.5-39.08-21.1-41.75-32.85C97.5 75.04 120.3 71.43 128.9 55.13c4.3-8.5 3.4-19.93-3.4-30.69zm92.8.3c-1.8 17.62-4.3 32.04-7.1 44.98l28.3 17.12-33.5 5.31c-3.3 12.75-5.7 22.95-8.4 34.55-10.5 5-22.1 9.4-32.2 12 12.6 6.5 25.2 14.8 30.5 28.1 3.6 8.8 2.1 17.9-.9 25.7-2.9 7.7-7.3 14.8-11.2 21.4-3.9 6.6-7.2 12.7-8.5 17.3.4 23 31.4 26.9 47.4 22.7 1.1-6.6 5.6-13 9.8-17.2-7.4-2.6-14.7-6.3-20.1-12.9-5.9-7.2-7.8-18.4-3.2-29.1 3.7-6.6 11.1-10.7 17.6-11.7 11.5-.9 22.3 1.4 32.8 4.3.8-6.9 2.2-14 4.9-20.3 2.1-4.9 5.5-9.9 10.4-12.9l-11-10.8-17.5 16.5-17.6-17.5-16.8 13 7.3-44.6 14.1 14.7 10.2-15.1 9.1 21.1 18.2-26.5 7.7 47.4c2.7-1 5.3-1.3 7.9-1.3 8.1.5 14.9 5.5 19.3 11.3 5 7.3 8.5 15.4 10.7 22.7 1.4-.8 2.7-1.5 4.1-2.3 6.3-3.3 12.8-6.4 19.5-8-23.2-6.9-27.4-26-28.1-48.7-9.4-.8-16.4-.6-25.6-.4-2-11.2-3.6-23.2-4.8-33.07l-33.8-5.33 30.8-18.68c-1.9-13.34-4.4-26.41-8.9-39.3-14.4 3.78-33 3.98-51.4-4.48zm165.1 22.69s-37.8 20.36-34.6 36.93c1 5.29 5.3 10.28 10.7 13.98-2.5 6.06-3.5 12.06-3.9 18.16 5.9 1.8 11.6 3.8 17.2 5.9-.8-6.3-1.2-12.6-.6-18.8 5.2 1.1 10.3.6 14.1-1.9 15-10.11-2.9-54.27-2.9-54.27zm-53.2 81.07c2.2 14.8 2.2 27.2 17.4 29.4 14.6 3.3 29.9-2.2 42.2 1.2-2.1-4.2-4.2-8.5-6.1-12.8-17.3-7.4-34.3-14.1-53.5-17.8zm-226.1 13.9c-6.18 13.7-12.41 27.3-18.42 40.9-3.84-3-8.01-5.6-12.87-7.5 1.19-6.5.56-13.1-2.54-17.5-3.33-4.7-10.35-6.3-18.12-6.3-14.84-.1-32.45 5.5-32.45 5.5s19.21 43.5 36.96 39.9c4.45-1 8.29-4.3 11.18-8.8 3.97 3.1 7.5 6.8 10.82 10.8-9.36 22-17.81 44-24.12 66.5 21.79 2 39.71 9.7 55.46 19.4 8-32.7 15.2-60.4 30.3-84.9l29.1 2.4c4.3-8.4 13.5-19.9 9.9-29.2-13.1-16.5-29.9-23.6-49.1-30.5-9.2 0-17.7-.5-26.1-.7zm177 31.7c-1.4 3.3-2.6 8.2-3.3 13.4 3.5-1.1 7.2-1.7 11-1.7 3.3 0 6.4.4 9.4 1.2-1.9-5.5-4.3-10.6-6.7-13.8-5-6.6-8.2-4.2-10.4.9zm78.4 2.4c2.5 1.5 4.8 3.8 6.3 6.5 5.2 9.2 2.5 20-2.7 27.5-.8 1.1-1.6 2.3-2.5 3.3l40.2 68.1c1.7-8.8 3.5-20.4 4.7-33 2.4-26.1.2-55.5-9.3-67.2-9.6-8.6-24.9-5.6-36.7-5.2zm-13.4 15.3c-4.2.7-10.7 3.4-16.9 6.8-1.8 1-3.6 2-5.2 3 5.9 2.6 11.3 5.4 15.5 7.9 3.7-3.2 6.9-6.4 8.8-9.2 3.2-5.6 4.2-9.7-2.2-8.5zm-120.3 10c-4.2 3.5-1.8 7.8.5 10.6 2.3 2.7 7.6 5.9 14 8 3.9 1.2 8.1 2.2 11.9 2.9.1-6.5 1.6-13.3 4.2-18.2-7.9-2.2-25-6.2-30.6-3.3zm63 2c-10.5 0-18.6 8-18.6 17.8s8.1 17.8 18.6 17.8c10.5 0 18.6-8 18.6-17.8s-8.1-17.8-18.6-17.8zm135.7 9.9c.8 12.3 0 25-1.1 36.9-1.3 13.6-3.3 26-5.1 35.3 16.2-8.2 28.3-19.6 37.2-33.9-10.8-12.5-21.2-25.2-31-38.3zm-97.8 9.3c-3.3 6.4-4.3 13.9-8 19.1 3.4 3.1 7.5 6.5 12.3 10 5.3 3.8 10.9 7 14.8 8.3 7.2 3.3 9.8-7.3 8.6-11.6-1-3.9-4.8-9-10-13.6-6.1-5.4-12.6-9.3-17.7-12.2zM258 240.8c-6.3 4-14.7 7.6-17.4 15.1-1.1 6.1 5.7 14.7 12.2 13.2 8-3.6 12.7-10 16.8-17.1-4.7-2.8-8.6-6.6-11.6-11.2zm46.8 13c-4.7 2.2-10 3.5-15.5 3.6 1.7 10.3 4.1 29.9 11.4 35 8.7.7 9.9-33.4 4.1-38.6zm-136.2 4.9c-3.4 16.9-6.8 34-10.4 51 10.9 7.3 22.5 16.2 30.5 25 6.9 7.7 12.5 16.4 13.5 26.7.8 8.9-3.4 16.6-8.5 22.1s-11.1 9.8-16.7 13.9-10.7 7.9-13.6 11.2c-2.9 3.4-3.5 5.1-3 7.6 1.9 3.8 8.6 5.1 12.6 6.4 4.4 1.3 9.3 2.7 14.2 5.2 4.9 2.4 10.1 6.4 12.6 12.9v.1c6.9-48 12.3-90.5 27.5-128.5l51.8-1.4c3.9 14.9 7.9 30.8 11.3 43.7 9.1 13 18.4 25.9 30.7 35.2 6 4.4 11.2 6.3 14.9 6.1 5-10.9 8-25.1 19.8-27.9 5.2-1.1 10.3-1 15.3.1-4.3-10.6-8.4-21.1-12.4-31.7-8.4 3.9-18 7.5-28.3 4.7-12.6-3.4-21-13.3-27.7-24.2-1.3-2.2-2.6-4.4-3.8-6.7-7.5-.8-12.9-6.1-16.5-11.7-4-7.5-6.6-15.3-8.2-22.6-4.6 4.8-10.2 9.1-17.4 10.8-13.5.3-24.3-5.2-30.3-15.2-7.6 2-14.9 2.9-21.8 2.6-14.1-.6-26.4-6.2-36.1-15.4zm301.7 3.6c-3.4 5.4-7.2 10.4-11.5 15.1l10.9 3.7 4.8 30.4 17.8-2.8-6.6-41.2zm-145.8 7.2c-.1 8-.8 16.2-3.4 23.7-1.2 3.6-2.8 7-5.4 10 4.5 7.7 11.1 18.1 19.3 20.5 1.9.5 9.9-1.2 17.2-4.2-5.5-14.7-11-29.2-16.6-43.8-3.9-1.7-7.6-3.8-11.1-6.2zm-277.31 14-23.9 46.8 16.04 8.2 26.85-52.6c-5.92-1.4-12.22-2.2-18.99-2.4zm25.07 3.9-14.89 39.2-6.19 35.3 17.72 3.2 5.91-33.7L89.03 294c-5.33-2.6-10.88-4.8-16.77-6.6zm372.14 3.3c-4.7 3.6-9.7 6.8-15 9.8l29.2 48.9 15.4-9.2zm-349.93 6.2 2.64 39.7-14.34 18.6 14.26 11 18.47-24-2.2-33.1c-6.2-4.5-13-9-18.83-12.2zm324.03 8.9c-6.4 2.7-11.3 4.3-17.6 6.3l1.3 18.5 22.3 17.1 11-14.2-15.9-12.3zm-264.4 22.9c-3 14-6.1 27.9-9.4 41.9-14 22.5-35.4 46.8-53.15 56.4-9.69 5.3-17.05 6.2-22.71 3.4-5.67-2.8-12.14-10.9-16.34-29.5l-17.56 4c4.82 21.4 13.3 35.4 25.9 41.6 12.6 6.3 26.8 3.2 39.36-3.7 11.6-6.4 22.9-16.1 33.2-27.3-5.7 21.3-11.9 42.6-18.8 64 18.1 11.4 40.3 7.7 63 2.5 5-13.4 7.7-28.9 5.4-34.9-.4-.9-1.2-1.9-3.9-3.3-2.7-1.3-6.8-2.6-11.4-4-4.5-1.4-9.4-2.8-14.2-5.6-4.7-2.9-9.6-8-10.9-14.8-1.5-8.9 2.4-16.9 7.2-22.6 4.9-5.6 11-9.9 16.6-14 5.6-4.1 10.8-8 14-11.4 3.2-3.5 4.1-5.7 3.8-8.3v-.1c-.4-4.2-3.5-10.2-8.9-16.3-5.5-6.1-13-12.3-20.6-17.6-.2-.1-.4-.3-.6-.4zm202 65.6c-2.9 9.2-8.7 18.5-17.9 19.6-10.4 1-19.7-3.6-27.8-9.6-3-2.3-6-4.8-8.8-7.4 8.1 28.7 17.4 56.9 30.1 84.2 39.8 9.8 69.2 6.5 98 2.5-12.4-19-23.1-38.3-32.8-57.7 6.3-1.1 12.5-2.7 18.6-6 4.2 5 9.6 8.7 15 9.1 16.7 1.4 33-38.3 33-38.3s-17.9-5.1-33.4-5c-9.3 0-17.8 1.9-20.9 7.9-2.2 4-2 9.2-.4 14.2-6.5 1.4-13.2 1.6-19.9 1.4-2.6-5.5-5.1-11.1-7.5-16.6-14.3-9.3-20.2-13.7-25.3 1.7z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 락골렘아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"></path><g class="" transform="translate(0,0)" style=""><path d="m227.7 25-57.9 57.96L183.4 151h145.2l13.6-68.04-32.8-32.84L282.5 64l16.3-24.53L284.3 25h-56.6zM195 88.44 240 111l-4 17h-41V88.44zm122 0V128h-41l-4-17 32-16.05 13-6.51zM154 109.1l-22 11 10.6 17.1-24.1-10.4L73 149.6v16l91.8-13.1-10.8-43.4zm204 0-10.8 43.4 91.8 13.1v-16l-81-40.5zm-152.4 60.1-63.3 4.7-6.6 1-9.2 62.3 50.2 25.1 44.5-14.8 5.6 17-51.5 17.2-44.4-22.2 20.4 84.5 95.7 13.6V196.8l-41.4-27.6zm100.8 0L265 196.8v160.8l95.7-13.6 20.4-84.5-23.8 11.9-19.6 38.6-18.8-34.2-33.7-11.3 5.6-17 44.5 14.8 50.2-25.1-9.2-62.3-6.6-1-63.3-4.7zm-189.6 8.4-61.32 8.7-30.04 40.1 3.64 25.5 25.38 10.4L33.09 280l6.47 45.3L103 312.7v-57.4l13.8-77.7zm278.4 0 13.8 77.6v57.4l52 10.4 13.7-13.7 11.9-82.9-30.1-40.1-28-4-4.2 17.9-9.9-19.9-19.2-2.7zM104.1 330.8 42.78 343l28 126 47.42-11.8-14.1-126.4zm303.8 0-14.1 126.4 22.6 5.6 7.9-25.8 17.8 28.1L469.2 343l-61.3-12.2zm-256 31.4L138.1 487h80.3l37.6-75.1 37.6 75.1h30.8l11.6-23 11.5 23h26.4l-13.8-124.8L256 377.1l-41.9-6-6.1 34.4-15.3-37.5-40.8-5.8z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 미노타우르스아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"></path><g class="" transform="translate(0,0)" style=""><path d="M110 18.906c-3.766 9.014-2.938 15.91-2.938 28.032 0 26.995 24.076 48.413 52.563 52.562 19.28 2.807 39.315 4.758 59.594 5.813-8.56 7.39-13.907 18.092-13.907 35.124 0 17.576 6.436 37.856 16.562 52.97 10.126 15.112 23.233 24.374 36.03 24.374 12.8 0 25.906-9.26 36.033-24.374 10.126-15.113 16.562-35.392 16.562-52.97 0-17.186-5.43-27.946-14.125-35.342 19.053-1.09 37.854-2.952 56-5.594 28.487-4.147 51.47-23.72 52.563-52.563.368-9.723-1.637-18.74-2.938-28.03-2.943 27.71-26.205 45.69-54.313 49.656-59.833 8.443-123.54 8.443-183.375 0-28.107-3.966-51.37-21.945-54.312-49.657zm79.78 99.313c-248.928 7.213-200.628 194.293-22.124 242.5 40.812-39.456-6.55-101.937-43.72-57.033-23.22-43.474-20.674-82.77 4.5-95.03 48.72 27.067 83.566 88.52 86.126 148.405-33.595 23.148-59.625 63.032-59.625 63.032l26.344 38.78-41.31 23.5h82.124c-40.513-40.52-11.77-86.093 36.22-86.093 48.645 0 74.12 48.22 36.248 86.095h81.282l-40.47-23.5 26.345-38.78s-26.458-40.502-60.44-63.564c2.744-59.716 37.52-120.887 86.095-147.874 25.176 12.262 27.722 51.557 4.5 95.03-37.168-44.903-84.53 17.578-43.72 57.033 178.5-48.206 226.788-235.28-22.124-242.5 2.054 6.73 3.158 14.17 3.158 22.218 0 21.95-7.423 45.024-19.72 63.375-12.295 18.35-30.17 32.656-51.562 32.656-21.392 0-39.266-14.306-51.562-32.657-12.296-18.352-19.72-41.426-19.72-63.375 0-8.048 1.105-15.488 3.157-22.22z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 가고일아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"></path><g class="" transform="translate(0,0)" style=""><path d="m136.6 28.1 45.9 57.31c.4.42.5.48.9.5 14.3-4.99 24.8-22.15 29.8-35.94zm238.8 0-76.6 21.87c4.1 10.62 17.6 34.33 29.8 35.94.4 0 .5-.1.9-.5zM97.27 44.18C82.9 68.72 65.8 84.24 39 98.2 25 127.7 21.2 165 24.9 198.7c3 26.9 11.1 51.3 20.8 67.2.7-2.4 1.4-4.5 2-7.2 2.1-9.2 3.8-19.3 6.7-27.8 1.5-4.2 3.1-8.2 6.6-11.7 3.5-3.6 10.5-5.6 15.8-3.7 5.4 1.9 9.1 5.5 13.3 10.7 1 1.3 2.18 3 3.28 4.6 6.72-17.9 14.22-29.3 24.02-35.7 6.3-4.1 13.9-5.4 20.7-3.9 5.1 1 9.6 3.4 13.8 6.5 10.2-7.1 23-11.3 36.1-14-7-8.6-13.9-17-21.6-24.9l3.9-23.4c-17.4-9.2-34.8-19.4-52.6-30.8 1.8 7.2 3.1 14.6 3.3 22.3.5 16.4-4.2 33.9-18.1 50.6l-13.8-11.6c11.3-13.5 14.3-25.6 13.9-38.4-.2-8.6-2.3-17.6-5.1-26.9-13.18 13.1-33.69 31.7-49.9 32.1v-18c19.88-6.2 33.53-23.24 47.63-37.36l5.27-5.22 6.1 4.09c23.2 15.46 44.8 28.99 66.4 40.49l2.6-15.5c-29.7-14.7-58.8-33.46-78.73-57.02zm317.43 0c-19.9 23.56-49 42.32-78.7 57.02l2.6 15.5c21.6-11.5 43.2-25.02 66.4-40.49l6.1-4.09 5.3 5.22c10.2 9.63 34.1 36.76 47.6 37.36v18c-21.7-2.9-36.1-18.3-49.9-32.1-2.8 9.3-4.9 18.3-5.1 26.9-.4 12.8 2.6 24.9 13.9 38.4l-13.8 11.6c-13.9-16.6-18.6-34.2-18.1-50.6.2-7.7 1.5-15.1 3.3-22.3-17.8 11.4-35.2 21.6-52.6 30.8l3.9 23.4c-8.1 8.2-15.6 17.5-21.6 24.9 13.1 2.7 25.9 6.9 36.1 14 4.2-3.1 8.7-5.5 13.8-6.5 6.8-1.5 14.4-.2 20.7 4 9.8 6.3 17.3 17.7 24 35.6 1.1-1.6 2.3-3.3 3.3-4.6 4.2-5.2 7.9-8.8 13.2-10.7 5.4-1.9 12.4.1 15.9 3.7 3.5 3.5 5.1 7.5 6.6 11.7 2.9 8.5 4.6 18.6 6.7 27.8.6 2.7 1.3 4.8 2 7.2 9.7-15.9 17.8-40.3 20.8-67.2 3.7-33.7-.1-71-14.1-100.5-26.8-13.96-43.9-29.48-58.3-54.02zM247 55.23l-18.1 4.51c-4.3 9.23-10.2 18.75-16 25.72-5.5 6.58-11.5 12.34-18.7 15.84l-8.6 51.6c12.4 13.7 22 27 33 39.2l17.1-21.4H247v-11.9c-15.7-3.5-28.7-8.9-43.1-16.1l8.2-16c12.6 6.3 29 14.7 43.9 15 16.2-2.4 29.3-7.7 43.9-15l8.2 16c-14.1 6.4-28 13.3-43.1 16.1v11.9h11.3l17.1 21.4c11.5-12.4 22.2-27.2 33-39.2l-8.6-51.6c-7.2-3.5-13.2-9.26-18.7-15.84-6.8-8.5-11.9-16.85-16-25.72L265 55.23V91.7h-18zm-2.7 133.47-13 16.3c2.2 2.4 6.6 4.6 8.7 5.7h32c4.1-2.6 5.6-3.1 8.7-5.7l-13-16.3zm-43.1 10.9c-15.7 3.1-40.3 10.5-48.1 22.4 4.7 33.5 17.6 65.7 31.4 90.6l33.2 132.8-19.7 29.5 28-9.4 21 18.4v-39.1l-32-128c-3.2-19.9-1.3-45.6-13.4-58.7l12.8-12.8c17 17.1 18.6 43.8 18.6 61.4h46c0-17.6 1.6-44.3 18.6-61.4l12.8 12.8c-11.4 16.7-13.4 39-13.4 58.7l-32 128v39.1l21-18.4 28 9.4-19.7-29.5 33.2-132.8c12.5-30.5 30.1-62 31.4-90.6-13.7-14.7-31.9-19.8-48.1-22.4-6.2 7.2-12.3 13.9-18.4 19.2-6.1 5.2-11.9 9.9-20.4 9.9h-32c-8.5 0-14.3-4.7-20.4-9.9-6.1-5.3-12.2-12-18.4-19.2zM148 277.3c-10.1 6.9-29.1 16.4-28.9 26.4 7.9 47.7 33.3 87.6 47.3 101.6l9.6 9.7-52.7 21.1 32.2 1-9.8 22.8 29.6-8.3 9.8 10.2 13.2-19.8-30.8-123.2c-6.8-13.6-13.8-27.4-19.5-41.5zm216 0c-5.7 14.1-12.7 27.9-19.5 41.5L313.7 442l13.2 19.8 9.8-10.2 29.6 8.3-9.8-22.8 32.2-1L336 415l9.6-9.7c14-14 39.4-53.9 47.3-101.6-3-12-18.4-21.5-28.9-26.4zm-128.5 47.4 20.5 81.9 20.5-81.9z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 와이번아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"></path><g class="" transform="translate(0,0)" style=""><path d="M324.97 17.54c.03.034.057.07.087.106l-34.924 32.428 36.904-3.752-15.396 30.12 38.048-16.075c26.147 69.965.623 154.277-52.555 166.262-6.554-25.37-34.13-37.945-36.055-57.382.303.093.604.187.912.27a27.113 27.113 0 0 0 14.274-.07l25.138 22.89 20.653-16.377c-7.363 2.836-28.588-1.402-33.25-13.923a27.114 27.114 0 0 0 6.793-11.922c.485-1.813.757-3.635.86-5.445l11.524 22.777 5.22-16.94c7.625 5.575 12.474 13.605 11.49 21.136l16.673-29.4-72.14-29.56-58.057-48.03 17.1 31.25-48.206-19.753 35.14 31.237c-40.602 28.158-22.085 85.04-1.796 119.29-57.5-9.685-103.128-77.435-95.763-145.03l49.21-21.366-31.08-5.14 29.207-33.417-32.015 11.54c.037-.067.07-.135.107-.202-168.36 66.33-116.413 367-63.728 417.99-.19-1.317-.364-2.58-.54-3.855-14.922-56.244-20.375-125.624-17.5-190.53 3.02-68.237 14.834-131.16 36.794-169.522l16.22 9.283c-18.894 33.008-31.4 94.563-34.345 161.064-1.942 43.86.106 90.022 6.275 132.082 6.124 1.892 15.046 9.615 27.295 23.24-4.818-13.35-6.78-26.5-6.482-38.28 20.286 41.665 67.34 69.234 104.633 62.308 22.444-4.17 41.803-12.73 57.81-24.475l7.31 15.418c-20.068 5.036-22.807 32.635-14.737 55.112 1.748-19.882 11.36-29.794 21.73-32.303-6.598 15.867-4.698 30.623-3.117 44.158 10.15-12.147 21.47-23.793 23.628-39.354 8.738 7.332 12.317 21.49 1.194 39.057 26.32-15.473 31.565-41.994 7.978-57.685l-32.07-34.297c5.918-5.55 11.24-11.6 15.947-18.066l39.28 15.776c-3.942 13.69 5.833 31.512 19.77 43.31-8.055-17.288-4.826-30.08 2.562-37.103 1.63 17.39 10.64 29.193 18.733 40.064 2.73-15.665 6.79-31.493-.213-45.987 11.016 1.56 21.2 11.568 20.338 31.877 14.362-25.313 6.11-49.702-20.742-51.52l-71.135-9.892c12.757-22.982 18.676-49.823 17.015-77.475 14.188-34.708 50.058-11.816 54.523 49.16C394.924 262.27 434.58 304 426.324 367.13c11.808-23.38 21.835-35.013 29.862-36.247-10.772-91.925-40.458-191.57-77.637-250.748l15.823-9.942c50.328 80.106 85.112 220.65 84.88 331.547 42.403-115.912-2.347-356.61-154.282-384.2zm-29.458 476.913-.026.016-.015.05c.015-.02.027-.044.042-.067zm26.543-318.492h.01v-.007l-.01.008zm-53.348-41.716a9.127 9.127 0 0 1 2.652.313c4.774 1.28 7.467 5.945 6.187 10.72-1.28 4.776-5.943 7.47-10.72 6.19-4.775-1.28-7.468-5.943-6.188-10.72.96-3.584 3.823-5.993 7.21-6.435a8.66 8.66 0 0 1 .857-.068zM204.904 297.13c11.878-.2 22.637 6.756 26.172 22.487-.008 35.88-9.557 68.823-42.137 77.412-27.624 7.283-69.725-11.398-84.12-53.663 12.28-21.078 37.362-21.986 62.838 22.592-12.583-41.596 14.386-68.444 37.246-68.83z" fill="#fff" fill-opacity="1"></path></g></svg>'
        const 아이스골렘아이콘 = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 512px; width: 512px;"></path><g class="" transform="translate(0,0)" style=""><path d="M64.086 26.254c-6.237 39.87-10.003 32.572-38.703 36.922 26.282 3.712 39.417 8.81 38.193 37.176 2.659-19.972.836-30.862 36.156-36.666-15.822-6.064-33.712 4.317-35.646-37.432zm171.064.41L204.6 74.125l20.066 14.436 35.813-1.82 22.677-15.118-25.306-43.582-22.7-1.377zm58.313 26.863 34.135 58.787-3.514 4.756c-8.857 11.988-15.901 23.926-26.307 34.877l26.118 38.395-4.485-31.547 42.602-93.592-68.55-11.676zm-102.906 9.159-56.166 16.63 10.02 19.877-18.005 28.631 31.244-2.363 16.258 32.252 5.51 83.332 34.289 33 14.793-60.986 46.986 66.673 55.434-39.97-1.518-10.672-.629.428-44.134-64.881-7.352 74.902-80.46-78.674.273-.281a85.007 85.007 0 0 1-6.385-8.314c-10.292-15.21-16.606-32.339-23.592-43.815l-2.93-4.812 26.364-40.957zm182.916 20.789-27.828 61.136 31.628 21.692 31.745 93.63c-14.946-3.888-30.64 2.536-32.446-36.415-6.236 39.87-10.003 32.57-38.703 36.92 26.282 3.712 39.42 8.81 38.195 37.175 2.589-19.446.944-30.28 33.457-36.195l7.372 21.74 7.736-70.28 46.723 27.222-24.922-83.52-31.106 7.588-4.265-17.488 58.337-14.227c-7.958-4.17-10.582-5.507-21.425-11.27-10.758-5.716-21.643-11.558-30.147-16.253-4.252-2.348-7.9-4.404-10.703-6.053-.857-.505-1.495-.91-2.2-1.344l-31.448-14.058zm-81.262 3.744-23.477 15.65v10.342h-18v-7.953l-16.56.842.754 8.283L217 116.012l-1.049-11.547-21.107-15.184-9.56 14.854c7.03 12.719 12.763 26.851 20.34 38.049 8.34 12.328 17.659 20.674 34.343 21.978 21.412-5.759 33.462-13.368 42.847-22.656 8.386-8.3 15.088-18.692 23.342-30.272L292.211 87.22zm-171.633 4.687L72.611 106.41l-3.324 38.537 13.43 8.631c-48.664 60.418-1.867.866-47.516 60.793l75.274-56.168 9.484 15.299L63.822 208.3l-5.527 64.074 41.072-28.842 11.117 25.617 31.87-102.539 10.503-10.666-5.859-11.627-54.834 4.149 31.596-50.25-3.182-6.31zm123.963 30.412c1.995.03 3.956.157 5.863.368 13.566 1.499 24.743 5.851 31.79 13.085l-12.895 12.56c-1.294-1.33-11.018-6.666-20.871-7.755-9.853-1.089-19.496.729-26.295 8.057l-13.196-12.242c8.706-9.383 20.047-13.244 30.897-13.955a58.083 58.083 0 0 1 4.707-.118zm21.063 51.987c-6.368 2.817-13.521 5.33-21.64 7.478l19.075 18.65 2.565-26.128zM439.49 242.37l-8.05 73.15c.82-.779 1.713-1.807 2.726-3.195 4.278-5.86 9.527-17.238 18.947-30.896l3.041-4.409 5.325.569c7.072.756 12.796 2.553 17.478 4.494l-10-22.545-29.467-17.168zm-201.03 16.067-2.494.204-12.156 50.109-24.1-23.193 26.346 42.152 41.062-19.115 15.66 27.707 44.032-9.846 6.101-37.865-3.775-25.35-57.881 41.737-32.795-46.54zm-146.662 12.87-.93.19-41.486 29.132-5.75 22.115 38.984-22.586 25.756 23.113.512-12.597-17.086-39.367zm82.078 6.879-45.77 107.558 9.182 41.313 17.697-53.094 16.582 47.125 10.842-13.99 7.696-19.975c38.884 7.55 31.602 11.181 34.92 39.856 4.635-26.136 10.192-39.084 38.497-36.862-19.866-3.36-30.814-1.923-35.37-37.426-6.58 15.513 2.999 33.633-37.993 34.29l19.72-51.19-36.003-57.605zm176.457 15.433-7.691 47.74-39.034 8.729 32.791 19.484 5.99 49.994 22.903-34.087 29.022 44.11 7.892-66.1-51.873-69.87zm99.283 12.774c-6.236 39.87-10.003 32.57-38.703 36.92 26.282 3.712 39.417 8.81 38.193 37.175 2.659-19.972.838-30.861 36.159-36.666-15.823-6.063-33.714 4.32-35.649-37.43zm-84.48 111.597-24.555 36.547-2.822 33.858 127.039 1.876 19.959-44.076-35.29 19.82-11.573-21.216-14.118 12.605-14.498-1.318-2.931 24.545-41.211-62.64zm-173.678 6.819-25.904 33.421-10.108-28.724-20.05 60.15h57.01c-2.998-20.407-2.653-42.363-.948-64.847zm-111.969 4.84-12.275 60.007h65.545l-7.776-34.988-23.048 10.477-22.446-35.497z" fill="#fff" fill-opacity="1"></path></g></svg>'

        //던전아이콘
        const 던전아이콘 = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 256px; width: 256px;"></path><g class="" transform="translate(0,0)" style=""><path d="m193.571 26.027 35.192 83.99c14.877 7.658 33.121 6.696 47.488-1.279l40.283-85.976c-45.582-7.268-84.512-4.945-122.963 3.265zm137.3 7.606-32.038 71.38c12.536 12.349 37.237 18.872 47.033 15.448l31.172-64.691c-12.422-8.392-27.428-15.886-46.168-22.137zm-154.86-1.97c-21.814 6.55-40.982 16.35-56.099 28.591 14.941 15.844 28.861 34.184 38.194 52.832 24.477 6.133 35.479-6.849 47.475-18.55zm-74.245 34.831c-36.541 32.91-66.523 76.42-78.068 125.215l65.957 3.353c12.006-30.53 24.552-56.284 54.231-72.755-9.883-20.24-23.626-39.403-42.12-55.813zm292.503-.29-31.852 61.044c32.54 21.007 43.572 41.348 52.597 69l72.464-8.43c-9.612-55.894-42.206-107.047-93.209-121.614zm-52.233 137.2c4.757 12.937-15.842 29.7-9.07 39.428-4.011.85-8.874 1.642-14.385-8.957-1.126 12.49 2.172 19.603 12.168 29.209-2.682.783-8.045 2.75-12.08.566-1.24 7.386 10.867 13.863 20.725 14.832l8.392-2.175c-6.09-1.106-7.881-3.315-10.627-6.13 2.97-1.32 12.554-7.117 2.149-14.751 12.634-2.752 6.035-14.89 4.14-21.862 7.525 7.798 15.243 22.54 21.862 7.084 4.176 12.604 6.561 12.12 13.614 9.107 1.054 9.196-2.957 14.791-8.792 22.518l12.494-4.992c6.018-5.026 20.16-25.502 6.428-35.5 2.603 12.443-5.563 14.388-18.672-10.937-4.377 30.773-12.236-7.49-28.346-17.44zm-321.668 2.108v66.242l72.842-11.858 1.592-49.873zm143.486.363c3.732 8.72-14.487 45.226-18.865 14.453-13.109 25.325-23.908 24.26-21.304 11.817-13.732 9.998-1.347 33.458 4.671 38.484l11.229 3.001c-5.835-7.727-11.565-13.614-10.512-22.81 7.053 3.013 10.492 5.604 14.668-7 6.618 15.456 17.32-4.378 24.846-12.175-1.554 11.494-6.282 22.427 7.303 25.197-9.13 10.082 1.899 19.99-12.694 22.812l8.393 2.176c9.857-.97 20.385-10.606 19.144-17.992-4.035 2.183-7.818 3.376-10.5 2.594 9.996-9.607 10.662-21.46 9.536-33.95-5.511 10.6-7.917 11.738-11.752 13.698 6.77-9.728-5.927-32.285-14.163-40.305zm327.512 1.172-77.57 5.687 1.156 79.192 75.524 2.842zM98.313 279.81l-79.955 9.779 1.202 99.754 83.54 1.152zm280.659 7.347-28.332 7.031 21.455 68.315 16.125-5.043zm-246.961 3.348-9.248 70.303 16.125 5.043 21.455-68.315zM412.269 310.3v83.58l79.166-8.031 2.289-75.55zm84.605 91.656-88.934 9.947-1.16 80.727 90.674.586zm-395.822 2.002-81.848 2.322-4.658 86.184h90z" fill="#fff" fill-opacity="1"></path></g></svg>`

        const 보스아이콘목록 = [
            미노타우르스아이콘,
            락골렘아이콘,
            가고일아이콘,
            그루트아이콘,
            와이번아이콘,
            아이스골렘아이콘
        ];

        const 아이콘맵 = {
            크리티컬아이콘,
            드레인아이콘,
            버서커아이콘,
            아이언바디아이콘,
            인사이트아이콘,
            퀵니스아이콘,
            발굴아이콘,
            머니아이콘,
            성공아이콘,
            실패아이콘,
            마스터아이콘,
            버닝아이콘,
            뽑기아이콘,
            인텔리전스아이콘,
            브로큰아이콘,
            즉사아이콘,
            소드아이콘,
            하트플러스아이콘,
            고스트아이콘,
            쉴드밴아이콘,
            하트마이너스아이콘,
            엑스아이콘,
            암포라아이콘,
            모루아이콘,
            클로버아이콘,
            플라워아이콘,
            티켓아이콘,
            모래시계아이콘,
            퍼즐아이콘,
            로켓아이콘,
            표창아이콘,
            봄아이콘,
            여름아이콘,
            가을아이콘,
            겨울아이콘,
            서클체크아이콘,
            그루트아이콘,
            락골렘아이콘,
            미노타우르스아이콘,
            가고일아이콘,
            와이번아이콘,
            아이스골렘아이콘,
            샐러드아이콘,
            햄버거아이콘,
            마법의팔레트아이콘,
            뼈다구아이콘,
            해머아이콘,
        };

        function 화면잠금() {
            document.body.style.pointerEvents = "none";
            document.body.style.opacity = "0.5";
            const 버튼들 = document.querySelectorAll("button");
            버튼들.forEach(btn => btn.disabled = true);
        }

        function 화면해제() {
            document.body.style.pointerEvents = "auto";
            document.body.style.opacity = "1";
            const 버튼들 = document.querySelectorAll("button");
            버튼들.forEach(btn => btn.disabled = false);
        }

        function 공격버튼잠금() {
            const 공격버튼 = document.getElementById("공격버튼");
            const 레어몬스터 = document.getElementById("레어몬스터");
            const 보스몬스터 = document.getElementById("보스몬스터");

            if (공격버튼) {
                공격버튼.style.pointerEvents = "none";
                공격버튼.style.opacity = "0.5";
            }

            if (레어몬스터) {
                레어몬스터.style.pointerEvents = "none";
                레어몬스터.style.opacity = "0.5";
            }

            if (보스몬스터) {
                보스몬스터.style.pointerEvents = "none";
                보스몬스터.style.opacity = "0.5";
            }
        }

        function 공격버튼잠금해제() {
            const 공격버튼 = document.getElementById("공격버튼");
            const 레어몬스터 = document.getElementById("레어몬스터");
            const 보스몬스터 = document.getElementById("보스몬스터");

            if (공격버튼) {
                공격버튼.style.pointerEvents = "auto";
                공격버튼.style.opacity = "1";
            }

            if (레어몬스터) {
                레어몬스터.style.pointerEvents = "auto";
                레어몬스터.style.opacity = "1";
            }

            if (보스몬스터) {
                보스몬스터.style.pointerEvents = "auto";
                보스몬스터.style.opacity = "1";
            }
        }

        function 메시지표시(대상, 아이콘HTML, 텍스트, 글자색) {
            const rect = 대상.getBoundingClientRect();

            const el = document.createElement("div");
            el.innerHTML = `
        ${아이콘HTML}<span>${텍스트}</span>
    `;
            el.style.position = "absolute";
            el.style.left = `${rect.left + Math.random() * rect.width}px`;
            el.style.top = `${rect.top + Math.random() * rect.height}px`;
            el.style.color = 글자색;
            el.style.padding = "8px 12px";
            el.style.borderRadius = "8px";
            el.style.fontWeight = "bold";
            el.style.zIndex = 9999;
            el.style.pointerEvents = "none";
            el.style.animation = "fadeOut 3s ease-out forwards";
            el.style.whiteSpace = "nowrap";

            document.body.appendChild(el);
            setTimeout(() => el.remove(), 3000);
        }

        async function 회원가입() {
            화면잠금();

            const 아이디 = document.getElementById("이메일입력").value.trim();
            const 비번 = document.getElementById("비번입력").value.trim();
            const 이메일형식 = `${아이디}@gagl.com`;
            const 유저아이디 = 아이디;
            const 기기ID = localStorage.getItem("기기ID") || crypto.randomUUID();

            localStorage.setItem("기기ID", 기기ID);

            const 아이디패턴 = /^[a-zA-Z0-9_]{3,12}$/;
            if (!아이디패턴.test(아이디)) {
                메시지표시(메시지표시박스, "", "아이디는 영문/숫자/밑줄 포함 3~12자여야 합니다", "");
                화면해제();
                return;
            }

            try {
                const { data, error } = await supabase.auth.signUp({
                    email: 이메일형식,
                    password: 비번
                });

                if (error || !data.user) {
                    메시지표시(메시지표시박스, "", "회원가입 실패: " + error.message, "");
                    화면해제();
                    return;
                }

                await supabase.auth.signOut();
                await supabase.auth.signInWithPassword({ email: 이메일형식, password: 비번 });

                const { data: { user }, error: 로그인오류 } = await supabase.auth.getUser();
                if (로그인오류 || !user) {
                    메시지표시(메시지표시박스, "", "재로그인 실패", "");
                    화면해제();
                    return;
                }

                const 유저UID = user.id;

                const 응답 = await fetch("/register-user", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID, 유저아이디, 기기ID, 로그인이메일: 이메일형식 })
                });

                const 결과 = await 응답.json();

                if (!응답.ok) {
                    메시지표시(메시지표시박스, "", 결과.오류 || "서버 오류", "");
                    화면해제();
                    return;
                }

                메시지표시(메시지표시박스, "✅", "회원가입 성공! 자동 로그인 완료", "#00c851");
                유저데이터 = 결과.유저데이터;

                if (document.readyState === "complete" || document.readyState === "interactive") {
                    전투화면보여주기(유저데이터);
                    document.getElementById("메뉴얼").click();
                } else {
                    document.addEventListener("DOMContentLoaded", () => {
                        전투화면보여주기(유저데이터);
                        document.getElementById("메뉴얼").click();
                    });
                }

            } catch (e) {
                메시지표시(메시지표시박스, "", "예외 오류 발생: " + e.message, "");
            }

            화면해제();
        }

        async function 로그인() {
            화면잠금();

            const 아이디 = document.getElementById("이메일입력").value.trim();
            const 비번 = document.getElementById("비번입력").value.trim();
            const 이메일형식 = `${아이디}@gagl.com`;

            if (!아이디 || !비번) {
                메시지표시(메시지표시박스, "", "아이디와 비밀번호를 입력하세요", "");
                화면해제();
                return;
            }

            try {
                const { error: 로그인오류 } = await supabase.auth.signInWithPassword({
                    email: 이메일형식,
                    password: 비번
                });

                if (로그인오류) {
                    메시지표시(메시지표시박스, "", "로그인 실패: " + 로그인오류.message, "");
                    화면해제();
                    return;
                }

                const { data: { user } } = await supabase.auth.getUser();
                if (!user || !user.id) {
                    메시지표시(메시지표시박스, "", "유저 인증 정보 없음", "");
                    화면해제();
                    return;
                }

                const 응답 = await fetch("/get-user", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: user.id })
                });

                const 결과 = await 응답.json();
                const 유저정보 = 결과.유저데이터;

                if (!유저정보) {
                    메시지표시(메시지표시박스, "", "유저 정보가 존재하지 않습니다", "");
                    화면해제();
                    return;
                }

                유저데이터 = {
                    ...유저정보,
                    스킬: 유저정보.스킬 || {},
                    장비목록: 유저정보.장비목록 || [],
                };

                메시지표시(메시지표시박스, "✅", "로그인 성공!", "#00c851");
                전투화면보여주기(유저데이터);
                document.getElementById("메뉴얼").click();
            } catch (e) {
                메시지표시(메시지표시박스, "", "오류 발생: " + e.message, "");
            } finally {
                화면해제();
            }
        }

        async function 회원탈퇴() {
            const 확인 = confirm("돌이킬 수 없는 실수를 하시겠습니까?");
            if (!확인) return;

            화면잠금();

            try {
                const {
                    data: { user }
                } = await supabase.auth.getUser();

                if (!user) {
                    메시지표시(메시지표시박스, "", "로그인 정보 없음", "");
                    return;
                }

                const 응답 = await fetch("/delete-user", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: user.id })
                });

                if (!응답.ok) {
                    console.warn("auth 삭제 실패", await 응답.text());
                }

                메시지표시(메시지표시박스, "✅", "탈퇴가 완료되었습니다.", "");

                await supabase.auth.signOut(); // 세션 삭제
                localStorage.removeItem("기기ID"); // UUID 삭제
                location.reload(); // 로그인 화면으로 새로고침

            } catch (e) {
                메시지표시(메시지표시박스, "", "탈퇴 중 오류 발생: " + e.message, "");
            } finally {
                화면해제();
            }
        }


        document.getElementById("전투").addEventListener("click", () => {
            if (!유저데이터) return;
            전투화면보여주기(유저데이터);
        });

        async function 전투화면보여주기(유저) {
            화면잠금();
            모든화면숨기기();
            document.getElementById("전투화면").style.display = "block";
            document.getElementById("에너지박스").style.display = "block";

            document.getElementById("화면설명").innerHTML = "경험치 클릭 전직 / 골드 클릭 뽑기 / 숙련도 클릭 스킬";

            const 최대 = 유저.최대스태미너 ?? 100;
            const 현재 = 유저.현재스태미너 ?? 0;

            const 스태미너표시 = document.getElementById("스태미너표시");
            if (스태미너표시) 스태미너표시.innerText = `${현재}/${최대}`;

            const 에너지바 = document.querySelector(".에너지바");
            if (에너지바) 에너지바.style.width = `${(현재 / 최대) * 100}%`;

            document.getElementById("등급외테두리").style.border = "0.2px solid #4b4b4b";

            let 닉네임표시 = 유저.유저아이디;

            const 팔레트 = 유저.마법의팔레트;
            if (팔레트 === "민초") {
                닉네임표시 = `<span class="마법의팔레트민초">${닉네임표시}</span>`;
            } else if (팔레트 === "지옥") {
                닉네임표시 = `<span class="마법의팔레트지옥">${닉네임표시}</span>`;
            } else if (팔레트 === "블라섬") {
                닉네임표시 = `<span class="마법의팔레트블라섬">${닉네임표시}</span>`;
            } else if (팔레트 === "가글") {
                닉네임표시 = `<span class="마법의팔레트가글">${닉네임표시}</span>`;
            } else if (팔레트 === "겨울") {
                닉네임표시 = `<span class="마법의팔레트겨울">${닉네임표시}</span>`;
            } else if (팔레트 === "네온사인") {
                닉네임표시 = `<span class="마법의팔레트네온사인">${닉네임표시}</span>`;
            } else if (팔레트 === "핑크오션") {
                닉네임표시 = `<span class="마법의팔레트핑크오션">${닉네임표시}</span>`;
            } else if (팔레트 === "황혼하늘") {
                닉네임표시 = `<span class="마법의팔레트황혼하늘">${닉네임표시}</span>`;
            } else if (팔레트 === "에메랄드숲") {
                닉네임표시 = `<span class="마법의팔레트에메랄드숲">${닉네임표시}</span>`;
            }

            document.getElementById("타이틀을아이디로").innerHTML = `${닉네임표시}`;
            document.getElementById("전투스킬설정버튼").style.display = "block";

            const 직위 = 최고전직명(유저.전직정보);

            const 검술 = ["나이트", "글라디에이터", "엠퍼러", "로열가드", "그랑스워드", "카이저"];
            const 마술 = ["매지션", "워록", "아크메이지", "소서러", "그랑에이지", "자베러"];
            const 신술 = ["클레릭", "프리스트", "비숍", "프린세스", "그랑세이지", "퀸"];
            const 궁술 = ["스나이퍼", "레인저", "헌터", "하이랜더", "그랑아처", "제너럴"];


            const 결정객체 = 유저.직업결정;

            if (결정객체) {
                const 계열키 = Object.keys(결정객체)[0];
                const 단계 = 결정객체[계열키];

                let 직업이름;
                if (계열키 === "검술") {
                    직업이름 = 검술[단계 - 1];
                } else if (계열키 === "마술") {
                    직업이름 = 마술[단계 - 1];
                } else if (계열키 === "신술") {
                    직업이름 = 신술[단계 - 1];
                } else if (계열키 === "궁술") {
                    직업이름 = 궁술[단계 - 1];
                } else {
                    직업이름 = "-";
                }

                document.getElementById("유저아이디").innerHTML = (직업이름 ? `[${직업이름}] ` : "") + (`${닉네임표시}` || "알 수 없음");

            } else {
                document.getElementById("유저아이디").innerHTML = (`${닉네임표시}` || "알 수 없음");

            }

            document.getElementById("유저공격력").innerText = `공격력 ${유저.최종공격력 || 10}`;
            document.getElementById("유저체력").innerText = `체력 ${유저.남은체력}/${유저.최대체력}`;

            document.getElementById("몬스터테두리안표시").style.display = "none";
            document.getElementById("레벨").innerText = `레벨 ${유저.레벨 || 1}`;
            document.getElementById("총경험치").innerText = 유저.경험치?.toLocaleString() || "0";
            document.getElementById("총골드").innerText = (유저.골드 || 0).toLocaleString();
            document.getElementById("총숙련도").innerText = (유저.숙련도 || 0).toLocaleString();

            document.getElementById("획득경험치").innerText = "0";
            document.getElementById("획득골드").innerText = "0";
            document.getElementById("획득숙련도").innerText = "0";
            document.getElementById("승리패배로그").innerText = "";
            document.querySelectorAll(".전투로그컨테이너").forEach(e => e.remove());

            if (!유저.현재층) 유저.현재층 = 1;

            document.getElementById("현재층").innerText = `${유저.현재층}층`;
            화면해제();
        }

        function 최고전직명(전직정보) {
            const 전직순서 = ["백인장", "오백인장", "천인장", "만인장", "부장군", "장군", "대장군", "대사마", "승상", "후", "공", "제후", "왕", "황제", "천황", "제황", "태황", "천제"];

            let 마지막직위 = null;
            for (const 직위 of 전직순서) {
                if (전직정보?.[직위] === 1) {
                    마지막직위 = 직위;
                } else {
                    break;
                }
            }
            return 마지막직위;
        }


        let 반자동실행 = false;
        let 풀자동실행 = false;


        const 반자동Btn = document.getElementById("반자동");
        const 풀자동Btn = document.getElementById("풀자동");
        const 공격Btn = document.getElementById("공격버튼");
        const 레어Btn = document.getElementById("레어몬스터");


        반자동Btn.addEventListener("click", (e) => {
            if (풀자동실행) return;

            e.stopPropagation();     // 외부 클릭 리스너로 전파 방지
            반자동실행 = !반자동실행;
            if (반자동실행) {
                document.getElementById("공격버튼").click();
            }
        });

        풀자동Btn.addEventListener("click", (e) => {
            if (반자동실행) return;
            e.stopPropagation();
            풀자동실행 = !풀자동실행;
            반자동실행 = false;

            if (풀자동실행) {
                if (레어Btn.style.display !== "none") 레어Btn.click();
                else 공격Btn.click();
            }
        });


        document.getElementById("공격버튼").addEventListener("click", async () => {
            if (!유저데이터) return;


            공격버튼잠금();
            let 레어몬스터등장 = false;

            try {
                const 응답 = await fetch("/attack-normal", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저데이터 })
                });

                const 결과 = await 응답.json();
                const 등급외테두리 = document.getElementById("등급외테두리");

                // ✅ 스태미너 부족 시 처리
                if (결과.결과 === "불가") {
                    메시지표시(등급외테두리, "", 결과.메시지 || "스태미너 부족", "");
                    반자동실행 = false;
                    풀자동실행 = false;
                    화면해제();
                    return;
                }

                if (결과.스킬발동) {
                    if (결과.스킬발동.인사이트) {
                        메시지표시(숙련도테두리안표시, 인사이트아이콘, "", "#3b82f6");
                    }
                    if (결과.스킬발동.인텔리전스) {
                        메시지표시(경험치테두리안표시, 인텔리전스아이콘, "", "#00c851");
                    }
                    if (결과.스킬발동.발굴) {
                        메시지표시(골드테두리안표시, 발굴아이콘, "", "#f5c400");
                    }
                }


                // 기존 전투 로그 삭제
                const 기존로그들 = document.querySelectorAll(".전투로그컨테이너");
                기존로그들.forEach(e => e.remove());

                // 새로운 로그 생성
                if (결과.전투로그 && Array.isArray(결과.전투로그)) {
                    결과.전투로그.slice().reverse().forEach(로그 => {
                        const 로그컨테이너 = document.createElement("div");
                        로그컨테이너.className = "전투로그컨테이너";
                        로그컨테이너.style.marginTop = "15px";
                        로그컨테이너.style.border = "0.2px solid #4b4b4b";
                        로그컨테이너.style.borderRadius = "10px";
                        로그컨테이너.style.padding = "15px";

                        const 아이콘HTML = (로그.아이콘 || []).map(이름 => 아이콘맵[이름] || "").join(" ");

                        // 회복 로그는 데미지 표시 안 함
                        let 데미지텍스트 = "";
                        let 회복텍스트 = "";

                        if (로그.타입 === "공격") {
                            데미지텍스트 = `<span><span style="color: #f63b3b;">${로그.몬스터이름}</span>에게 ${로그.효과} 피해를 입혔다!</span>`;
                        } else if (로그.타입 === "회복") {
                            회복텍스트 = `<span><span style="color: #3b82f6;">${로그.유저아이디}</span> 체력 ${로그.효과} 회복</span>`;
                        }

                        let 추가횟수표시 = "";
                        if (로그.타입 === "공격" && 로그.추가공격횟수 > 0) {
                            // 실제 타격 횟수 = 1(기본) + 로그.추가공격횟수
                            const 총공격횟수 = 1 + 로그.추가공격횟수;
                            추가횟수표시 = `<span style="margin-left: 4px; color: #f63b3b;">x${총공격횟수}</span>`;
                        }

                        // (2) innerHTML에서 공격 텍스트 뒤에 추가횟수표시 붙이기
                        로그컨테이너.innerHTML = `
    <div style="background: #4b4b4b; width: calc(100% + 30px); margin: -15px 0 0 -15px; padding: 6px 0; text-align: center; border-top-left-radius: 10px; border-top-right-radius: 10px;">
        <strong>Turn ${로그.턴}</strong>
    </div>
    <div class="가로정렬" style="margin: 4px 0; align-items: center; gap: 6px;">
        ${아이콘HTML}
        ${로그.타입 === "공격" ? 데미지텍스트 + 추가횟수표시 : ""}
        ${로그.타입 === "회복" ? 회복텍스트 : ""}
    </div>
<!-- 유저와 몬스터 정보 양쪽 정렬 -->
<div class="가로정렬" style="margin-top: 10px; justify-content: space-between; align-items: center; gap: 12px;">
    <div style="border: 0.2px solid #3b82f6; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.유저아이디}</div>
        <div>
            <div>공격력 ${로그.유저최종공격력}</div>
            <div>체력 ${로그.유저체력}/${로그.유저최대체력}</div>
        </div>
    </div>

    <div style="border: 0.2px solid #f63b3b; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.몬스터이름}</div>
        <div>
            <div>체력 ${Math.max(0, 로그.몬스터체력)}/${로그.몬스터최대체력}</div>
            <div>방어력 ${로그.몬스터방어력}</div>
        </div>
    </div>
</div>
        `;

                        const 타겟 = document.getElementById("몬스터테두리안표시");
                        if (타겟 && 타겟.parentNode) {
                            타겟.parentNode.insertBefore(로그컨테이너, 타겟.nextSibling);
                        }
                    });
                }

                if (결과.결과 === "패배") {
                    const 몬스터 = 결과.몬스터;
                    유저데이터 = 결과.유저데이터;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("획득경험치").innerText = "0";
                    document.getElementById("획득골드").innerText = "0";
                    document.getElementById("획득숙련도").innerText = "0";
                    document.getElementById("레벨업표시").innerText = "";
                    document.getElementById("획득로그").innerText = "";
                    document.getElementById("추가획득로그").innerText = "";

                    document.getElementById("유저체력").innerText = `체력 ${유저데이터.남은체력}/${유저데이터.최대체력}`;
                    document.getElementById("승리패배로그").innerText = "패배";
                    document.getElementById("승리패배로그").style.color = "#ef4444";
                } else {
                    const { 유저데이터: 새유저, 몬스터, 보상, 레벨업, 회복 } = 결과;
                    유저데이터 = 새유저;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    // document.getElementById("등급외테두리").style.border = `0.2px solid ${색상맵[몬스터.타입] || "#4b4b4b"}`;
                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("총경험치").innerText = 새유저.경험치.toLocaleString();
                    document.getElementById("총골드").innerText = 새유저.골드.toLocaleString();
                    document.getElementById("총숙련도").innerText = 새유저.숙련도.toLocaleString();
                    document.getElementById("획득경험치").innerText = `+${보상.경험치}`;
                    document.getElementById("획득골드").innerText = `+${보상.골드}`;
                    document.getElementById("획득숙련도").innerText = `+${보상.숙련도}`;
                    document.getElementById("레벨").innerText = `레벨 ${새유저.레벨}`;
                    document.getElementById("유저공격력").innerText = `공격력 ${새유저.최종공격력}`;
                    document.getElementById("유저체력").innerText = `체력 ${새유저.남은체력}/${새유저.최대체력}`;
                    document.getElementById("획득로그").innerText =
                        `${보상.경험치} EXP, ${보상.골드} Gold, ${보상.숙련도} 숙련도 획득`;
                    document.getElementById("추가획득로그").innerText = "";

                    if (레벨업.증가한레벨 > 0) {
                        document.getElementById("레벨업표시").innerText = `레벨 ${새유저.레벨} 달성!`;
                        document.getElementById("레벨업표시").style.color = "#3f84ec";
                    } else document.getElementById("레벨업표시").innerText = "";

                    if (결과.드랍유물) {
                        const 유물드랍박스 = document.getElementById("유물드랍박스");
                        const 유저테두리안표시 = document.getElementById("유저테두리안표시");

                        if (유물드랍박스) {
                            // ✅ 먼저 기존에 떠 있는 박스를 숨김
                            유물드랍박스.style.display = "none";

                            // ✅ setTimeout 제거 방지: 이전 타이머 클리어 (선택 사항)
                            if (window.유물드랍타이머) clearTimeout(window.유물드랍타이머);

                            유물드랍박스.innerText = `유물 [${결과.드랍유물}]을(를) 획득했다!`;
                            유물드랍박스.style.display = "block";

                            // 위치 조정용 부모 변경
                            if (유저테두리안표시) {
                                // 등급외테두리에 위치 기준 설정
                                유저테두리안표시.style.position = "relative";

                                // 유물드랍박스를 등급외테두리 내부로 이동
                                유저테두리안표시.appendChild(유물드랍박스);

                                // 전투화면용 위치 조정
                                Object.assign(유물드랍박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100"
                                });
                            }
                        }
                        // ✅ 새 타이머로 숨김 처리 (전역 변수로 저장)
                        window.유물드랍타이머 = setTimeout(() => {
                            유물드랍박스.style.display = "none";
                        }, 3000);
                    }

                    document.getElementById("승리패배로그").innerText = "승리";
                    document.getElementById("승리패배로그").style.color = "#00c851";
                }

                const 레어몬스터 = document.getElementById("레어몬스터");

                if (결과.레어몬스터이름) {
                    document.getElementById("등급외테두리").style.border = "0.2px solid #c653ff";
                    레어몬스터.innerText = 결과.레어몬스터이름;
                    레어몬스터.style.display = "inline-block";
                    레어몬스터등장 = true;
                } else {
                    레어몬스터.style.display = "none";
                    document.getElementById("등급외테두리").style.border = "0.2px solid #4b4b4b";
                }


                // ✅ 유저데이터 변경 이후, 승리/패배 관계 없이 실행
                const 스태미너표시 = document.getElementById("스태미너표시");
                const 에너지바 = document.querySelector(".에너지바");
                if (스태미너표시 && 에너지바) {
                    const 최대 = 유저데이터.최대스태미너 ?? 100;
                    const 현재 = 유저데이터.현재스태미너 ?? 0;
                    스태미너표시.innerText = `${현재}/${최대}`;
                    에너지바.style.width = `${(현재 / 최대) * 100}%`;
                }
                if (결과.모래시계발동) {
                    메시지표시(에너지바, 모래시계아이콘, "", "");
                }
            } catch (e) {
                메시지표시(메시지표시박스, "", "전투 중 오류: " + e.message, "");
            } finally {
                if (레어몬스터등장) {
                    반자동실행 = !반자동실행;
                    await new Promise(resolve => setTimeout(resolve, 1500)); // ✅ 1.5초 대기
                } else {
                    await new Promise(resolve => setTimeout(resolve, 500));


                }

                공격버튼잠금해제();
                if (풀자동실행) {
                    if (레어Btn.style.display !== "none") {
                        레어Btn.click();
                    } else {
                        공격Btn.click();
                    }
                    return;
                }

                if (반자동실행) {
                    공격Btn.click();
                }
            }

        });



        document.getElementById("레어몬스터").addEventListener("click", async () => {
            if (!유저데이터) return;

            const 이름 = document.getElementById("레어몬스터").innerText;
            공격버튼잠금();
            let 레어몬스터등장 = false;

            try {
                const 응답 = await fetch("/attack-rare", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저데이터, 레어몬스터이름: 이름 })
                });

                const 결과 = await 응답.json();
                const 등급외테두리 = document.getElementById("등급외테두리");

                // ✅ 스태미너 부족 시 처리
                if (결과.결과 === "불가") {
                    메시지표시(등급외테두리, "", 결과.메시지 || "스태미너 부족", "");
                    반자동실행 = false;
                    풀자동실행 = false;

                    화면해제();
                    return;
                }

                if (결과.스킬발동) {
                    if (결과.스킬발동.인사이트) {
                        메시지표시(숙련도테두리안표시, 인사이트아이콘, "", "#3b82f6");
                    }
                    if (결과.스킬발동.인텔리전스) {
                        메시지표시(경험치테두리안표시, 인텔리전스아이콘, "", "#00c851");
                    }
                    if (결과.스킬발동.발굴) {
                        메시지표시(골드테두리안표시, 발굴아이콘, "", "#f5c400");
                    }
                }

                // 기존 전투 로그 삭제
                const 기존로그들 = document.querySelectorAll(".전투로그컨테이너");
                기존로그들.forEach(e => e.remove());

                // 새로운 로그 생성
                if (결과.전투로그 && Array.isArray(결과.전투로그)) {
                    결과.전투로그.slice().reverse().forEach(로그 => {
                        const 로그컨테이너 = document.createElement("div");
                        로그컨테이너.className = "전투로그컨테이너";
                        로그컨테이너.style.marginTop = "15px";
                        로그컨테이너.style.border = "0.2px solid #4b4b4b";
                        로그컨테이너.style.borderRadius = "10px";
                        로그컨테이너.style.padding = "15px";

                        const 아이콘HTML = (로그.아이콘 || []).map(이름 => 아이콘맵[이름] || "").join(" ");

                        // 회복 로그는 데미지 표시 안 함
                        let 데미지텍스트 = "";
                        let 회복텍스트 = "";

                        if (로그.타입 === "공격") {
                            데미지텍스트 = `<span><span style="color: #f63b3b;">${로그.몬스터이름}</span>에게 ${로그.효과} 피해를 입혔다!</span>`;
                        } else if (로그.타입 === "회복") {
                            회복텍스트 = `<span><span style="color: #3b82f6;">${로그.유저아이디}</span> 체력 ${로그.효과} 회복</span>`;
                        }

                        let 추가횟수표시 = "";
                        if (로그.타입 === "공격" && 로그.추가공격횟수 > 0) {
                            // 실제 타격 횟수 = 1(기본) + 로그.추가공격횟수
                            const 총공격횟수 = 1 + 로그.추가공격횟수;
                            추가횟수표시 = `<span style="margin-left: 4px; color: #f63b3b;">x${총공격횟수}</span>`;
                        }

                        // (2) innerHTML에서 공격 텍스트 뒤에 추가횟수표시 붙이기
                        로그컨테이너.innerHTML = `
    <div style="background: #4b4b4b; width: calc(100% + 30px); margin: -15px 0 0 -15px; padding: 6px 0; text-align: center; border-top-left-radius: 10px; border-top-right-radius: 10px;">
        <strong>Turn ${로그.턴}</strong>
    </div>
    <div class="가로정렬" style="margin: 4px 0; align-items: center; gap: 6px;">
        ${아이콘HTML}
        ${로그.타입 === "공격" ? 데미지텍스트 + 추가횟수표시 : ""}
        ${로그.타입 === "회복" ? 회복텍스트 : ""}
    </div>
<!-- 유저와 몬스터 정보 양쪽 정렬 -->
<div class="가로정렬" style="margin-top: 10px; justify-content: space-between; align-items: center; gap: 12px;">
    <div style="border: 0.2px solid #3b82f6; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.유저아이디}</div>
        <div>
            <div>공격력 ${로그.유저최종공격력}</div>
            <div>체력 ${로그.유저체력}/${로그.유저최대체력}</div>
        </div>
    </div>

    <div style="border: 0.2px solid #f63b3b; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        <div>${로그.몬스터이름}</div>
        <div>
            <div>체력 ${로그.몬스터체력}/${로그.몬스터최대체력}</div>
            <div>방어력 ${로그.몬스터방어력}</div>
        </div>
    </div>
</div>
        `;

                        const 타겟 = document.getElementById("몬스터테두리안표시");
                        if (타겟 && 타겟.parentNode) {
                            타겟.parentNode.insertBefore(로그컨테이너, 타겟.nextSibling);
                        }
                    });
                }


                if (결과.결과 === "패배") {
                    const 몬스터 = 결과.몬스터;
                    유저데이터 = 결과.유저데이터;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    // document.getElementById("등급외테두리").style.border = `0.2px solid ${색상맵[몬스터.타입] || "#4b4b4b"}`;
                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("획득경험치").innerText = "0";
                    document.getElementById("획득골드").innerText = "0";
                    document.getElementById("획득숙련도").innerText = "0";
                    document.getElementById("레벨업표시").innerText = "";
                    document.getElementById("획득로그").innerText = "";
                    document.getElementById("추가획득로그").innerText = "";

                    document.getElementById("유저체력").innerText = `체력 ${유저데이터.남은체력}/${유저데이터.최대체력}`;
                    document.getElementById("승리패배로그").innerText = "패배";
                    document.getElementById("승리패배로그").style.color = "#ef4444";
                } else {
                    const { 유저데이터: 새유저, 몬스터, 보상, 레벨업, 회복 } = 결과;
                    유저데이터 = 새유저;

                    document.getElementById("몬스터테두리안표시").style.display = "block";
                    document.getElementById("악마이름").innerText = 몬스터.이름;
                    document.getElementById("악마체력").innerText = `체력 ${몬스터.체력}`;
                    document.getElementById("악마방어력").innerText = `방어력 ${몬스터.방어력}`;

                    // document.getElementById("등급외테두리").style.border = `0.2px solid ${색상맵[몬스터.타입] || "#4b4b4b"}`;
                    document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;

                    document.getElementById("총경험치").innerText = 새유저.경험치.toLocaleString();
                    document.getElementById("총골드").innerText = 새유저.골드.toLocaleString();
                    document.getElementById("총숙련도").innerText = 새유저.숙련도.toLocaleString();
                    document.getElementById("획득경험치").innerText = `+${보상.경험치}`;
                    document.getElementById("획득골드").innerText = `+${보상.골드}`;
                    document.getElementById("획득숙련도").innerText = `+${보상.숙련도}`;
                    document.getElementById("레벨").innerText = `레벨 ${새유저.레벨}`;
                    document.getElementById("유저공격력").innerText = `공격력 ${새유저.최종공격력}`;
                    document.getElementById("유저체력").innerText = `체력 ${새유저.남은체력}/${새유저.최대체력}`;
                    document.getElementById("획득로그").innerText =
                        `${보상.경험치} EXP, ${보상.골드} Gold, ${보상.숙련도} 숙련도 획득`;
                    document.getElementById("추가획득로그").innerHTML =
                        (결과.추가골드 > 0 ? `<span style="color: ${document.getElementById("보유골드")?.style.color || "#ffd700"};">추가획득 +${결과.추가골드} Gold</span> ` : "") +
                        (결과.추가숙련도 > 0 ? `<span style="color: #3b82f6;">추가획득 +${결과.추가숙련도} 숙련도</span>` : "");

                    if (레벨업.증가한레벨 > 0) {
                        document.getElementById("레벨업표시").innerText = `레벨 ${새유저.레벨} 달성!`;
                        document.getElementById("레벨업표시").style.color = "#3f84ec";
                    } else document.getElementById("레벨업표시").innerText = "";

                    if (결과.드랍유물) {
                        const 유물드랍박스 = document.getElementById("유물드랍박스");
                        const 유저테두리안표시 = document.getElementById("유저테두리안표시");

                        if (유물드랍박스) {
                            // ✅ 먼저 기존에 떠 있는 박스를 숨김
                            유물드랍박스.style.display = "none";

                            // ✅ setTimeout 제거 방지: 이전 타이머 클리어 (선택 사항)
                            if (window.유물드랍타이머) clearTimeout(window.유물드랍타이머);

                            유물드랍박스.innerText = `유물 [${결과.드랍유물}]을(를) 획득했다!`;
                            유물드랍박스.style.display = "block";

                            // 위치 조정용 부모 변경
                            if (유저테두리안표시) {
                                // 유저테두리안표시에 위치 기준 설정
                                유저테두리안표시.style.position = "relative";

                                // 유물드랍박스를 유저테두리안표시 내부로 이동
                                유저테두리안표시.appendChild(유물드랍박스);

                                // 전투화면용 위치 조정
                                Object.assign(유물드랍박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100"
                                });
                            }
                        }

                        // ✅ 새 타이머로 숨김 처리 (전역 변수로 저장)
                        window.유물드랍타이머 = setTimeout(() => {
                            유물드랍박스.style.display = "none";
                        }, 3000);
                    }

                    if (결과.드랍장비) {
                        const 장비 = 결과.드랍장비;
                        const 네온박스 = document.getElementById("네온박스");
                        const 유저테두리안표시 = document.getElementById("유저테두리안표시");

                        if (네온박스) {
                            // ✅ 먼저 기존에 떠 있는 박스를 숨김
                            네온박스.style.display = "none";

                            // ✅ setTimeout 제거 방지: 이전 타이머 클리어 (선택 사항)
                            if (window.네온타이머) clearTimeout(window.네온타이머);

                            네온박스.innerText = `${장비.이름}을(를) 획득했다!`;
                            네온박스.style.display = "block";

                            // 위치 조정용 부모 변경
                            if (유저테두리안표시) {
                                // 유저테두리안표시에 위치 기준 설정
                                유저테두리안표시.style.position = "relative";

                                // 네온박스를 유저테두리안표시 내부로 이동
                                유저테두리안표시.appendChild(네온박스);

                                // 전투화면용 위치 조정
                                Object.assign(네온박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100"
                                });
                            }
                        }

                        // ✅ 새 타이머로 숨김 처리 (전역 변수로 저장)
                        window.네온타이머 = setTimeout(() => {
                            네온박스.style.display = "none";
                        }, 3000);
                    }


                    document.getElementById("승리패배로그").innerText = "승리";
                    document.getElementById("승리패배로그").style.color = "#00c851";
                }

                const 레어몬스터 = document.getElementById("레어몬스터");

                if (결과.레어몬스터이름) {
                    레어몬스터.innerText = 결과.레어몬스터이름;
                    레어몬스터.style.display = "inline-block";
                    레어몬스터등장 = true;
                    document.getElementById("등급외테두리").style.border = "0.2px solid #c653ff";
                } else {
                    레어몬스터.style.display = "none";
                    document.getElementById("등급외테두리").style.border = "0.2px solid #4b4b4b";
                }

                // ✅ 유저데이터 변경 이후, 승리/패배 관계 없이 실행
                const 스태미너표시 = document.getElementById("스태미너표시");
                const 에너지바 = document.querySelector(".에너지바");
                if (스태미너표시 && 에너지바) {
                    const 최대 = 유저데이터.최대스태미너 ?? 100;
                    const 현재 = 유저데이터.현재스태미너 ?? 0;
                    스태미너표시.innerText = `${현재}/${최대}`;
                    에너지바.style.width = `${(현재 / 최대) * 100}%`;
                }

                if (결과.모래시계발동) {
                    메시지표시(에너지바, 모래시계아이콘, "", "");
                }

            } catch (e) {
                메시지표시(메시지표시박스, "", "레어 전투 오류: " + e.message, "");
            } finally {
                if (레어몬스터등장) {
                    await new Promise(resolve => setTimeout(resolve, 1500)); // ✅ 1.5초 대기
                } else {
                    await new Promise(resolve => setTimeout(resolve, 500));


                }

                공격버튼잠금해제();

                if (풀자동실행) {
                    if (레어Btn.style.display !== "none") {
                        레어Btn.click();
                    } else {
                        공격Btn.click();
                    }
                }

            }

        });


        document.getElementById("장비").addEventListener("click", () => {
            if (!유저데이터) return;
            장비화면보여주기();
        });

        function 장비화면보여주기() {
            모든화면숨기기();
            document.getElementById("장비화면").style.display = "block";
            document.getElementById("획득로그").innerText = "";
            document.getElementById("추가획득로그").innerText = "";
            document.getElementById("레벨업표시").innerText = "";

            document.getElementById("화면설명").innerHTML =
                "일반 &lt; 레어 &lt; 신화 &lt; 고대 &lt; 태초 &lt; 타락<br>자동합성으로 상위장비를 획득하세요";

            // 📌 골드/공격력/체력 표시
            document.getElementById("장비골드표시").innerHTML =
                `${머니아이콘} ${유저데이터.골드.toLocaleString()} Gold | ${공격력아이콘} 공격력 ${유저데이터.최종공격력} | ${체력아이콘} 최대체력 ${유저데이터.최대체력}`;

            document.getElementById("장비자동합성").innerHTML = `자동합성`;

            // 📌 장비 컨테이너 정리
            const 장비컨테이너 = document.getElementById("장비컨테이너");
            장비컨테이너.innerHTML = "";

            const 장비목록 = 유저데이터.장비목록 || [];

            if (장비목록.length === 0) {
                장비컨테이너.innerText = "획득한 장비가 없습니다.";
                return;
            }

            const 등급우선순위 = {
                "일반": 1,
                "레어": 2,
                "신화": 3,
                "고대": 4,
                "태초": 5,
                "타락": 6,
            };

            // 등급별 정렬
            장비목록.sort((a, b) => {
                const 순서A = 등급우선순위[a.등급] || 999;
                const 순서B = 등급우선순위[b.등급] || 999;
                return 순서A - 순서B;
            });

            // 🔹 (추가) 최고 공격력 계산
            const max공격력 = Math.max(...장비목록.map(e => e.공격력));

            // 📌 장비 개별 렌더링
            장비목록.forEach(장비 => {
                const 박스 = document.createElement("div");

                // 🔹 (추가) 클래스 설정 직후
                박스.className = "기본테두리 양쪽정렬";

                // 🔹 (추가) 최고 공격력 장비일 경우 테두리 색을 흰색으로 덮어쓰기
                if (장비.공격력 === max공격력) {
                    박스.style.borderColor = "#fff";
                }

                박스.style.marginBottom = "8px";
                박스.style.color = 색상맵[장비.등급] || "#fff";
                박스.style.fontWeight = "bold";

                const 키 = `${장비.이름}|${장비.등급}`;
                const 수량 = 장비.수량 ? `${장비.수량}` : "0";
                const 강화표시 = 장비.강화 ? `+${장비.강화}` : "";
                const 이름표시 = `${장비.이름} (${수량}) ${강화표시}`;


                const 공격력HTML = 장비.등급 === "타락"
                    ? `${해머아이콘}  공격력 +${장비.공격력}`
                    : `공격력 +${장비.공격력}`;

                박스.innerHTML = `
    <div>[${장비.등급}] ${이름표시}</div>
    <div>${공격력HTML}</div>
`;
                //         박스.innerHTML = `
                //     <div>[${장비.등급}] ${이름표시}</div>
                //     <div>
                //         공격력 +${장비.공격력}
                //     </div>
                // `;
                const hammerEl = 박스.querySelector('.lucide-hammer-icon');
                if (hammerEl) {

                    hammerEl.addEventListener('click', async () => {

                        const 확인 = confirm(`루시퍼의 심장 1개를 소모해서 강화를 진행하시겠습니까? 공격력 증가량은 +360입니다`);
                        if (!확인) return;
                        화면잠금();
                        try {
                            const res = await fetch("/upgrade-corrupted-item", {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify({
                                    유저UID: 유저데이터.유저UID,
                                    이름: 장비.이름,
                                    등급: 장비.등급
                                })
                            });
                            const data = await res.json();
                            if (!res.ok) throw new Error(data.오류);

                            // 1) 전역 유저데이터의 해당 아이템만 업데이트
                            const item = 유저데이터.장비목록.find(e =>
                                e.이름 === data.이름 && e.등급 === data.등급
                            );
                            if (item) {
                                item.수량 = data.수량;
                                item.강화 = data.강화;
                                item.공격력 = data.공격력;
                            }

                            // 2) 전역 최종공격력 갱신
                            유저데이터.최종공격력 = data.최종공격력;

                            // 3) 메시지 보여주고 화면 다시 그리기
                            메시지표시(메시지표시박스, "", "강화 성공", "");
                            장비화면보여주기();
                        } catch (e) {
                            메시지표시(메시지표시박스, "", e.message, "");
                        } finally {
                            화면해제();
                        }
                    });

                }

                장비컨테이너.appendChild(박스);
            });
        }




        document.getElementById("장비자동합성").addEventListener("click", async () => {
            if (!유저데이터 || !유저데이터.유저UID) return;
            const 확인 = confirm(`하위장비 3개를 상위장비 1개로 합성하시겠습니까?`);
            if (!확인) return;

            const 합성버튼 = document.getElementById("장비자동합성");

            화면잠금();

            try {
                const 응답 = await fetch("/synthesize-item", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                });
                const 결과 = await 응답.json();

                if (!응답.ok || 결과.오류) {
                    메시지표시(합성버튼, "", 결과.오류 || "장비 합성에 실패했습니다.", "");
                    return;
                }

                유저데이터.장비목록 = 결과.장비목록;
                유저데이터.장비공격력 = 결과.장비공격력;
                유저데이터.최종공격력 = 결과.최종공격력;

                장비화면보여주기();
                메시지표시(메시지표시박스, "", "성공", "");

            } catch (e) {
                // 네트워크나 예외 발생 시
                메시지표시(합성버튼, "", "구현중입니다", "");
                console.error(e);
            } finally {
                화면해제();
            }
        });










        async function 장비강화(이름, 등급, 박스) {
            if (!유저데이터 || !유저데이터.유저UID) return;

            const 강화비용 = {
                "일반": 10000,
                "레어": 30000,
                "신화": 100000,
                "고대": 200000,
                "태초": 300000,
                "타락": 400000,
            }[등급];

            const 비용 = 강화비용;

            if ((유저데이터.골드 || 0) < 비용) {
                메시지표시(메시지표시박스, "", `골드 부족: ${비용.toLocaleString()} 필요`, "");
                return;
            }

            const 확인 = confirm(`[${등급}] 장비를 ${비용} Gold로 강화하시겠습니까?`);
            if (!확인) return;

            화면잠금();

            try {
                const 응답 = await fetch("/upgrade-item", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID,
                        이름,
                        등급
                    })
                });

                const 결과 = await 응답.json();

                if (!응답.ok || 결과.오류) {
                    메시지표시(메시지표시박스, "", 결과.오류 || "강화 실패..", "");
                    return;
                }

                메시지표시(박스, 결과.성공 ? "✅" : "", 결과.메시지, 결과.성공 ? "#00c851" : "#ef4444");

                const 장비 = 유저데이터.장비목록.find(j => j.이름 === 이름 && j.등급 === 등급);
                if (장비) {
                    장비.강화 = 결과.강화;
                    장비.공격력 = 결과.무기공격력;
                }

                유저데이터.장비공격력 = 결과.장비공격력;
                유저데이터.최종공격력 = 결과.최종공격력;
                유저데이터.골드 = 결과.골드;

                장비화면보여주기();
            } catch (e) {
                메시지표시(메시지표시박스, "", "오류: " + e.message, "#ef4444");
            } finally {
                화면해제();
            }
        }

        document.getElementById("총숙련도").addEventListener("click", () => {
            if (!유저데이터) return;
            스킬화면보여주기();
        });

        function 스킬정보불러오기() {
            return {
                인텔리전스: {
                    단계: ["알파 인텔리전스",
                        "베타 인텔리전스",
                        "감마 인텔리전스",
                        "델타 인텔리전스",
                        "엡실론 인텔리전스",
                        "제타 인텔리전스",
                        "에타 인텔리전스",
                        "쎄타 인텔리전스",
                        "아이오타 인텔리전스",
                        "카파 인텔리전스",
                        "람다 인텔리전스",
                        "뮤 인텔리전스",
                        "뉴 인텔리전스",
                        "크사이 인텔리전스",
                        "오미크론 인텔리전스",
                        "파이 인텔리전스",
                        "로 인텔리전스",
                        "시그마 인텔리전스",
                        "타우 인텔리전스",
                        "윕실론 인텔리전스",
                        "카이 인텔리전스",
                        "프사이 인텔리전스",
                        "오메가 인텔리전스"
                    ],
                    설명: [
                        "경험치 +10%",
                        "경험치 +20%",
                        "경험치 +30%",
                        "경험치 +40%",
                        "경험치 +50%",
                        "경험치 +60%",
                        "경험치 +70%",
                        "경험치 +80%",
                        "경험치 +90%",
                        "경험치 +100%",
                        "경험치 +110%",
                        "경험치 +120%",
                        "경험치 +130%",
                        "경험치 +140%",
                        "경험치 +150%",
                        "경험치 +160%",
                        "경험치 +170%",
                        "경험치 +180%",
                        "경험치 +190%",
                        "경험치 +200%",
                        "경험치 +210%",
                        "경험치 +220%",
                        "경험치 +230%"
                    ],
                    아이콘: 인텔리전스아이콘
                },

                발굴: {
                    단계: [
                        "알파 발굴",
                        "베타 발굴",
                        "감마 발굴",
                        "델타 발굴",
                        "엡실론 발굴",
                        "제타 발굴",
                        "에타 발굴",
                        "쎄타 발굴",
                        "아이오타 발굴",
                        "카파 발굴",
                        "람다 발굴",
                        "뮤 발굴",
                        "뉴 발굴",
                        "크사이 발굴",
                        "오미크론 발굴",
                        "파이 발굴",
                        "로 발굴",
                        "시그마 발굴",
                        "타우 발굴",
                        "윕실론 발굴",
                        "카이 발굴",
                        "프사이 발굴",
                        "오메가 발굴"
                    ],
                    설명: [
                        "골드 획득 +10%",
                        "골드 획득 +20%",
                        "골드 획득 +30%",
                        "골드 획득 +40%",
                        "골드 획득 +50%",
                        "골드 획득 +60%",
                        "골드 획득 +70%",
                        "골드 획득 +80%",
                        "골드 획득 +90%",
                        "골드 획득 +100%",
                        "골드 획득 +110%",
                        "골드 획득 +120%",
                        "골드 획득 +130%",
                        "골드 획득 +140%",
                        "골드 획득 +150%",
                        "골드 획득 +160%",
                        "골드 획득 +170%",
                        "골드 획득 +180%",
                        "골드 획득 +190%",
                        "골드 획득 +200%",
                        "골드 획득 +210%",
                        "골드 획득 +220%",
                        "골드 획득 +230%"
                    ],
                    아이콘: 발굴아이콘
                },

                인사이트: {
                    단계: ["알파 인사이트"],
                    설명: ["숙련도 + 1"],
                    아이콘: 인사이트아이콘
                },
                // 인사이트: {
                //     단계: ["마이크로 인사이트", "나노 인사이트"],
                //     설명: ["숙련도 + 1", "숙련도 + 2"],
                //     아이콘: 인사이트아이콘
                // },

                아이언바디: {
                    단계: ["알파 아이언바디",
                        "베타 아이언바디",
                        "감마 아이언바디",
                        "델타 아이언바디",
                        "엡실론 아이언바디",
                        "제타 아이언바디",
                        "에타 아이언바디",
                        "쎄타 아이언바디",
                        "아이오타 아이언바디",
                        "카파 아이언바디",
                        "람다 아이언바디",
                        "뮤 아이언바디",
                        "뉴 아이언바디",
                        "크사이 아이언바디",
                        "오미크론 아이언바디",
                        "파이 아이언바디",
                        "로 아이언바디",
                        "시그마 아이언바디",
                        "타우 아이언바디",
                        "윕실론 아이언바디",
                        "카이 아이언바디",
                        "프사이 아이언바디",
                        "오메가 아이언바디"],
                    설명: [
                        "공격전 체력회복 +1",
                        "공격전 체력회복 +2",
                        "공격전 체력회복 +3",
                        "공격전 체력회복 +4",
                        "공격전 체력회복 +5",
                        "공격전 체력회복 +6",
                        "공격전 체력회복 +7",
                        "공격전 체력회복 +8",
                        "공격전 체력회복 +9",
                        "공격전 체력회복 +10",
                        "공격전 체력회복 +11",
                        "공격전 체력회복 +12",
                        "공격전 체력회복 +13",
                        "공격전 체력회복 +14",
                        "공격전 체력회복 +15",
                        "공격전 체력회복 +16",
                        "공격전 체력회복 +17",
                        "공격전 체력회복 +18",
                        "공격전 체력회복 +19",
                        "공격전 체력회복 +20",
                        "공격전 체력회복 +21",
                        "공격전 체력회복 +22",
                        "공격전 체력회복 +23"
                    ],
                    아이콘: 아이언바디아이콘
                },
                드레인: {
                    단계: ["알파 드레인",
                        "베타 드레인",
                        "감마 드레인",
                        "델타 드레인",
                        "엡실론 드레인",
                        "제타 드레인",
                        "에타 드레인",
                        "쎄타 드레인",
                        "아이오타 드레인",
                        "카파 드레인",
                        "람다 드레인",
                        "뮤 드레인",
                        "뉴 드레인",
                        "크사이 드레인",
                        "오미크론 드레인",
                        "파이 드레인",
                        "로 드레인",
                        "시그마 드레인",
                        "타우 드레인",
                        "윕실론 드레인",
                        "카이 드레인",
                        "프사이 드레인",
                        "오메가 드레인"],
                    설명: [
                        "처치 후 체력회복 +1",
                        "처치 후 체력회복 +2",
                        "처치 후 체력회복 +3",
                        "처치 후 체력회복 +4",
                        "처치 후 체력회복 +5",
                        "처치 후 체력회복 +6",
                        "처치 후 체력회복 +7",
                        "처치 후 체력회복 +8",
                        "처치 후 체력회복 +9",
                        "처치 후 체력회복 +10",
                        "처치 후 체력회복 +11",
                        "처치 후 체력회복 +12",
                        "처치 후 체력회복 +13",
                        "처치 후 체력회복 +14",
                        "처치 후 체력회복 +15",
                        "처치 후 체력회복 +16",
                        "처치 후 체력회복 +17",
                        "처치 후 체력회복 +18",
                        "처치 후 체력회복 +19",
                        "처치 후 체력회복 +20",
                        "처치 후 체력회복 +21",
                        "처치 후 체력회복 +22",
                        "처치 후 체력회복 +23"
                    ],
                    아이콘: 드레인아이콘
                },

                크리티컬: {
                    단계: [
                        "알파 크리티컬",
                        "베타 크리티컬",
                        "감마 크리티컬",
                        "델타 크리티컬",
                        "엡실론 크리티컬",
                        "제타 크리티컬",
                        "에타 크리티컬",
                        "쎄타 크리티컬",
                        "아이오타 크리티컬",
                        "카파 크리티컬",
                        "람다 크리티컬",
                        "뮤 크리티컬",
                        "뉴 크리티컬",
                        "크사이 크리티컬",
                        "오미크론 크리티컬",
                        "파이 크리티컬",
                        "로 크리티컬",
                        "시그마 크리티컬",
                        "타우 크리티컬",
                        "윕실론 크리티컬",
                        "카이 크리티컬",
                        "프사이 크리티컬",
                        "오메가 크리티컬"
                    ],
                    설명: [
                        "최종데미지 +10%",
                        "최종데미지 +20%",
                        "최종데미지 +30%",
                        "최종데미지 +40%",
                        "최종데미지 +50%",
                        "최종데미지 +60%",
                        "최종데미지 +70%",
                        "최종데미지 +80%",
                        "최종데미지 +90%",
                        "최종데미지 +100%",
                        "최종데미지 +110%",
                        "최종데미지 +120%",
                        "최종데미지 +130%",
                        "최종데미지 +140%",
                        "최종데미지 +150%",
                        "최종데미지 +160%",
                        "최종데미지 +170%",
                        "최종데미지 +180%",
                        "최종데미지 +190%",
                        "최종데미지 +200%",
                        "최종데미지 +210%",
                        "최종데미지 +220%",
                        "최종데미지 +230%"
                    ],
                    아이콘: 크리티컬아이콘
                },
                버서커: {
                    단계: [
                        "알파 버서커",
                        "베타 버서커",
                        "감마 버서커",
                        "델타 버서커",
                        "엡실론 버서커",
                        "제타 버서커",
                        "에타 버서커",
                        "쎄타 버서커",
                        "아이오타 버서커",
                        "카파 버서커",
                        "람다 버서커",
                        "뮤 버서커",
                        "뉴 버서커",
                        "크사이 버서커",
                        "오미크론 버서커",
                        "파이 버서커",
                        "로 버서커",
                        "시그마 버서커",
                        "타우 버서커",
                        "윕실론 버서커",
                        "카이 버서커",
                        "프사이 버서커",
                        "오메가 버서커"],
                    설명: [
                        "턴당 체력 -1, 최종데미지 +120%",
                        "턴당 체력 -2, 최종데미지 +230%",
                        "턴당 체력 -3, 최종데미지 +340%",
                        "턴당 체력 -4, 최종데미지 +450%",
                        "턴당 체력 -5, 최종데미지 +560%",
                        "턴당 체력 -6, 최종데미지 +670%",
                        "턴당 체력 -7, 최종데미지 +780%",
                        "턴당 체력 -8, 최종데미지 +890%",
                        "턴당 체력 -9, 최종데미지 +1000%",
                        "턴당 체력 -10, 최종데미지 +1110%",
                        "턴당 체력 -11, 최종데미지 +1220%",
                        "턴당 체력 -12, 최종데미지 +1330%",
                        "턴당 체력 -13, 최종데미지 +1440%",
                        "턴당 체력 -14, 최종데미지 +1550%",
                        "턴당 체력 -15, 최종데미지 +1660%",
                        "턴당 체력 -16, 최종데미지 +1770%",
                        "턴당 체력 -17, 최종데미지 +1880%",
                        "턴당 체력 -18, 최종데미지 +1990%",
                        "턴당 체력 -19, 최종데미지 +2100%",
                        "턴당 체력 -20, 최종데미지 +2210%",
                        "턴당 체력 -21, 최종데미지 +2320%",
                        "턴당 체력 -22, 최종데미지 +2430%",
                        "턴당 체력 -23, 최종데미지 +2540%"
                    ],
                    아이콘: 버서커아이콘
                },

                버닝: {
                    단계: ["알파 버닝",
                        "베타 버닝",
                        "감마 버닝",
                        "델타 버닝",
                        "엡실론 버닝",
                        "제타 버닝",
                        "에타 버닝",
                        "쎄타 버닝",
                        "아이오타 버닝",
                        "카파 버닝",
                        "람다 버닝",
                        "뮤 버닝",
                        "뉴 버닝",
                        "크사이 버닝",
                        "오미크론 버닝",
                        "파이 버닝",
                        "로 버닝",
                        "시그마 버닝",
                        "타우 버닝",
                        "윕실론 버닝",
                        "카이 버닝",
                        "프사이 버닝",
                        "오메가 버닝"],
                    설명: [
                        "체력 50% 이하일 때, 최종데미지 +20%",
                        "체력 50% 이하일 때, 최종데미지 +40%",
                        "체력 50% 이하일 때, 최종데미지 +60%",
                        "체력 50% 이하일 때, 최종데미지 +80%",
                        "체력 50% 이하일 때, 최종데미지 +100%",
                        "체력 50% 이하일 때, 최종데미지 +120%",
                        "체력 50% 이하일 때, 최종데미지 +140%",
                        "체력 50% 이하일 때, 최종데미지 +160%",
                        "체력 50% 이하일 때, 최종데미지 +180%",
                        "체력 50% 이하일 때, 최종데미지 +200%",
                        "체력 50% 이하일 때, 최종데미지 +220%",
                        "체력 50% 이하일 때, 최종데미지 +240%",
                        "체력 50% 이하일 때, 최종데미지 +260%",
                        "체력 50% 이하일 때, 최종데미지 +280%",
                        "체력 50% 이하일 때, 최종데미지 +300%",
                        "체력 50% 이하일 때, 최종데미지 +320%",
                        "체력 50% 이하일 때, 최종데미지 +340%",
                        "체력 50% 이하일 때, 최종데미지 +360%",
                        "체력 50% 이하일 때, 최종데미지 +380%",
                        "체력 50% 이하일 때, 최종데미지 +400%",
                        "체력 50% 이하일 때, 최종데미지 +420%",
                        "체력 50% 이하일 때, 최종데미지 +440%",
                        "체력 50% 이하일 때, 최종데미지 +460%"
                    ],
                    아이콘: 버닝아이콘
                },
                브로큰: {
                    단계: [
                        "알파 브로큰",
                        "베타 브로큰",
                        "감마 브로큰",
                        "델타 브로큰",
                        "엡실론 브로큰",
                        "제타 브로큰",
                        "에타 브로큰",
                        "쎄타 브로큰",
                        "아이오타 브로큰",
                        "카파 브로큰",
                        "람다 브로큰",
                        "뮤 브로큰",
                        "뉴 브로큰",
                        "크사이 브로큰",
                        "오미크론 브로큰",
                        "파이 브로큰",
                        "로 브로큰",
                        "시그마 브로큰",
                        "타우 브로큰",
                        "윕실론 브로큰",
                        "카이 브로큰",
                        "프사이 브로큰",
                        "오메가 브로큰"
                    ],
                    설명: [
                        "방어력 무시 4%",
                        "방어력 무시 8%",
                        "방어력 무시 12%",
                        "방어력 무시 16%",
                        "방어력 무시 20%",
                        "방어력 무시 24%",
                        "방어력 무시 28%",
                        "방어력 무시 32%",
                        "방어력 무시 36%",
                        "방어력 무시 40%",
                        "방어력 무시 44%",
                        "방어력 무시 48%",
                        "방어력 무시 52%",
                        "방어력 무시 56%",
                        "방어력 무시 60%",
                        "방어력 무시 64%",
                        "방어력 무시 68%",
                        "방어력 무시 72%",
                        "방어력 무시 76%",
                        "방어력 무시 80%",
                        "방어력 무시 84%",
                        "방어력 무시 88%",
                        "방어력 무시 92%"
                    ],
                    아이콘: 브로큰아이콘
                },
                즉사: {
                    단계: ["일급 즉사", "이급 즉사", "삼급 즉사"],
                    설명: ["11번째 몬스터 즉사", "8번째 몬스터 즉사", "5번째 몬스터 즉사"],
                    아이콘: 즉사아이콘
                },
            };
        }

        function 스킬화면보여주기() {
            화면잠금();
            모든화면숨기기();
            document.getElementById("화면설명").innerText = "보유숙련도 클릭 시 스킬초기화 가능합니다";

            document.getElementById("스킬화면").style.display = "block";

            document.getElementById("획득로그").innerText = "";
            document.getElementById("추가획득로그").innerText = "";
            document.getElementById("레벨업표시").innerText = "";
            document.getElementById("보유숙련도").innerText = "보유 숙련도 " + 유저데이터.숙련도;

            const 컨테이너 = document.getElementById("스킬컨테이너");
            컨테이너.innerHTML = "";

            const 총투자 = Object.values(유저데이터.스킬 || {}).reduce((a, b) => a + b, 0);
            const 다음필요숙련도 = (총투자 + 1) * 500;
            document.getElementById("필요숙련도").innerText = "필요숙련도 " + 다음필요숙련도;

            const 스킬정보 = 스킬정보불러오기();

            const 루시드아이콘SVG = `
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
stroke-linejoin="round" class="lucide lucide-star-icon lucide-star">
<path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"/>
</svg>`;

            for (const 계열명 in 스킬정보) {
                const { 단계, 설명, 아이콘 } = 스킬정보[계열명];

                const 배운레벨 = 유저데이터.스킬?.[계열명] || 0;
                const 현재단계 = Math.min(배운레벨, 단계.length - 1);
                const 스킬이름 = 단계[현재단계];
                const 스킬설명 = 설명[현재단계];

                const 줄 = document.createElement("div");
                줄.className = "양쪽정렬 기본테두리";
                줄.style.position = "relative";

                줄.innerHTML = `
  <div>
    ${아이콘} ${스킬이름}
    <div style="font-size: 12px; color: #888; margin-top: 2px;">${스킬설명}</div>
  </div>
  <div class="가로정렬">
    <div class="버튼">습득</div>
  </div>
`;
                // <div class="버튼">회수</div>

                // 별 개수 표시
                if (배운레벨 > 0) {
                    const 아이콘박스 = document.createElement("div");
                    아이콘박스.style.position = "absolute";
                    아이콘박스.style.top = "-10px";
                    아이콘박스.style.left = "6px";
                    아이콘박스.style.zIndex = "10";
                    아이콘박스.style.display = "flex";

                    for (let i = 0; i < 배운레벨; i++) {
                        const 아이콘별 = document.createElement("div");
                        아이콘별.innerHTML = 루시드아이콘SVG;
                        아이콘별.style.color = 배운레벨 === 단계.length ? "#facc15" : "#ffffff";
                        아이콘박스.appendChild(아이콘별);
                    }

                    줄.appendChild(아이콘박스);
                }

                컨테이너.appendChild(줄);

                줄.querySelectorAll(".버튼").forEach(버튼 => {
                    버튼.addEventListener("click", async () => {
                        const 행동 = 버튼.innerText.trim(); // "습득" 또는 "회수"
                        화면잠금();
                        try {
                            const 응답 = await fetch("/update-skill", {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify({
                                    유저UID: 유저데이터.유저UID,
                                    스킬이름: 계열명,
                                    행동
                                })
                            });

                            const 결과 = await 응답.json();

                            if (!응답.ok || 결과.오류) {
                                메시지표시(줄, "", 결과.오류 || "실패", "");
                                return;
                            }

                            유저데이터.스킬 = 결과.스킬;
                            유저데이터.숙련도 = 결과.숙련도;

                            const 색 = 행동 === "습득" ? "#00c851" : "#3b82f6";
                            const 메세지 = 행동 + " 완료";
                            const 아이콘 = 행동 === "습득" ? "✅" : "↩️";

                            메시지표시(줄, 아이콘, 메세지, 색);
                            스킬화면보여주기(); // 갱신
                        } catch (e) {
                            메시지표시(줄, "", "서버 오류: " + e.message, "");
                        } finally {
                            화면해제();
                        }
                    });
                });
            }
            화면해제();
        }

        document.getElementById("보유숙련도").addEventListener("click", async () => {
            const 확인 = window.confirm("스킬 초기화에는 플라워 유물 1개가 소모됩니다.\n진행하시겠습니까?");
            if (!확인) return;

            화면잠금();

            try {
                const 응답 = await fetch("/update-skill", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID,
                        스킬이름: "전체",
                        행동: "초기화"
                    })
                });

                const 결과 = await 응답.json();

                if (!응답.ok || 결과.오류) {
                    메시지표시(보유숙련도, "", 결과.오류 || "초기화 실패", "");
                    return;
                }


                유저데이터.숙련도 = 결과.숙련도;
                유저데이터.스킬 = 결과.스킬;
                유저데이터.유물목록 = 결과.유물목록;

                메시지표시(스킬화면, "", "모든 스킬 초기화 완료", "");
                스킬화면보여주기();
            } catch (e) {
                메시지표시(스킬화면, "", "서버 오류: " + e.message, "");
            } finally {
                화면해제();
            }
        });

        document.getElementById("전직화면타이틀").addEventListener("click", async () => {
            const 확인 = window.confirm(
                "직업 초기화에는 뼈다구 유물 1개가 소모됩니다.\n진행하시겠습니까?"
            );
            if (!확인) return;

            화면잠금();

            try {
                const 응답 = await fetch("/reset-job", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID
                    })
                });

                const 결과 = await 응답.json();

                if (!응답.ok || 결과.오류) {
                    메시지표시(
                        전직화면타이틀,
                        "",
                        결과.오류 || "초기화 실패",
                        ""
                    );
                    return;
                }

                // 서버가 정상 반환한 필드를 유저데이터에 반영
                유저데이터.경험치 = 결과.경험치;
                유저데이터.레벨 = 결과.레벨;
                유저데이터.전직공격력 = 결과.전직공격력;
                유저데이터.레벨공격력 = 결과.레벨공격력;
                유저데이터.최종공격력 = 결과.최종공격력;
                유저데이터.유물목록 = 결과.유물목록;

                // 화면에 메시지 출력
                메시지표시(전직화면타이틀, "", "직업 초기화 완료", "");

                // 전직화면을 새로 불러와서 다시 렌더링
                전직화면보여주기();
            } catch (e) {
                메시지표시(전직화면타이틀, "", "서버 오류: " + e.message, "");
            } finally {
                화면해제();
            }
        });





        //유물화면보여주기
        document.getElementById("유물").addEventListener("click", () => {
            if (!유저데이터) return;

            화면잠금();
            모든화면숨기기();
            document.getElementById("화면설명").innerHTML =
                "유물당 최대 개수는 99개입니다<br>소모성 유물은 뽑기으로만 획득 가능합니다";

            document.getElementById("유물화면").style.display = "block";

            const 컨테이너 = document.getElementById("유물컨테이너");
            컨테이너.innerHTML = "";

            const 유물목록 = 유저데이터.유물목록 || {};
            if (Object.keys(유물목록).length === 0) {
                컨테이너.innerText = "획득한 유물이 없습니다";
                화면해제();
                return;
            }

            for (const 유물이름 in 유물목록) {
                const 수량 = 유물목록[유물이름] || 0;

                const 아이콘HTML = 아이콘맵[`${유물이름}아이콘`] || "";

                const div = document.createElement("div");
                div.className = "기본테두리 커서호버";
                div.style.position = "relative";
                div.style.display = "flex";
                div.style.alignItems = "center";
                div.style.justifyContent = "center";
                div.style.width = "50px"; // 루시드아이콘 크기 기준
                div.style.height = "50px";
                div.style.margin = "5px";
                div.style.padding = "2px";

                const 레어테두리유물들 = ["샐러드",];
                if (레어테두리유물들.includes(유물이름)) {
                    div.style.border = `0.2px solid ${색상맵["레어"]}`;
                }
                const 신화테두리유물들 = ["햄버거", "마법의팔레트"];
                if (신화테두리유물들.includes(유물이름)) {
                    div.style.border = `0.2px solid ${색상맵["신화"]}`;
                }

                div.innerHTML = `
            ${아이콘HTML}
<div style="
    position: absolute;
    bottom: 0px;
    right: 2px;
    font-size: 10px;
    color: #aaa;
">x${수량}</div>
        `;

                div.addEventListener("mouseover", () => {
                    const 기존설명 = div.querySelector(".유물설명");
                    if (기존설명) 기존설명.remove();

                    const 데이터 = 신화유물데이터[유물이름];

                    const 설명div = document.createElement("div");
                    설명div.className = "유물설명";
                    설명div.style.position = "absolute";
                    설명div.style.top = "100%";
                    설명div.style.left = "50%";
                    설명div.style.transform = "translateX(-50%)";
                    설명div.style.backgroundColor = "transparent";  // ✅ 완전 투명
                    설명div.style.color = "yellow";
                    설명div.style.fontSize = "12px";
                    설명div.style.padding = "2px 4px";
                    설명div.style.borderRadius = "3px";
                    설명div.style.whiteSpace = "nowrap";
                    설명div.style.zIndex = "10";
                    설명div.style.textAlign = "center"; // ✅ 가운데 정렬

                    if (데이터) {
                        설명div.innerHTML = `<b>${유물이름}</b><br>${데이터.설명}`;
                    } else {
                        설명div.innerText = "정보 없음";
                    }

                    div.appendChild(설명div);
                });

                // ✅ 마우스 아웃 시 설명 div 삭제
                div.addEventListener("mouseout", () => {
                    const 기존설명 = div.querySelector(".유물설명");
                    if (기존설명) 기존설명.remove();
                });

                div.addEventListener("click", async () => {
                    if (유물이름 === "샐러드") {
                        const 확인 = confirm("샐러드를 먹고 스태미너 60을 회복하시겠습니까?");
                        if (!확인) return;

                        화면잠금();
                        try {
                            const 응답 = await fetch("/use-salad", {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                            });
                            const 결과 = await 응답.json();

                            if (결과.오류) {
                                메시지표시(div, "", 결과.오류, "");
                            } else {
                                유저데이터.현재스태미너 = 결과.현재스태미너;
                                유저데이터.유물목록 = 결과.유물목록;
                                메시지표시(div, "", "샐러드를 먹고 스태미너가 회복됩니다", "");
                                document.getElementById("유물").click();
                            }
                        } catch (e) {
                            메시지표시(div, "", "서버 오류 발생", "");
                        }
                        화면해제();
                    }
                    else if (유물이름 === "햄버거") {
                        const 확인 = confirm("햄버거를 먹고 스태미너 300을 회복하시겠습니까?");
                        if (!확인) return;

                        화면잠금();
                        try {
                            const 응답 = await fetch("/use-Hamburger", {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                            });
                            const 결과 = await 응답.json();

                            if (결과.오류) {
                                메시지표시(div, "", 결과.오류, "");
                            } else {
                                유저데이터.현재스태미너 = 결과.현재스태미너;
                                유저데이터.유물목록 = 결과.유물목록;
                                메시지표시(div, "", "햄버거 존맛!", "");
                                document.getElementById("유물").click();
                            }
                        } catch (e) {
                            메시지표시(div, "", "서버 오류 발생", "");
                        }
                        화면해제();
                    }
                    else if (유물이름 === "마법의팔레트") {
                        const 확인 = confirm("마법의팔레트를 사용하여 아이디를 염색하시겠습니까?");
                        if (!확인) return;

                        화면잠금();
                        try {
                            const 응답 = await fetch("/use-magic-palette", {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                            });
                            const 결과 = await 응답.json();

                            if (결과.오류) {
                                메시지표시(div, "", 결과.오류, "");
                            } else {
                                // 서버가 반환한 업데이트된 유물목록으로 갱신
                                유저데이터.유물목록 = 결과.유물목록;
                                메시지표시(div, "", 결과.마법의팔레트 + " 당첨. 새로고침하세요", "");
                                // 화면 다시 렌더링
                                document.getElementById("유물").click();
                            }
                        } catch (e) {
                            메시지표시(div, "", "서버 오류 발생", "");
                        }
                        화면해제();
                    }
                    // else if (유물이름 === "플라워") {
                    //     const 확인 = confirm("꽃을 100,000Gold에 파시겠습니까?");
                    //     if (!확인) return;

                    //     화면잠금();
                    //     try {
                    //         const 응답 = await fetch("/use-flower", {
                    //             method: "POST",
                    //             headers: { "Content-Type": "application/json" },
                    //             body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                    //         });
                    //         const 결과 = await 응답.json();

                    //         if (결과.오류) {
                    //             메시지표시(div, "", 결과.오류, "");
                    //         } else {
                    //             // 서버가 반환한 업데이트된 유물목록으로 갱신
                    //             유저데이터.골드 = 결과.골드;
                    //             유저데이터.유물목록 = 결과.유물목록;
                    //             메시지표시(div, "", "돈생겼다 뽑기하러 가즈ㅏㅏ", "");
                    //             // 화면 다시 렌더링
                    //             document.getElementById("유물").click();
                    //         }
                    //     } catch (e) {
                    //         메시지표시(div, "", "서버 오류 발생", "");
                    //     }
                    //     화면해제();
                    // }
                    // else if (유물이름 === "뼈다구") {
                    //     const 확인 = confirm("뼈다구를 100,000Gold에 파시겠습니까?");
                    //     if (!확인) return;

                    //     화면잠금();
                    //     try {
                    //         const 응답 = await fetch("/use-bone", {
                    //             method: "POST",
                    //             headers: { "Content-Type": "application/json" },
                    //             body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                    //         });
                    //         const 결과 = await 응답.json();

                    //         if (결과.오류) {
                    //             메시지표시(div, "", 결과.오류, "");
                    //         } else {
                    //             // 서버가 반환한 업데이트된 유물목록으로 갱신
                    //             유저데이터.골드 = 결과.골드;
                    //             유저데이터.유물목록 = 결과.유물목록;
                    //             메시지표시(div, "", "돈생겼다 뽑기하러 가즈ㅏㅏ", "");
                    //             // 화면 다시 렌더링
                    //             document.getElementById("유물").click();
                    //         }
                    //     } catch (e) {
                    //         메시지표시(div, "", "서버 오류 발생", "");
                    //     }
                    //     화면해제();
                    // }

                });

                컨테이너.appendChild(div);
            }
            화면해제();
        });


        document.getElementById("타이틀을아이디로").addEventListener("click", async function 아이디변경시작() {
            if (!유저데이터) return;

            const 기존표시 = document.getElementById("타이틀을아이디로");
            const 원래아이디 = 유저데이터.유저아이디;

            // 입력창 생성
            const 입력창 = document.createElement("input");
            입력창.type = "text";
            입력창.maxLength = 8;
            입력창.placeholder = "새 아이디 입력";
            입력창.style.background = "white";
            입력창.style.color = "black";
            입력창.style.border = "none";
            입력창.style.fontSize = "14px";
            입력창.size = 8;
            입력창.style.outline = "none";
            입력창.value = "";
            기존표시.replaceWith(입력창);
            입력창.focus();

            // 외부 클릭 감지 핸들러
            const 외부클릭취소 = (e) => {
                if (!입력창.contains(e.target)) {
                    const 복원 = document.createElement("div");
                    복원.id = "타이틀을아이디로";
                    복원.className = "커서호버";
                    복원.innerText = 원래아이디;
                    입력창.replaceWith(복원);
                    복원.addEventListener("click", 아이디변경시작);
                    document.removeEventListener("click", 외부클릭취소);
                }
            };

            // 입력창 클릭 제외하고 바깥 클릭 시 취소
            setTimeout(() => {
                document.addEventListener("click", 외부클릭취소);
            }, 0);

            입력창.addEventListener("keydown", async (e) => {
                if (e.key !== "Enter") return;

                const 새아이디 = 입력창.value.trim();
                if (!새아이디 || 새아이디.length > 6) {
                    메시지표시(메시지표시박스, "", "1~6자 이내로 입력하세요", "");
                    return;
                }

                화면잠금();

                try {
                    const 응답 = await fetch("/update-username", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            유저UID: 유저데이터.유저UID,
                            새아이디
                        })
                    });

                    const 결과 = await 응답.json();

                    if (!응답.ok) {
                        메시지표시(메시지표시박스, "", 결과.오류 || "아이디 변경 실패", "");
                        화면해제();
                        return;
                    }

                    유저데이터.유저아이디 = 새아이디;

                    const 복원 = document.createElement("div");
                    복원.id = "타이틀을아이디로";
                    복원.className = "커서호버";
                    복원.innerText = 새아이디;
                    입력창.replaceWith(복원);
                    복원.addEventListener("click", 아이디변경시작);

                    document.getElementById("유저아이디").innerText = 새아이디;
                    메시지표시(메시지표시박스, "✅", "아이디 변경 완료", "#00c851");

                    document.removeEventListener("click", 외부클릭취소);
                } catch (e) {
                    메시지표시(메시지표시박스, "", "네트워크 오류", "");
                } finally {
                    화면해제();
                }
            });
        });

        // 🟡 무지개 타이틀 애니메이션
        let 색상인덱스 = 0;
        const 무지개색들 = ["#ff0000", "#ff7f00", "#ffff00", "#00ff00", "#0000ff", "#4b0082", "#9400d3"];
        setInterval(() => {
            const 타이틀 = document.getElementById("뽑기타이틀");
            // 타이틀.style.display = "flex";
            // 타이틀.style.alignItems = "center";
            // 타이틀.style.gap = "6px";
            타이틀.innerHTML = `${뽑기아이콘} 뽑기`;
            if (타이틀) {
                타이틀.style.color = 무지개색들[색상인덱스 % 무지개색들.length];
                색상인덱스++;
            }
        }, 250);



        //외부클릭시
        document.addEventListener("click", (e) => {
            const target = e.target;


            if (target.id !== "반자동" && target.id !== "풀자동" && target.id !== "공격버튼" && target.id !== "레어몬스터") {
                반자동실행 = false;
                풀자동실행 = false;
            }


            const 뽑기창 = document.getElementById("뽑기창");
            if (뽑기창.style.display !== "none" && !뽑기창.contains(target) && target.id !== "총골드") {
                뽑기창.style.display = "none";
            }

            const 미니창 = document.getElementById("미니정보창");
            if (미니창.style.display === "block" && !미니창.contains(target)) {
                미니창.style.display = "none";
            }

            // 3) 기타 클릭 핸들링
            switch (target.id) {
                // case "객체아이디":
                //   실행함수();
                //   break;
            }

            //    총경험치 클릭 시 전직화면 열기
            if (target.matches("#총경험치")) {
                모든화면숨기기();
                document.getElementById("전직화면").style.display = "block";
                전직화면보여주기();
            }
        });


        document.getElementById("총골드").addEventListener("click", () => {
            if (!유저데이터) return;
            const 뽑기창 = document.getElementById("뽑기창");
            뽑기창.style.display = "block";
        });



        async function 장비뽑기시도(종류 = "일반") {
            const 뽑기창 = document.getElementById("뽑기창");
            const 네온박스 = document.getElementById("네온박스");
            const 비용 = 100000;
            const 등급외테두리 = document.getElementById("등급외테두리");

            if (종류 === "일반") {
                if (유저데이터.골드 < 비용) {
                    메시지표시(뽑기창, "", "골드 부족!", "");
                    return;
                }
            } else if (종류 === "고급") {
                const 티켓 = 유저데이터.유물목록?.["티켓"] || 0;
                if (티켓 < 1) {
                    메시지표시(뽑기창, "", "유물. 티켓이 부족합니다!", "");
                    return;
                }
            } else if (종류 === "연속일반") {
                if (유저데이터.골드 < 10 * 비용) {
                    메시지표시(뽑기창, "", "골드 부족!", "");
                    return;
                }
            } else if (종류 === "연속고급") {
                const 티켓 = 유저데이터.유물목록?.["티켓"] || 0;
                if (티켓 < 10) {
                    메시지표시(뽑기창, "", "유물. 티켓이 부족합니다!", "");
                    return;
                }
            }

            // confirm 메시지 확장
            const 메시지 =
                종류 === "일반"
                    ? `일반장비뽑기을 ${비용.toLocaleString()} 골드로 진행하시겠습니까?`
                    : 종류 === "고급"
                        ? `고급장비뽑기을 티켓 1장으로 진행하시겠습니까?`
                        : 종류 === "연속일반"
                            ? `연속일반장비뽑기 10회를 총 ${(10 * 비용).toLocaleString()} 골드로 진행하시겠습니까?`
                            : 종류 === "연속고급"
                                ? `연속고급장비뽑기 10회를 티켓 10장으로 진행하시겠습니까?`
                                : "";
            const 확인 = confirm(메시지);
            뽑기창.style.display = "none";
            if (!확인) return;


            화면잠금();
            try {
                const 응답 = await fetch("/gamble-Equipment", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: 유저데이터.유저UID, 종류 })
                });
                const 결과 = await 응답.json();
                if (!응답.ok || 결과.오류) {
                    메시지표시(등급외테두리, "", 결과.오류 || "", "");
                    return;
                }
                유저데이터 = 결과.유저데이터;
                document.getElementById("총골드").innerText = 유저데이터.골드.toLocaleString();

                const items = Array.isArray(결과.results) ? 결과.results : [결과];
                items.forEach((item, i) => {
                    setTimeout(() => {
                        const 네온박스 = document.getElementById("네온박스");

                        if (!item.장비) {
                            메시지표시(등급외테두리, item.퍼즐발동 ? 퍼즐아이콘 : "", "뽑기에 실패했습니다!", "");
                            return;
                        }
                        if (item.퍼즐발동) {
                            메시지표시(등급외테두리, 퍼즐아이콘, "", "");
                        }


                        if (네온박스) {
                            네온박스.style.display = "none";

                            if (window.네온타이머) clearTimeout(window.네온타이머);
                            네온박스.innerText = `${item.장비.이름}을(를) 획득했다!`;
                            네온박스.style.display = "block";

                            if (등급외테두리) {
                                등급외테두리.style.position = "relative";
                                등급외테두리.appendChild(네온박스);
                                Object.assign(네온박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100"
                                });
                            }
                        }
                        window.네온타이머 = setTimeout(() => {
                            네온박스.style.display = "none";
                        }, 3000);

                    }, i * 500);
                });

            } catch (e) {
                메시지표시(등급외테두리, "", "뽑기 중 오류: " + e.message, "");
            } finally {
                화면해제();
            }
        }

        async function 현질(종류 = "팔레트") {
            메시지표시(뽑기창, "", "오픈톡 '가글주인장'으로 문의하세요", "");
        }

        async function 유물뽑기시도(종류 = "일반") {
            const 뽑기창 = document.getElementById("뽑기창");
            const 비용 = 100000;
            const 유물드랍박스 = document.getElementById("유물드랍박스");
            const 유저테두리안표시 = document.getElementById("유저테두리안표시");

            if (종류 === "일반") {
                if (유저데이터.골드 < 비용) {
                    메시지표시(뽑기창, "", "골드 부족!", "");
                    return;
                }
            } else if (종류 === "연속일반") {
                if (유저데이터.골드 < 10 * 비용) {
                    메시지표시(뽑기창, "", "골드 부족!", "");
                    return;
                }
            }

            const 메시지 =
                종류 === "일반"
                    ? `유물뽑기을 ${비용.toLocaleString()} 골드로 진행하시겠습니까?`
                    : 종류 === "연속일반"
                        ? `유물뽑기 10회를 총 ${(10 * 비용).toLocaleString()} 골드로 진행하시겠습니까?`
                        : "";
            const 확인 = confirm(메시지);
            뽑기창.style.display = "none";
            if (!확인) return;

            화면잠금();
            try {
                const 응답 = await fetch("/gamble-Relic", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID,
                        종류, // 반드시 함께 전송해야 서버에서 1회/10회 구분 가능
                    }),
                });
                const 결과 = await 응답.json();

                if (!응답.ok || 결과.오류) {
                    메시지표시(유저테두리안표시, "", 결과.오류 || "", "");
                    return;
                }

                // 4) 서버가 반환한 최종 유저데이터로 업데이트
                유저데이터 = 결과.유저데이터;
                document.getElementById("총골드").innerText = 유저데이터.골드.toLocaleString();

                // 5) 결과가 여러 회차인 경우, 순차적으로 띄워줌
                const items = Array.isArray(결과.results) ? 결과.results : [결과];

                items.forEach((item, i) => {
                    setTimeout(() => {
                        // 5-1) 퍼즐 발동 시 별도 표시 (원하는 아이콘 넣어주세요)
                        if (item.퍼즐발동) {
                            메시지표시(유저테두리안표시, 퍼즐아이콘, "", "");
                        }

                        // 5-2) 유물 획득 알림
                        if (유물드랍박스) {
                            // 기존에 떠 있던 박스를 숨김
                            유물드랍박스.style.display = "none";
                            if (window.유물드랍타이머) clearTimeout(window.유물드랍타이머);

                            // 텍스트 설정
                            if (item.유물이름) {
                                유물드랍박스.innerText = `유물 [${item.유물이름}]을(를) 획득했다!`;
                            } else {
                                유물드랍박스.innerText = "뽑기에 실패했습니다!";
                            }

                            // 화면에 표시
                            유물드랍박스.style.display = "block";

                            // 위치 조정
                            if (유저테두리안표시) {
                                유저테두리안표시.style.position = "relative";
                                유저테두리안표시.appendChild(유물드랍박스);
                                Object.assign(유물드랍박스.style, {
                                    position: "absolute",
                                    top: "50%",
                                    left: "50%",
                                    transform: "translate(-50%, -50%)",
                                    zIndex: "100",
                                });
                            }

                            // 3초 후 숨김
                            window.유물드랍타이머 = setTimeout(() => {
                                유물드랍박스.style.display = "none";
                            }, 3000);
                        }
                    }, i * 500); // 회차마다 0.5초 간격으로 표시
                });
            } catch (e) {
                메시지표시(유저테두리안표시, "", "뽑기 중 오류: " + e.message, "");
            } finally {
                화면해제();
            }
        }

        document.getElementById("아래층으로").addEventListener("click", async () => {
            if (!유저데이터) return;
            if (유저데이터.현재층 <= 1) return 메시지표시(아래층으로, "", "지하로 내려갈 수 없습니다", "");

            유저데이터.현재층--;
            document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;
        });

        document.getElementById("위층으로").addEventListener("click", async () => {
            if (!유저데이터) return;

            // if (유저데이터.현재층 >= 4) {
            //     메시지표시(위층으로, 마법진아이콘, " 빛나는 마법진이 가로막습니다", "");
            //     return;
            // }

            유저데이터.현재층++;
            document.getElementById("현재층").innerText = `${유저데이터.현재층}층`;
        });



        async function 전직화면보여주기() {
            화면잠금();
            document.getElementById("화면설명").innerHTML =
                "경험치를 소모하여 전직과 직업선택이 가능합니다<br>전직을 클릭 시 직업 초기화가 가능합니다<br>";

            // 1) 서버에서 전직정보 + 경험치 가져오기
            const 응답 = await fetch("/get-job-info", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
            });
            const 결과 = await 응답.json();
            if (!응답.ok) {
                메시지표시(메시지표시박스, "", "전직정보 조회 실패: " + 결과.오류, "");
                화면해제();
                return;
            }
            const 전직정보 = 결과.전직정보;      // { "백인장":0, "오백인장":1, ... }
            let 경험치 = 결과.경험치 ?? 0;

            // 2) 서버에서 이미 선택된 계열(직업결정 JSON) 가져오기
            const 둘째응답 = await fetch("/get-job-result", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
            });
            const 둘째결과 = await 둘째응답.json();
            if (!둘째응답.ok) {
                메시지표시(메시지표시박스, "", "전직 결과 조회 실패: " + 둘째결과.오류, "");
                화면해제();
                return;
            }
            // 직업결정 컬럼 형식: null 또는 { "마술": 1 }, { "궁술": 2 } 등
            const 직업결정JSON = 둘째결과.직업결정 || null;

            // 3) 완료된 킹덤 전직 개수 계산
            const 전직순서 = [
                "백인장", "오백인장", "천인장", "만인장", "부장군", "장군",
                "대장군", "대사마", "승상", "후", "공", "제후",
                "왕", "황제", "천황", "제황", "태황", "천제"
            ];
            let 완료개수 = 0;
            for (const 직위 of 전직순서) {
                if (전직정보[직위] === 1) 완료개수++;
                else break;
            }
            // 완료개수: 0~18

            // 4) 컨테이너 비우기
            const container = document.getElementById("전직컨테이너");
            document.querySelectorAll(".전직항목").forEach(e => e.remove());

            // 5) “경험치와포인트” 영역 업데이트
            const 경험치div = document.getElementById("경험치와포인트");
            경험치div.innerHTML = `
        <div>경험치</div>
        <div>${경험치.toLocaleString()} 포인트</div>
    `;

            // 6) 킹덤 전직(왕위)의 최상위 다음 후보 표시
            if (완료개수 < 전직순서.length) {
                const 다음킹덤 = 전직순서[완료개수];
                const div = document.createElement("div");
                div.className = "사백픽셀테두리 양쪽정렬 전직항목";
                div.style.marginTop = "5px";

                const 왼쪽 = document.createElement("div");
                왼쪽.style.display = "flex";
                왼쪽.style.flexDirection = "column";
                왼쪽.style.fontWeight = "bold";

                const 직위텍스트 = document.createElement("div");
                직위텍스트.textContent = 다음킹덤;

                const 효과텍스트 = document.createElement("div");
                효과텍스트.textContent = `최종공격력 x${(1.1 + 완료개수 * 0.1).toFixed(1)}`;
                효과텍스트.style.fontSize = "12px";
                효과텍스트.style.color = "gray";
                효과텍스트.style.marginTop = "3px";

                왼쪽.appendChild(직위텍스트);
                왼쪽.appendChild(효과텍스트);

                const 오른쪽 = document.createElement("div");
                오른쪽.style.borderRadius = "7px";
                오른쪽.style.padding = "7px 10px";
                오른쪽.style.fontSize = "13px";
                const 비용 = (완료개수 + 1) * 50000;
                오른쪽.textContent = `전직(${비용.toLocaleString()}p)`;
                오른쪽.style.backgroundColor = "white";
                오른쪽.style.color = "black";
                오른쪽.style.cursor = "pointer";
                오른쪽.onclick = () => {
                    전직하기(다음킹덤, 왼쪽);
                };

                div.appendChild(왼쪽);
                div.appendChild(오른쪽);
                container.appendChild(div);
            }

            // 7) 각 계열별 직업 목록 및 설명 정의
            const 검술 = ["나이트", "글라디에이터", "엠퍼러", "로열가드", "그랑스워드", "카이저"];
            const 검술설명 = [
                "추가공격(1~4회) 확률 10%",
                "추가공격(1~4회) 확률 20%",
                "추가공격(1~4회) 확률 30%",
                "추가공격(1~4회) 확률 40%",
                "추가공격(1~4회) 확률 50%",
                "추가공격(1~4회) 확률 100%"
            ];

            const 마술 = ["매지션", "워록", "아크메이지", "소서러", "그랑에이지", "자베러"];
            const 마술설명 = [
                "추가데미지 20%",
                "추가데미지 40%",
                "추가데미지 60%",
                "추가데미지 80%",
                "추가데미지 100%",
                "추가데미지 200%"
            ];

            const 신술 = ["클레릭", "프리스트", "비숍", "프린세스", "그랑세이지", "퀸"];
            const 신술설명 = [
                "턴당체력회복 확률 10%",
                "턴당체력회복 확률 20%",
                "턴당체력회복 확률 30%",
                "턴당체력회복 확률 40%",
                "턴당체력회복 확률 50%",
                "턴당체력회복 확률 75%"
            ];

            const 궁술 = ["스나이퍼", "레인저", "헌터", "하이랜더", "그랑아처", "제너럴"];
            const 궁술설명 = [
                "15% 방어력 무시",
                "30% 방어력 무시",
                "45% 방어력 무시",
                "60% 방어력 무시",
                "75% 방어력 무시",
                "99% 방어력 무시"
            ];

            // helper: 한 개의 직업 항목을 만들어 container에 추가 (비용 매개변수 추가)
            function 직업항목추가(직업명, 설명, 비용, onClickFn) {
                const div = document.createElement("div");
                div.className = "사백픽셀테두리 양쪽정렬 전직항목";
                div.style.marginTop = "5px";

                const 왼쪽 = document.createElement("div");
                왼쪽.style.display = "flex";
                왼쪽.style.flexDirection = "column";
                왼쪽.style.fontWeight = "bold";

                const 이름텍스트 = document.createElement("div");
                이름텍스트.textContent = 직업명;

                const 설명텍스트 = document.createElement("div");
                설명텍스트.textContent = 설명;
                설명텍스트.style.fontSize = "12px";
                설명텍스트.style.color = "gray";
                설명텍스트.style.marginTop = "3px";

                왼쪽.appendChild(이름텍스트);
                왼쪽.appendChild(설명텍스트);

                const 오른쪽 = document.createElement("div");
                오른쪽.style.borderRadius = "7px";
                오른쪽.style.padding = "7px 10px";
                오른쪽.style.fontSize = "13px";
                오른쪽.textContent = `선택(${비용.toLocaleString()}p)`;
                오른쪽.style.backgroundColor = "white";
                오른쪽.style.color = "black";
                오른쪽.style.cursor = "pointer";
                오른쪽.onclick = onClickFn;

                div.appendChild(왼쪽);
                div.appendChild(오른쪽);
                container.appendChild(div);
            }

            // a) 킹덤 완료개수 < 3: 계열 직업 노출 없음
            if (완료개수 < 3) {
                화면해제();
                return;
            }

            // b) 직업결정이 아직 없는 상태 → 1차 직업을 “[계열] 직업명” 형태로 노출
            if (!직업결정JSON) {
                if (완료개수 >= 3) {
                    const cost1 = 150000;
                    직업항목추가(
                        `[검술] ${검술[0]}`,  // ← “[검술] 나이트”
                        검술설명[0],
                        cost1,
                        () => 계열선택("검술")
                    );
                    직업항목추가(
                        `[마술] ${마술[0]}`,  // ← “[마술] 매지션”
                        마술설명[0],
                        cost1,
                        () => 계열선택("마술")
                    );
                    직업항목추가(
                        `[신술] ${신술[0]}`,  // ← “[신술] 클레릭”
                        신술설명[0],
                        cost1,
                        () => 계열선택("신술")
                    );
                    직업항목추가(
                        `[궁술] ${궁술[0]}`,  // ← “[궁술] 스나이퍼”
                        궁술설명[0],
                        cost1,
                        () => 계열선택("궁술")
                    );
                }
                화면해제();
                return;
            }

            // c) 직업결정JSON이 존재하는 상태 → 계열 + 단계 정보 파싱
            const 선택계열 = Object.keys(직업결정JSON)[0];   // ex) "마술"
            const 선택단계 = 직업결정JSON[선택계열];           // ex) 1

            // 계열별 목록과 설명을 결정
            let 계열목록, 계열설명;
            if (선택계열 === "검술") {
                계열목록 = 검술;
                계열설명 = 검술설명;
            } else if (선택계열 === "마술") {
                계열목록 = 마술;
                계열설명 = 마술설명;
            } else if (선택계열 === "신술") {
                계열목록 = 신술;
                계열설명 = 신술설명;
            } else {
                계열목록 = 궁술;
                계열설명 = 궁술설명;
            }

            // 다음 단계 인덱스 (0-based)
            const 다음Idx = 선택단계; // 예: 선택단계=1 이면 다음Idx=1

            if (다음Idx < 계열목록.length) {
                // → “[마술] 워록” 식으로 표시
                const 다음직업명 = `[${선택계열}] ${계열목록[다음Idx]}`;
                const 다음설명 = 계열설명[다음Idx];

                // 필요한 킹덤 전직 완료 단계: (다음Idx + 1) * 3
                const 필요한단계 = (다음Idx + 1) * 3;

                // 경험치 비용 계산 (단계 1: 100,000p, 단계 2: 200,000p, …)
                const cost = (다음Idx + 1) * 150000;

                const 클릭함수 = () => {
                    if (완료개수 < 필요한단계) {
                        메시지표시(
                            메시지표시박스,
                            "",
                            `${전직순서[필요한단계 - 1]} 전직 완료 시 선택할 수 있습니다.`,
                            ""
                        );
                        return;
                    }
                    계열선택(선택계열);
                };

                직업항목추가(다음직업명, 다음설명, cost, 클릭함수);
            }

            화면해제();
        }




        async function 계열선택(계열) {
            화면잠금();
            try {
                // 서버에 선택된 계열을 저장
                const 응답 = await fetch("/set-job-result", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저UID: 유저데이터.유저UID,
                        계열선택: 계열  // ex) "궁술"
                    })
                });

                const 결과 = await 응답.json();
                if (!응답.ok) {
                    // 오류가 있을 때 메시지 표시하고 화면 해제
                    메시지표시(메시지표시박스, "", (결과.오류 || "알 수 없는 오류"), "");
                    화면해제();
                    return;
                }

                // 저장이 완료되었으면 전직화면을 다시 그리기
                await 전직화면보여주기();
            } catch (e) {
                메시지표시(메시지표시박스, "", "서버 오류 발생", "");
            } finally {
                화면해제();
            }
        }



        async function 전직하기(직위, 위치참조) {
            화면잠금();

            const 응답 = await fetch("/promote-job", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    유저UID: 유저데이터.유저UID,
                    직위: 직위
                })
            });

            const 결과 = await 응답.json();

            if (!응답.ok) {
                메시지표시(메시지표시박스, "", "전직 실패: " + 결과.오류, "");
                화면해제();
                return;
            }
            유저데이터.레벨 = 결과.레벨;
            유저데이터.경험치 = 결과.경험치;
            유저데이터.최종공격력 = 결과.최종공격력;

            // 성공하면 화면 갱신
            메시지표시(메시지표시박스, "", 직위 + " 전직 성공!", "");
            전직화면보여주기();
        }

        const 일반유물데이터 = {
            "소드": { 설명: "공격력이 증가합니다(*1%)" },
            "하트플러스": { 설명: "체력이 증가합니다(*1%)" },
            "고스트": { 설명: "히든몬스터 등장률이 증가합니다(*1%)" },
            "쉴드밴": { 설명: "악마들의 방어력을 감소시킵니다(*1%)" },
            "하트마이너스": { 설명: "악마들의 체력을 감소시킵니다(*0.1%)" },
            "클로버": { 설명: "장비 뽑기확률이 증가합니다(*0.1%)" },
            "모래시계": { 설명: "스태미너 소모를 무시합니다(0.1%)" },
            "암포라": { 설명: "보스전 스태미너 소모량을 감소시킵니다(1%)" },
            "퍼즐": { 설명: "뽑기비용을 무시합니다(0.1%)" },
        };
        const 레어유물데이터 = {
            "소드": { 설명: "공격력이 증가합니다(*1%)" },
            "하트플러스": { 설명: "체력이 증가합니다(*1%)" },
            "고스트": { 설명: "히든몬스터 등장률이 증가합니다(*1%)" },
            "쉴드밴": { 설명: "악마들의 방어력을 감소시킵니다(*1%)" },
            "하트마이너스": { 설명: "악마들의 체력을 감소시킵니다(*0.1%)" },
            "클로버": { 설명: "장비 뽑기확률이 증가합니다(*0.1%)" },
            "모래시계": { 설명: "스태미너 소모를 무시합니다(0.1%)" },
            "암포라": { 설명: "보스전 스태미너 소모량을 감소시킵니다(1%)" },
            "퍼즐": { 설명: "뽑기비용을 무시합니다(0.1%)" },
            "플라워": { 설명: "스킬을 초기화합니다" },
            "뼈다구": { 설명: "직업을 초기화합니다" },
            "티켓": { 설명: "고급장비뽑기에 사용됩니다" },
            "샐러드": { 설명: "스태미너를 충전합니다(+60)" },
        };
        const 신화유물데이터 = {
            "소드": { 설명: "공격력이 증가합니다(*1%)" },
            "하트플러스": { 설명: "체력이 증가합니다(*1%)" },
            "고스트": { 설명: "히든몬스터 등장률이 증가합니다(*1%)" },
            "쉴드밴": { 설명: "악마들의 방어력을 감소시킵니다(*1%)" },
            "하트마이너스": { 설명: "악마들의 체력을 감소시킵니다(*0.1%)" },
            "클로버": { 설명: "장비 뽑기확률이 증가합니다(*0.1%)" },
            "모래시계": { 설명: "스태미너 소모를 무시합니다(0.1%)" },
            "암포라": { 설명: "보스전 스태미너 소모량을 감소시킵니다(1%)" },
            "퍼즐": { 설명: "뽑기비용을 무시합니다(0.1%)" },
            "플라워": { 설명: "스킬을 초기화합니다" },
            "뼈다구": { 설명: "직업을 초기화합니다" },
            "티켓": { 설명: "고급장비뽑기에 사용됩니다" },
            "샐러드": { 설명: "스태미너를 충전합니다(+60)" },
            "마법의팔레트": { 설명: "아이디를 염색합니다" },
            "햄버거": { 설명: "스태미너를 충전합니다(+300)" },
        };

        document.addEventListener("DOMContentLoaded", async () => {
            const { data: { user }, error: 인증오류 } = await supabase.auth.getUser();

            if (인증오류) {
                return;
            }

            if (user && user.id) {
                try {
                    const 응답 = await fetch("/get-user", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ 유저UID: user.id })
                    });
                    const 결과 = await 응답.json();
                    const 유저정보 = 결과.유저데이터;

                    if (결과.새로고침하자 == true) {
                        location.reload();
                    }

                    // if (!유저정보 || 유저정보.버전업 !== 7) {
                    //     await fetch("/delete-user", {
                    //         method: "POST",
                    //         headers: { "Content-Type": "application/json" },
                    //         body: JSON.stringify({ 유저UID: user.id })
                    //     });

                    //     await supabase.auth.signOut();
                    //     alert("드락실 벨고르 마하 투라크... 에이라스 노 크살. 메테오!");
                    //     location.reload();
                    //     alert("메테오를 맞고 새로 태어납니다.");
                    //     return;
                    // }

                    유저데이터 = 유저정보;
                    메시지표시(메시지표시박스, "", "자동로그인 완료", "#00c851");

                    if (유저데이터.펫단계 >= 1) {
                        let 색상코드;
                        if (유저데이터.펫단계 === 1) 색상코드 = "#cd7f32"; // 동색
                        else if (유저데이터.펫단계 === 2) 색상코드 = "#c0c0c0"; // 은색
                        else 색상코드 = "#ffd700"; // 금색


                        const 보스이름목록 = ["미노타우르스", "락골렘", "가고일", "그루트", "와이번", "아이스골렘"];
                        const 보스번호 = ((유저데이터.보스넘버 ?? 0)) % 6;
                        const 펫번호 = ((유저데이터.보스넘버 ?? 0) - 1 + 6) % 6;
                        현재보스이름 = 보스이름목록[보스번호];
                        const 펫아이콘 = 보스아이콘목록[펫번호] || 그루트아이콘;
                        펫보여주기(펫아이콘, 색상코드);
                    }

                    try {
                        const 응답 = await fetch("/refresh-stamina", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ 유저UID: 유저정보.유저UID })
                        });

                        const 결과 = await 응답.json();
                        if (응답.ok && 결과.유저데이터) {
                            유저정보.현재스태미너 = 결과.유저데이터.현재스태미너;
                        }
                    } catch (e) {
                        console.warn("스태미너 갱신 실패", e);
                    }

                    전투화면보여주기(유저데이터);
                    document.getElementById("메뉴얼").click();

                } catch (e) {
                    메시지표시(메시지표시박스, "", "자동 로그인 오류: " + e.message, "");
                }
            } else {
                메시지표시(메시지표시박스, "", "로그인된 유저 없음", "");
            }

        });



        function 모든화면숨기기() {
            const 화면ID들 = [
                "전투화면", "장비화면", "스킬화면", "전당화면", "인증화면",
                "유물화면", "전직화면", "보스화면", "에너지박스",
                "메뉴얼화면", "내정보화면", "캐시샵화면", "지하던전화면",
            ];
            화면ID들.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = "none";
            });
        }

        const 정보버튼 = document.getElementById("정보");

        const 정보툴팁 = document.createElement("div");
        정보툴팁.id = "정보툴팁";
        정보툴팁.style.position = "absolute";
        정보툴팁.style.zIndex = "99999";
        정보툴팁.style.display = "flex";
        정보툴팁.style.flexDirection = "column";
        정보툴팁.style.gap = "4px";
        정보툴팁.style.background = "black";
        정보툴팁.style.width = "fit-content";
        정보툴팁.style.border = "0.2px solid #4b4b4b";
        정보툴팁.style.borderRadius = "10px";
        정보툴팁.style.boxSizing = "border-box";
        정보툴팁.style.padding = "5px";

        정보툴팁.innerHTML = `
  <div style="display: flex; flex-direction: column; gap: 10px;">    
    <div class="버튼" id="내정보">내정보</div>
    <div class="버튼" id="메뉴얼">메뉴얼</div>
    <div class="버튼" id="캐시샵">캐시샵</div>
  </div>
`;
        // <div class="버튼" id="탈퇴" onclick="회원탈퇴()">탈퇴</div>

        정보툴팁.style.display = "none";
        document.body.appendChild(정보툴팁);

        정보버튼.addEventListener("mouseenter", () => {
            const rect = 정보버튼.getBoundingClientRect();

            // 먼저 보여줘야 offsetWidth를 읽을 수 있음
            정보툴팁.style.display = "block";

            const 툴팁너비 = 정보툴팁.offsetWidth;
            정보툴팁.style.left = (rect.right - 툴팁너비) + "px";
            정보툴팁.style.top = rect.bottom + "px";
        });


        // 마우스가 정보버튼과 정보툴팁 외부로 나가면 닫기
        document.addEventListener("mouseover", (e) => {
            if (
                !정보툴팁.contains(e.target) &&
                !정보버튼.contains(e.target)
            ) {
                정보툴팁.style.display = "none";
            }
        });




        const 월드버튼 = document.getElementById("월드");

        const 월드툴팁 = document.createElement("div");
        월드툴팁.id = "월드툴팁";
        월드툴팁.style.position = "absolute";
        월드툴팁.style.zIndex = "99999";
        월드툴팁.style.display = "flex";
        월드툴팁.style.flexDirection = "column";
        월드툴팁.style.gap = "4px";
        월드툴팁.style.background = "black";
        월드툴팁.style.width = "fit-content";
        월드툴팁.style.border = "0.2px solid #4b4b4b";
        월드툴팁.style.borderRadius = "10px";
        월드툴팁.style.boxSizing = "border-box";
        월드툴팁.style.padding = "5px";

        월드툴팁.innerHTML = `
  <div style="display: flex; flex-direction: column; gap: 10px;">    
    <div class="버튼" id="보스">보스</div>
    <div class="버튼" id="지하던전">지하던전</div>
  </div>
`;

        월드툴팁.style.display = "none";
        document.body.appendChild(월드툴팁);

        월드버튼.addEventListener("mouseenter", () => {
            const rect = 월드버튼.getBoundingClientRect();

            // 먼저 보여줘야 offsetWidth를 읽을 수 있음
            월드툴팁.style.display = "block";

            const 툴팁너비 = 월드툴팁.offsetWidth;
            월드툴팁.style.left = (rect.right - 툴팁너비) + "px";
            월드툴팁.style.top = rect.bottom + "px";
        });


        // 마우스가 월드버튼 월드툴팁 외부로 나가면 닫기
        document.addEventListener("mouseover", (e) => {
            if (
                !월드툴팁.contains(e.target) &&
                !월드버튼.contains(e.target)
            ) {
                월드툴팁.style.display = "none";
            }
        });







        function 한줄에두칸(왼쪽, 오른쪽) {
            const row = document.createElement("div");
            row.style.display = "flex";
            row.style.width = "100%";
            row.style.gap = "10px";

            const left = document.createElement("div");
            left.id = 왼쪽;
            left.style.textAlign = "left";
            left.style.flex = "1";

            const right = document.createElement("div");
            right.id = 오른쪽;
            right.style.textAlign = "left";
            right.style.flex = "1";

            row.appendChild(left);
            row.appendChild(right);
            return row;
        }

        // 2) 3칸짜리 행(Row)을 생성해서 반환합니다.
        //    칸: [id1, id2, id3] 형태로 세 개 요소의 id를 전달
        //    클레스네임: 각 칸(div)에 적용할 공통 클래스 이름 (예: "기본테두리")
        function 한줄에세칸(칸, 클레스네임) {
            const row = document.createElement("div");
            row.style.display = "flex";
            row.style.width = "100%";
            row.style.gap = "10px";
            row.style.justifyContent = "center"; // 필요에 따라 가운데 정렬

            칸.forEach(id => {
                const div = document.createElement("div");
                div.id = id;
                if (클레스네임) div.className = 클레스네임;
                div.style.flex = "1";
                div.style.textAlign = "center"; // 칸 내부 텍스트 가운데 정렬
                row.appendChild(div);
            });

            return row;
        }





        document.getElementById("내정보").addEventListener("click", async () => {
            if (!유저데이터) return;
            화면잠금();
            document.getElementById("화면설명").innerHTML = "새로고침(F5)을 생활화하세요";

            모든화면숨기기();
            document.getElementById("내정보화면").style.display = "block";

            const 컨테이너 = document.getElementById("내정보컨테이너");
            컨테이너.innerHTML = "";

            // ─── 첫째줄부터 넷째줄까지 2칸짜리 행 생성 ───
            const 첫째줄행 = 한줄에두칸("첫째줄왼쪽", "첫째줄오른쪽");
            const 둘째줄행 = 한줄에두칸("둘째줄왼쪽", "둘째줄오른쪽");
            const 셋째줄행 = 한줄에두칸("셋째줄왼쪽", "셋째줄오른쪽");
            const 넷째줄행 = 한줄에두칸("넷째줄왼쪽", "넷째줄오른쪽");
            const 다섯째줄행 = 한줄에두칸("다섯째줄왼쪽", "다섯째줄오른쪽");
            const 여섯째줄행 = 한줄에두칸("여섯째줄왼쪽", "여섯째줄오른쪽");

            // ─── 다섯째줄(=열째줄) 3칸짜리 행 생성 ───
            const 열째줄행 = 한줄에세칸(
                ["열째줄왼쪽", "열째줄가운데", "열째줄오른쪽"],
                "기본테두리"
            );

            const 열한째줄행 = 한줄에세칸(
                ["열한째줄왼쪽", "열한째줄가운데", "열한째줄오른쪽"],
                ""
            );

            // ─── 컨테이너에 차례대로 붙이기 ───
            컨테이너.appendChild(첫째줄행);
            컨테이너.appendChild(둘째줄행);
            컨테이너.appendChild(셋째줄행);
            컨테이너.appendChild(넷째줄행);
            컨테이너.appendChild(다섯째줄행);
            컨테이너.appendChild(여섯째줄행);
            컨테이너.appendChild(열째줄행);
            컨테이너.appendChild(열한째줄행);


            // ─── (2) 서버에서 “전당” 순위만 가져오기 ───
            try {
                const 랭킹응답 = await fetch("/ranking", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                });
                const 랭킹결과 = await 랭킹응답.json();

                // 서버에서 받은 랭킹결과는 { 유저들: [...] } 구조
                const 유저들 = 랭킹결과.유저들 || [];

                // 배열에서 “내 유저UID”와 같은 요소의 인덱스를 찾는다
                const 내인덱스 = 유저들.findIndex(
                    (u) => u.유저UID === 유저데이터.유저UID
                );

                // 인덱스가 -1이 아니면 “인덱스 + 1”이 내 순위
                const 내전당순위 = 내인덱스 >= 0 ? 내인덱스 + 1 : "-";
                document.getElementById("넷째줄왼쪽").innerHTML = `전당 : ${내전당순위}위`;
            } catch (err) {
                document.getElementById("넷째줄왼쪽").innerHTML = `전당 : 조회실패`;
                console.error("전당순위 조회 실패:", err);
            }

            // ─── (3) 서버에서 “보스” 순위만 가져오기 ───
            try {
                const 보스응답 = await fetch("/boss-ranking", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
                });
                const 보스결과 = await 보스응답.json();

                // /boss-ranking 응답 예시: { 순위: [...], 누적데미지총합: n, 내정보: { 순위, 유저아이디, 보스누적데미지 } }
                // 내 순위 정보는 보스결과.내정보.순위 필드에 들어 있다.
                const 내보스순위 =
                    보스결과.내정보 && typeof 보스결과.내정보.순위 === "number"
                        ? 보스결과.내정보.순위
                        : "-";

                document.getElementById("다섯째줄왼쪽").innerHTML = `보스 : ${내보스순위}위`;
            } catch (err) {
                document.getElementById("다섯째줄왼쪽").innerHTML = `보스 : 조회실패`;
                console.error("보스순위 조회 실패:", err);
            }

            // ─── 내용 채우기 ───
            document.getElementById("첫째줄왼쪽").innerHTML = `아이디 : ${유저데이터.유저아이디}`;
            document.getElementById("둘째줄왼쪽").innerHTML = `공격력 : ${유저데이터.최종공격력}`;
            document.getElementById("셋째줄왼쪽").innerHTML = `최대체력 : ${유저데이터.최대체력}`;
            // document.getElementById("넷째줄왼쪽").innerHTML = `전당 : 위`;
            // document.getElementById("다섯째줄왼쪽").innerHTML = `보스 : 위`;

            // document.getElementById("첫째줄오른쪽").innerHTML = `탈퇴`;
            // <div class="버튼" id="탈퇴" onclick="회원탈퇴()">탈퇴</div>
            document.getElementById("열한째줄가운데").innerHTML =
                `<div style="margin-top: 20px; cursor: pointer;" id="탈퇴" onclick="회원탈퇴()">{ 계 정 탈 퇴 }</div>`;

            document.getElementById("둘째줄오른쪽").innerHTML = (유저데이터.현질기한 !== undefined && 유저데이터.현질기한 !== 0) ? `마법의팔레트 : ${유저데이터.현질기한}/30` : `마법의팔레트 : -`;
            document.getElementById("셋째줄오른쪽").innerHTML = (유저데이터.햄버거현질기한 !== undefined && 유저데이터.햄버거현질기한 !== 0) ? `햄버거정기배송 : ${유저데이터.햄버거현질기한}/30` : `햄버거정기배송 : -`;
            document.getElementById("넷째줄오른쪽").innerHTML = 유저데이터.생성일 ? `생성일 : ${유저데이터.생성일}` : `생성일 : -`;
            document.getElementById("다섯째줄오른쪽").innerHTML = (유저데이터.스태미너소모총량 !== undefined && 유저데이터.스태미너소모총량 !== 0) ? `전적 : ${유저데이터.스태미너소모총량}전` : `전적 : -`;

            // 1) 각 계열별 직업 배열을 미리 정의해 둡니다.
            const 검술 = ["나이트", "글라디에이터", "엠퍼러", "로열가드", "그랑스워드", "카이저"];
            const 마술 = ["매지션", "워록", "아크메이지", "소서러", "그랑에이지", "자베러"];
            const 신술 = ["클레릭", "프리스트", "비숍", "프린세스", "그랑세이지", "퀸"];
            const 궁술 = ["스나이퍼", "레인저", "헌터", "하이랜더", "그랑아처", "제너럴"];

            // … (유저데이터.직업결정은 { "신술": 6 } 같은 객체 형태로 들어있다고 가정)

            const 결정객체 = 유저데이터.직업결정;  // 예: { "신술": 6 }
            if (결정객체) {
                // 첫 번째(유일한) 키만 꺼냅니다. → "신술"
                const 계열키 = Object.keys(결정객체)[0];
                // 해당 키의 값(단계)을 꺼냅니다. → 6
                const 단계 = 결정객체[계열키];

                // 단계(숫자)에 해당하는 실제 직업명을 찾아서 변수에 저장
                let 직업이름;
                if (계열키 === "검술") {
                    직업이름 = 검술[단계 - 1];   // 예: 단계=1 → 검술[0] = "나이트"
                } else if (계열키 === "마술") {
                    직업이름 = 마술[단계 - 1];
                } else if (계열키 === "신술") {
                    직업이름 = 신술[단계 - 1];   // 단계=6 → 신술[5] = "퀸"
                } else if (계열키 === "궁술") {
                    직업이름 = 궁술[단계 - 1];
                } else {
                    직업이름 = "-";
                }

                // 화면에 “신술(퀸)” 형태로 표시
                document.getElementById("여섯째줄왼쪽").innerHTML = `직업 : [${계열키}] ${직업이름}`;
            } else {
                // 아직 선택된 직업이 없으면 ‘-’만 표시
                document.getElementById("여섯째줄왼쪽").innerHTML = "직업 : -";
            }


            const 목록 = 유저데이터.장비목록;
            let bestWeapon = null;
            if (Array.isArray(목록) && 목록.length) {
                bestWeapon = 목록.reduce((prev, cur) =>
                    Number(cur.공격력) > Number(prev.공격력) ? cur : prev
                );
            }

            const 장비박스1 = document.getElementById("열째줄왼쪽");

            if (bestWeapon) {
                // 강화 수치 표시 문자열 생성
                const 강화표시 = bestWeapon.강화 ? ` +${bestWeapon.강화}` : "";
                // 예: "루시퍼의 심장 +3" (강화가 0이면 이름만)
                장비박스1.innerText = `${bestWeapon.이름}${강화표시}`;
                장비박스1.style.color = 색상맵[bestWeapon.등급] || "#fff";
            } else {
                장비박스1.innerText = "장비가 없습니다";
                장비박스1.style.color = "#fff";
            }

            // 필요하다면 두 번째·세 번째 박스에도 같은 방식으로 내용 채우기
            const 장비박스2 = document.getElementById("열째줄가운데");
            장비박스2.innerHTML = "가장쎈방어구";
            const 장비박스3 = document.getElementById("열째줄오른쪽");
            장비박스3.innerHTML = "가장쎈장신구";

            화면해제();
        });




        document.getElementById("지하던전").addEventListener("click", async () => {
            if (!유저데이터) return;
            화면잠금();

            // document.getElementById("화면설명").innerHTML = "강함을 증명하세요<br>층당 티켓 한장이 보상으로 지급됩니다";
            document.getElementById("화면설명").innerHTML = "구현중입니다";
            모든화면숨기기();
            document.getElementById("지하던전화면").style.display = "block";
            document.getElementById("에너지박스").style.display = "block";

            // const 컨테이너 = document.getElementById("지하던전컨테이너");
            // 컨테이너.innerHTML = "";

            const 아이콘컨테이너 = document.getElementById("던전아이콘");
            아이콘컨테이너.innerHTML = 던전아이콘;

            const level = 유저데이터.지하던전;
            document.getElementById("지하층수").innerText = `지하${level}층`;
            document.getElementById("지하승패").innerText = "";

            화면해제();
        });

        //         document.getElementById("지하층수").addEventListener("click", async () => {
        //             if (!유저데이터) return;
        //             화면잠금();

        //             const res = await fetch("/attack-dungeon", {
        //                 method: "POST",
        //                 headers: { "Content-Type": "application/json" },
        //                 body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
        //             });
        //             const data = await res.json();

        //             // 승패 표시
        //             document.getElementById("지하승패").innerText = data.결과;

        //             // 다음 층수 표시
        //             document.getElementById("지하층수").innerText = `지하${data.새로운레벨}층`;
        //             유저데이터.지하던전 = data.새로운레벨;
        //             유저데이터.유물목록 = data.유물목록;

        //             // 티켓 드랍 효과
        //             if (data.드랍티켓) {
        //                 const 유물드랍박스 = document.getElementById("유물드랍박스");
        //                 const 던전아이콘 = document.getElementById("던전아이콘");

        //                 if (유물드랍박스) {
        //                     // ✅ 먼저 기존에 떠 있는 박스를 숨김
        //                     유물드랍박스.style.display = "none";

        //                     // ✅ setTimeout 제거 방지: 이전 타이머 클리어 (선택 사항)
        //                     if (window.유물드랍타이머) clearTimeout(window.유물드랍타이머);

        //                     유물드랍박스.innerText = `유물 [티켓]을(를) 획득했다!`;
        //                     유물드랍박스.style.display = "block";

        //                     // 위치 조정용 부모 변경
        //                     if (던전아이콘) {
        //                         // 등급외테두리에 위치 기준 설정
        //                         던전아이콘.style.position = "relative";

        //                         // 유물드랍박스를 등급외테두리 내부로 이동
        //                         던전아이콘.appendChild(유물드랍박스);

        //                         // 전투화면용 위치 조정
        //                         Object.assign(유물드랍박스.style, {
        //                             position: "absolute",
        //                             top: "50%",
        //                             left: "50%",
        //                             transform: "translate(-50%, -50%)",
        //                             zIndex: "100"
        //                         });
        //                     }
        //                 }
        //                 // ✅ 새 타이머로 숨김 처리 (전역 변수로 저장)
        //                 window.유물드랍타이머 = setTimeout(() => {
        //                     유물드랍박스.style.display = "none";
        //                 }, 3000);
        //             }

        //             // 기존 전투 로그 삭제
        //             const 기존로그들 = document.querySelectorAll(".전투로그컨테이너");
        //             기존로그들.forEach(e => e.remove());

        //             // 새로운 로그 생성
        //             if (data.전투로그 && Array.isArray(data.전투로그)) {
        //                 data.전투로그.slice().reverse().forEach(로그 => {
        //                     const 로그컨테이너 = document.createElement("div");
        //                     로그컨테이너.className = "전투로그컨테이너";
        //                     로그컨테이너.style.marginTop = "15px";
        //                     로그컨테이너.style.border = "0.2px solid #4b4b4b";
        //                     로그컨테이너.style.borderRadius = "10px";
        //                     로그컨테이너.style.padding = "15px";

        //                     const 아이콘HTML = (로그.아이콘 || []).map(이름 => 아이콘맵[이름] || "").join(" ");

        //                     // 회복 로그는 데미지 표시 안 함
        //                     let 데미지텍스트 = "";
        //                     let 회복텍스트 = "";

        //                     if (로그.타입 === "공격") {
        //                         데미지텍스트 = `<span><span style="color: #f63b3b;">${로그.몬스터이름}</span>에게 ${로그.효과} 피해를 입혔다!</span>`;
        //                     } else if (로그.타입 === "회복") {
        //                         회복텍스트 = `<span><span style="color: #3b82f6;">${로그.유저아이디}</span> 체력 ${로그.효과} 회복</span>`;
        //                     }

        //                     let 추가횟수표시 = "";
        //                     if (로그.타입 === "공격" && 로그.추가공격횟수 > 0) {
        //                         // 실제 타격 횟수 = 1(기본) + 로그.추가공격횟수
        //                         const 총공격횟수 = 1 + 로그.추가공격횟수;
        //                         추가횟수표시 = `<span style="margin-left: 4px; color: #f63b3b;">x${총공격횟수}</span>`;
        //                     }

        //                     // (2) innerHTML에서 공격 텍스트 뒤에 추가횟수표시 붙이기
        //                     로그컨테이너.innerHTML = `
        //     <div style="background: #4b4b4b; width: calc(100% + 30px); margin: -15px 0 0 -15px; padding: 6px 0; text-align: center; border-top-left-radius: 10px; border-top-right-radius: 10px;">
        //         <strong>Turn ${로그.턴}</strong>
        //     </div>
        //     <div class="가로정렬" style="margin: 4px 0; align-items: center; gap: 6px;">
        //         ${아이콘HTML}
        //         ${로그.타입 === "공격" ? 데미지텍스트 + 추가횟수표시 : ""}
        //         ${로그.타입 === "회복" ? 회복텍스트 : ""}
        //     </div>
        // <!-- 유저와 몬스터 정보 양쪽 정렬 -->
        // <div class="가로정렬" style="margin-top: 10px; justify-content: space-between; align-items: center; gap: 12px;">
        //     <div style="border: 0.2px solid #3b82f6; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        //         <div>${로그.유저아이디}</div>
        //         <div>
        //             <div>공격력 ${로그.유저최종공격력}</div>
        //             <div>체력 ${로그.유저체력}/${로그.유저최대체력}</div>
        //         </div>
        //     </div>

        //     <div style="border: 0.2px solid #f63b3b; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
        //         <div>${로그.몬스터이름}</div>
        //         <div>
        //             <div>체력 ${Math.max(0, 로그.몬스터체력)}/${로그.몬스터최대체력}</div>
        //             <div>방어력 ${로그.몬스터방어력}</div>
        //         </div>
        //     </div>
        // </div>
        //         `;

        //                     const 타겟 = document.getElementById("지하등반");
        //                     if (타겟 && 타겟.parentNode) {
        //                         타겟.parentNode.insertBefore(로그컨테이너, 타겟.nextSibling);
        //                     }
        //                 });
        //             }
        //             화면해제();
        //         });


        // git add . && git commit -m "fix: gagl.html serving enabled" && git push origin main
        // npm install -g nodemon
        // nodemon index.js


        document.getElementById("메뉴얼").addEventListener("click", () => {
            if (!유저데이터) return;
            document.getElementById("화면설명").innerHTML = "오늘도, 행복하세요";

            모든화면숨기기();
            document.getElementById("메뉴얼화면").style.display = "block";

            const 컨테이너 = document.getElementById("메뉴얼컨테이너");
            컨테이너.innerHTML = "";

            const 문장들 = [
                `${여름아이콘}`,
                `
1. '전투'를 클릭해서 전투화면으로 진입 후 100만골드를 클릭<br>
2. 연속일반장비 뽑기를 통해 [태초] 사탄의 날개를 뽑으세요<br>
3. 사탄의 날개가 나오지 않았다면 '정보'-'내정보'<br>
4. 계정탈퇴 후 재가입하세요<br>
5. 사탄의 날개가 등장할때까지 1,2,3,4를 반복하세요<br>
6. 전투화면에서 악마성을 클릭하세요<br>
6-1. 층수를 올려서 2층을 사냥해보세요<br>
7. 반자동 버튼을 클릭해서 자동공격을 경험해보세요<br>
8. 레어몬스터를 우선공격하는 풀자동 공격을 경험해보세요<br>
9. 숙련도 500을 모았다면 전투화면에서 숙련도를 클릭하세요<br>
10. 스킬창에서 숙련도를 소모하여, 인사이트 스킬을 습득하세요<br>
11. 단톡에 참여하여 더 많은 정보를 구하세요<br>
                `,
                `
ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
                `,
                `${봄아이콘}`,
                `
25.06.11<br>
일반몬스터를 자동공격하는 반자동 버튼이 구현되었습니다<br>
레어몬스터를 우선 자동공격하는 풀자동 버튼이 구현되었습니다<br>
반자동 또는 풀자동을 재클릭하거나, 외부를 클릭 시 자동사냥이<br>
정지됩니다<br>
자동사냥 이슈로 인한 티켓 1장이 전 유저에게 지급되었습니다<br>
                `,
                `
25.06.10<br>
초기화면을 전투화면에서 메뉴얼 화면으로 수정했습니다<br>
                `,
                `
25.06.09<br>
유물뽑기로만 등장하는 '플라워', '뼈다구'를 9개 이상 보유 시<br>
뽑기에서 더이상 등장하지 않습니다<br>
'도박' 을 '뽑기'로 변경하였습니다<br>
무기 '루시퍼의 심장'을 강화할 수 있습니다<br>
캐시샵에 '1억골드'가 추가되었습니다<br>
보스누적데미지 랭킹보상이 골드에서 티켓으로 변경되었습니다<br>
대격변 기념 햄버거4개, 플라워1개, 뼈다구1개가 배송되었습니다<br>
연속고급장비뽑기 10+1회 로직을 구현하였습니다<br>
보스화면이 '월드'화면으로 통합되었습니다<br>
직업초기화 시 유저아이디가 사라지는 버그 해결<br>
전투화면 외에서도 단축키가 사용되던 버그 해결<br>
신규유저 100만골 회원가입 이벤트 시작<br>
  `,
                `
25.06.08<br>
전당화면에서 유저정보가 빈칸으로 표시되던 문제를 해결했습니다<br>
뽑기창에서 과금상품목록을 제거했습니다<br>
과금상품 목록이 정보-캐시샵으로 이동되었습니다<br>
유물. 플라워와 뼈다구의 판매기능이 삭제되었습니다<br>
플라워와 뼈다구의 과금금액이 1,100원으로 변경되었습니다<br>
전투화면(에너지바)에 모래시계의 발동효과가 추가되었습니다<br>
장비효과가 개편되었습니다<br>
지금부턴 최고공격력 장비만 자동 장착됩니다<br>
장비 누적공격력 시스템이 삭제되었습니다<br>
장비자동합성 기능이 구현되었습니다<br>
장비화면 오른쪽 상단의 자동합성 버튼을 클릭하세요<br>
  `,
                `
25.06.06<br>
드디어, 모바일에서도 '풀자동' 사냥이 가능합니다<br>
전당화면 미니장비창이 미니정보창으로 개선되었습니다<br>
  `,
                `
25.06.05<br>
직업이 구현되었습니다<br>
유물. 뼈다구가 추가되었습니다(직업초기화)<br>
과금상품에 플라워가 부활, 뼈다구가 추가되었습니다<br>
전직화면에서 전직 타이틀 클릭 시 직업초기화가 가능합니다<br>
전 유저에게 뼈다구 1개가 지급되었습니다<br>
레벨당 공격력이 1로 너프되었습니다<br>
전당화면에서 미니정보창 표시 로직을 개선했습니다<br>
전당화면에 전직 대신 직업이 표시됩니다<br>
무너진 악마성을 재건하였습니다. 4층 위로 올라갈 수 있습니다<br>
  `,
                `
25.06.03<br>
업데이트 시 자동새로고침<br>
모바일 화면 최적화 업데이트<br>
탈퇴 버튼을 정보-내정보 최하단으로 이동했습니다<br>
  `,
                `
25.06.02<br>
과금상품에서 유물. 플라워가 삭제되었습니다<br>
정보-내정보 화면이 추가되었습니다<br>
오늘부터 신규유저에겐 생성일이 등록됩니다
  `,
                `
25.06.01<br>
무료서버에서 유료서버 전환 기념 뽀나스 햄버거 1개 배송<br>
<s>유물. 플라워가 과금상품에 추가되었습니다</s><br>
유물화면에서 소모성 유물과 과금유물을 구분하였습니다<br>
오늘은 오픈기념 이벤트 마지막 날이자, 주인장 생일입니다<br>기념으로 금일 햄버거는 1+1 배송됩니다<br>
암포라 발동효과가 기존 9에서 5로 상향되었습니다<br>
10연 유물뽑기이 구현되었습니다<br>
보스 공통미션 보상 '펫'과 누적데미지 순위별 골드보상이<br>지급되었습니다
  `,
                `
25.05.30<br>
10연 고급장비뽑기 시 무료1회 추가기능은 실패했습니다<br>대신, 10연 고급장비뽑기 시 보너스 티켓 한장이 지급됩니다<br>
10연 일반장비뽑기과 10연 고급장비뽑기 업데이트<br>
유물. 암포라의 수치표기를 바르게 수정했습니다
  `,
                `
25.05.29<br>
주인장 득템 기념 햄버거 1+1 지급
  `,
                `
25.05.28<br>
이제 유물. 플라워(스킬초기화)를 판매할 수 있습니다<br>
오픈기념 햄버거 1개가 6월1일까지 오후3시 경 배달됩니다<br>
과금은 오픈톡 '가글주인장' 문의<br>
과금상품. 햄버거정기배송(4900원). 한달간 매일 스태+300<br>
과금상품. 마법의팔레트(1100원). 한달간 아이디 염색
  `,
                `
25.05.27<br>
<s>오픈기념 샐러드5개가 일주일간 오후3시에 배달됩니다</s>
  `,
                `
25.05.26<br>
유물설명에 1개 효과 기입<br>
최대체력이 정상화됩니다<br>
오후 3시 6분 정식출시<br>
cbt 종료
  `,
                `
25.05.25<br>
신규유저 이벤트로 샐러드 5개가 지급됩니다<br>
유물. 샐러드(스태미너회복)가 구현되었습니다<br>
cbt 마지막날 보너스골드와 숙련도가 지급되었습니다<br>
<s>1주차 보스 미노타우르스가 강림중입니다</s><br>
<s>보스 2단계 보상 아이스골렘 펫이 구현되었습니다</s><br>
악마성이 무너져 4층까지만 남았습니다
  `,
                `
25.05.24<br>
고급장비뽑기은 레어부터 타락까지 드랍됩니다<br>
일반장비뽑기은 일반부터 태초까지 드랍됩니다<br>
보스전 스태미너 소모가 10으로 너프되었습니다<br>
유저의 최대체력은 고등급 장비(태초,타락)로만 증가합니다<br>
유물. 티켓(고급장비뽑기)이 유물뽑기으로만 등장합니다<br>
유물. 플라워(스킬초기화)가 유물뽑기으로만 등장합니다
  `,
                `
25.05.23<br>
각 화면에 대한 설명을 표시<br>
보스화면 내 순위 별도 표시<br>
클로버 유물효과 뽑기확률증가로 변경<br>
<s>신규유저 이벤트 10만골드 뽑기 가즈ㅏㅏ</s><br>
3시 10분 5월 26일 오픈 전 마지막 cbt 초기화 진행
  `,
                `
25.05.22<br>
보스 펫 보상 로직 변경<br>
유물뽑기 업데이트
  `,
                `
25.05.21<br>
정보 버튼에서 전당 분리<br>
보스컨텐츠 공통보상 '펫'구현 시작<br>
보스컨텐츠 대충 구현 완료
  `,
                `
25.05.20<br>
메뉴얼,전당,탈퇴 버튼을 정보 버튼으로 통합<br>
스킬초기화 안되게할랬찌만, 유물 소모로 구현<br>
패치노트 기록하기로 결심
  `,
                "ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ",
                `${가을아이콘}`,
                "가글(gagl)에 찾아와 주셔서 감사합니다",
                "가글은 25년 3월 1일을 시작으로 25년 4월 15일 낮 12시 40분경",
                "서비스를 종료 한 마글(magl)이란 게임의 팬게임으로",
                "제작을 시작한 게임입니다",
                "저는 코딩을 모르는 평범한 아재이며, 가글의 제작은",
                "100% 챗지피티로 제작되고 있는 점 알아주시면 감사하겠습니다",
                "최대한 노력하겠지만, 게임의 수명은 장담할 수 없는 점",
                "심심한 이해를 부탁드립니다",
                "주인장이 운영중인 오픈톡이 존재하지만, 귀찮으신분들은",
                "오픈톡에 '가글주인장'을 검색하시면 제 프로필이 나옵니다",
                "1:1채팅으로 문의를 주시면 최대한 빠르게 조치해드리도록",
                "하겠습니다",
                "최초버그를 제보해주시면, 소소한 스태미너 보상을 드리겠습니다",
                "ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ",
                `${겨울아이콘}`,
                "화면 최상단 아이디를 클릭하시면, 아이디 변경이 가능합니다",
                "모든 팝업창은 외부를 클릭 시 닫힙니다",
                "스태미너는 시간당 60씩 회복됩니다",
                "가글은 기본적으로 자동사냥이 지원되며, 레어몬스터 등장 시",
                "자동사냥이 멈추게 됩니다",
                "스페이스바를 한번만 치시면 레어몬스터를 우선 공격하는",
                "풀 자동사냥이 가능합니다",
                "누르고 계시면 안됩니다",
                `<s>레벨업당 5의 공격력이 증가합니다</s>`,
                "뽑기은 최소 일반장비가 드랍됩니다",
                "모든 스킬은 단계가 존재하며, 습득한 스킬 효과만 적용됩니다",
                "전투로그의 아이콘으로 스킬의 발동여부를 확인하실 수 있습니다",
                "유물의 효과는 대부분 개당 1%의 효과가 곱연산이지만,",
                "밸런스상 예외로 0.1%거나 합연산, 소모성 유물도 존재합니다",
                `<s>장비는 중복 드랍할수록 합성횟수가 증가하게되고,</s>`,
                `<s>합성횟수당 유저의 최대체력 1과 공격력이 누적됩니다</s>`,
                "보스 누적데미지 목표달성 전유저 공통보상은 펫입니다",
                "목표달성에 따라 최종공격력을 10%, 20%, 30% 증가시켜주는",
                "펫을 획득할 수 있으며, 다음 보스가 등장하기 전까지 가글의",
                "모든 화면에 펫이 떠다니게됩니다",
            ];

            for (const 문장 of 문장들) {
                const 줄 = document.createElement("div");
                줄.innerHTML = 문장;
                줄.style.margin = "5px 0"; // 줄 간격
                줄.style.textAlign = "center";
                컨테이너.appendChild(줄);
            }

        });


        document.getElementById("전당").addEventListener("click", () => {
            if (!유저데이터) return;
            전당화면보여주기();
        });

        async function 전당화면보여주기() {
            화면잠금();
            모든화면숨기기();
            document.getElementById("화면설명").innerHTML = "유저를 클릭하면 해당유저의 정보를 확인할 수 있습니다";

            document.getElementById("전당화면").style.display = "block";

            document.getElementById("획득로그").innerText = "";
            document.getElementById("추가획득로그").innerText = "";
            document.getElementById("레벨업표시").innerText = "";

            const 컨테이너 = document.getElementById("전당컨테이너");
            컨테이너.innerHTML = "";

            const 응답 = await fetch("/ranking", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
            });

            const 결과 = await 응답.json();
            const 유저들 = 결과.유저들 || [];
            // const 내순위 = 결과.내순위;
            const 보스랭킹 = 결과.보스랭킹 || [];

            유저들.forEach((유저, index) => {
                const 줄 = document.createElement("div");
                줄.className = "밑줄 양쪽정렬";
                줄.style.display = "flex";
                줄.style.justifyContent = "space-between";
                줄.style.width = "100%";

                if (유저.유저아이디 === 유저데이터.유저아이디) 줄.classList.add("내아이디강조");

                let 왼쪽표시;
                if (index === 0) {
                    왼쪽표시 = `<svg class="lucide lucide-crown" style="color: gold;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"/><path d="M5 21h14"/></svg>`;
                } else if (index === 1) {
                    왼쪽표시 = `<svg class="lucide lucide-crown" style="color: silver;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"/><path d="M5 21h14"/></svg>`;
                } else if (index === 2) {
                    왼쪽표시 = `<svg class="lucide lucide-crown" style="color: peru;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"/><path d="M5 21h14"/></svg>`;
                } else {
                    왼쪽표시 = `<span style="width:24px; display:inline-block;">${index + 1}</span>`;
                }

                const 왼쪽 = document.createElement("div");
                왼쪽.innerHTML = 왼쪽표시;
                왼쪽.style.flex = "0 0 auto";

                const 오른쪽 = document.createElement("div");

                let 닉네임표시 = 유저.유저아이디;

                const 팔레트 = 유저.마법의팔레트;
                if (팔레트 === "민초") {
                    닉네임표시 = `<span class="마법의팔레트민초">${닉네임표시}</span>`;
                } else if (팔레트 === "지옥") {
                    닉네임표시 = `<span class="마법의팔레트지옥">${닉네임표시}</span>`;
                } else if (팔레트 === "블라섬") {
                    닉네임표시 = `<span class="마법의팔레트블라섬">${닉네임표시}</span>`;
                } else if (팔레트 === "가글") {
                    닉네임표시 = `<span class="마법의팔레트가글">${닉네임표시}</span>`;
                } else if (팔레트 === "겨울") {
                    닉네임표시 = `<span class="마법의팔레트겨울">${닉네임표시}</span>`;
                } else if (팔레트 === "네온사인") {
                    닉네임표시 = `<span class="마법의팔레트네온사인">${닉네임표시}</span>`;
                } else if (팔레트 === "핑크오션") {
                    닉네임표시 = `<span class="마법의팔레트핑크오션">${닉네임표시}</span>`;
                } else if (팔레트 === "황혼하늘") {
                    닉네임표시 = `<span class="마법의팔레트황혼하늘">${닉네임표시}</span>`;
                } else if (팔레트 === "에메랄드숲") {
                    닉네임표시 = `<span class="마법의팔레트에메랄드숲">${닉네임표시}</span>`;
                }

                // 1) 각 계열별 직업 배열을 미리 정의해 둡니다.
                const 검술 = ["나이트", "글라디에이터", "엠퍼러", "로열가드", "그랑스워드", "카이저"];
                const 마술 = ["매지션", "워록", "아크메이지", "소서러", "그랑에이지", "자베러"];
                const 신술 = ["클레릭", "프리스트", "비숍", "프린세스", "그랑세이지", "퀸"];
                const 궁술 = ["스나이퍼", "레인저", "헌터", "하이랜더", "그랑아처", "제너럴"];

                // … (유저데이터.직업결정은 { "신술": 6 } 같은 객체 형태로 들어있다고 가정)

                const 결정객체 = 유저.직업결정;  // 예: { "신술": 6 }

                if (결정객체) {
                    // 첫 번째(유일한) 키만 꺼냅니다. → "신술"
                    const 계열키 = Object.keys(결정객체)[0];
                    // 해당 키의 값(단계)을 꺼냅니다. → 6
                    const 단계 = 결정객체[계열키];

                    // 단계(숫자)에 해당하는 실제 직업명을 찾아서 변수에 저장
                    let 직업이름;
                    if (계열키 === "검술") {
                        직업이름 = 검술[단계 - 1];   // 예: 단계=1 → 검술[0] = "나이트"
                    } else if (계열키 === "마술") {
                        직업이름 = 마술[단계 - 1];
                    } else if (계열키 === "신술") {
                        직업이름 = 신술[단계 - 1];   // 단계=6 → 신술[5] = "퀸"
                    } else if (계열키 === "궁술") {
                        직업이름 = 궁술[단계 - 1];
                    } else {
                        직업이름 = "-";
                    }


                    오른쪽.innerHTML = `[${직업이름}] ${닉네임표시} (lv.${유저.레벨 || 1}) - 공격력 ${유저.최종공격력} / ${유저.현재층}층`;
                } else {
                    오른쪽.innerHTML = `${닉네임표시} (lv.${유저.레벨 || 1}) - 공격력 ${유저.최종공격력} / ${유저.현재층}층`;

                }

                오른쪽.style.flex = "1";
                오른쪽.style.textAlign = "right";

                줄.appendChild(왼쪽);
                줄.appendChild(오른쪽);

                줄.addEventListener("click", (e) => {
                    e.stopPropagation();
                    const 창 = document.getElementById("미니정보창");

                    // 이미 떠 있으면 닫기만
                    if (창.style.display === "block") {
                        창.style.display = "none";
                        return;
                    }

                    // 위치 계산 후 표시
                    const rect = 줄.getBoundingClientRect();
                    창.style.left = `${rect.left}px`;
                    창.style.top = `${rect.bottom + 6}px`;
                    창.style.display = "block";

                    창.innerHTML = "";

                    // ─── 첫째줄부터 넷째줄까지 2칸짜리 행 생성 ───
                    const 첫째줄행 = 한줄에두칸("첫째줄왼쪽", "첫째줄오른쪽");
                    const 둘째줄행 = 한줄에두칸("둘째줄왼쪽", "둘째줄오른쪽");
                    const 셋째줄행 = 한줄에두칸("셋째줄왼쪽", "셋째줄오른쪽");
                    const 넷째줄행 = 한줄에두칸("넷째줄왼쪽", "넷째줄오른쪽");
                    const 다섯째줄행 = 한줄에두칸("다섯째줄왼쪽", "다섯째줄오른쪽");
                    const 여섯째줄행 = 한줄에두칸("여섯째줄왼쪽", "여섯째줄오른쪽");

                    // ─── 다섯째줄(=열째줄) 3칸짜리 행 생성 ───
                    const 열째줄행 = 한줄에세칸(
                        ["열째줄왼쪽", "열째줄가운데", "열째줄오른쪽"],
                        "기본테두리"
                    );

                    const 열한째줄행 = 한줄에세칸(
                        ["열한째줄왼쪽", "열한째줄가운데", "열한째줄오른쪽"],
                        ""
                    );

                    // ─── 컨테이너에 차례대로 붙이기 ───
                    창.appendChild(첫째줄행);
                    창.appendChild(둘째줄행);
                    창.appendChild(셋째줄행);
                    창.appendChild(넷째줄행);
                    창.appendChild(다섯째줄행);
                    창.appendChild(여섯째줄행);
                    창.appendChild(열째줄행);
                    창.appendChild(열한째줄행);



                    // ─── 내용 채우기 ───
                    창.querySelector("#첫째줄왼쪽").innerHTML = `아이디 : ${유저.유저아이디}`;
                    창.querySelector("#둘째줄왼쪽").innerHTML = `공격력 : ${유저.최종공격력}`;
                    창.querySelector("#셋째줄왼쪽").innerHTML = `최대체력 : ${유저.최대체력}`;
                    창.querySelector("#넷째줄왼쪽").innerHTML = `전당 : ${index + 1}위`;

                    창.querySelector("#둘째줄오른쪽").innerHTML = (유저.현질기한 !== undefined && 유저.현질기한 !== 0) ? `마법의팔레트 : ${유저.현질기한}/30` : `마법의팔레트 : -`;
                    창.querySelector("#셋째줄오른쪽").innerHTML = (유저.햄버거현질기한 !== undefined && 유저.햄버거현질기한 !== 0) ? `햄버거정기배송 : ${유저.햄버거현질기한}/30` : `햄버거정기배송 : -`;
                    창.querySelector("#넷째줄오른쪽").innerHTML = 유저.생성일 ? `생성일 : ${유저.생성일}` : `생성일 : -`;

                    const bossIndex = 보스랭킹.findIndex(u => u.유저UID === 유저.유저UID);

                    if (bossIndex >= 0) {
                        // 순위가 있으면 “XX위” 형식으로 표시
                        const bossRank = bossIndex + 1;
                        창.querySelector("#다섯째줄왼쪽").innerText = `보스 : ${bossRank}위`;
                    } else {
                        // 순위가 없으면 “-”만 표시
                        창.querySelector("#다섯째줄왼쪽").innerText = `보스 : -`;
                    }
                    창.querySelector("#다섯째줄오른쪽").innerHTML = (유저.스태미너소모총량 !== undefined && 유저.스태미너소모총량 !== 0) ? `전적 : ${유저.스태미너소모총량}전` : `전적 : -`;

                    // 1) 각 계열별 직업 배열을 미리 정의해 둡니다.
                    const 검술 = ["나이트", "글라디에이터", "엠퍼러", "로열가드", "그랑스워드", "카이저"];
                    const 마술 = ["매지션", "워록", "아크메이지", "소서러", "그랑에이지", "자베러"];
                    const 신술 = ["클레릭", "프리스트", "비숍", "프린세스", "그랑세이지", "퀸"];
                    const 궁술 = ["스나이퍼", "레인저", "헌터", "하이랜더", "그랑아처", "제너럴"];

                    // … (유저.직업결정은 { "신술": 6 } 같은 객체 형태로 들어있다고 가정)

                    const 결정객체 = 유저.직업결정;  // 예: { "신술": 6 }
                    if (결정객체) {
                        // 첫 번째(유일한) 키만 꺼냅니다. → "신술"
                        const 계열키 = Object.keys(결정객체)[0];
                        // 해당 키의 값(단계)을 꺼냅니다. → 6
                        const 단계 = 결정객체[계열키];

                        // 단계(숫자)에 해당하는 실제 직업명을 찾아서 변수에 저장
                        let 직업이름;
                        if (계열키 === "검술") {
                            직업이름 = 검술[단계 - 1];   // 예: 단계=1 → 검술[0] = "나이트"
                        } else if (계열키 === "마술") {
                            직업이름 = 마술[단계 - 1];
                        } else if (계열키 === "신술") {
                            직업이름 = 신술[단계 - 1];   // 단계=6 → 신술[5] = "퀸"
                        } else if (계열키 === "궁술") {
                            직업이름 = 궁술[단계 - 1];
                        } else {
                            직업이름 = "-";
                        }

                        // 화면에 “신술(퀸)” 형태로 표시
                        창.querySelector("#여섯째줄왼쪽").innerHTML = `직업 : [${계열키}] ${직업이름}`;
                    } else {
                        // 아직 선택된 직업이 없으면 ‘-’만 표시
                        창.querySelector("#여섯째줄왼쪽").innerHTML = "직업 : -";
                    }


                    // ─── “공격력 최댓값 장비” 찾기 및 표시 ───
                    const 목록 = 유저.장비목록;
                    let bestWeapon = null;
                    if (Array.isArray(목록) && 목록.length) {
                        bestWeapon = 목록.reduce((prev, cur) =>
                            Number(cur.공격력) > Number(prev.공격력) ? cur : prev
                        );
                    }

                    const 장비박스1 = 창.querySelector("#열째줄왼쪽");  // 첫 번째 칸 사용

                    if (bestWeapon) {
                        // 🔹 강화수치 있으면 "+n" 붙이기
                        const 강화표시 = bestWeapon.강화 ? ` +${bestWeapon.강화}` : "";
                        장비박스1.innerText = `${bestWeapon.이름}${강화표시}`;
                        장비박스1.style.color = 색상맵[bestWeapon.등급] || "#fff";
                    } else {
                        장비박스1.innerText = "장비가 없습니다";
                        장비박스1.style.color = "#fff";
                    }


                    // 필요하다면 두 번째·세 번째 박스에도 같은 방식으로 내용 채우기
                    const 장비박스2 = 창.querySelector("#열째줄가운데");
                    장비박스2.innerHTML = "가장쎈방어구";
                    const 장비박스3 = 창.querySelector("#열째줄오른쪽");
                    장비박스3.innerHTML = "가장쎈장신구";


                    창.querySelector("#열한째줄가운데").innerHTML = ``;

                });



                컨테이너.appendChild(줄);
            });
            화면해제();
        }




        function 펫보여주기(아이콘HTML, 색상코드 = "#ffffff") {
            const 펫 = document.getElementById("펫컨테이너");
            펫.innerHTML = 아이콘HTML;
            펫.style.display = "block";
            펫.style.position = "fixed";
            펫.style.transform = "scale(0.1)";
            펫.style.pointerEvents = "none";
            펫.style.zIndex = "9999";
            펫.style.background = "transparent";

            // ✅ 전달받은 색상코드로 path 채우기
            const paths = 펫.querySelectorAll("path");
            paths.forEach(p => p.setAttribute("fill", 색상코드));

            const 중심X = window.innerWidth / 2;
            const 최소X = 중심X - 500;
            const 최대X = 중심X + 0;
            const 최소Y = 0;
            const 최대Y = 400;

            let x = 중심X;
            let y = 최대Y / 2;
            let vx = (Math.random() - 0.5) * 2;
            let vy = (Math.random() - 0.5) * 2;

            function update() {
                x += vx;
                y += vy;

                if (x < 최소X || x > 최대X) vx *= -1;
                if (y < 최소Y || y > 최대Y) vy *= -1;

                vx += (Math.random() - 0.5) * 0.1;
                vy += (Math.random() - 0.5) * 0.1;

                const 속도 = Math.sqrt(vx * vx + vy * vy);
                const 최대속도 = 1.5;
                if (속도 > 최대속도) {
                    vx *= 최대속도 / 속도;
                    vy *= 최대속도 / 속도;
                }

                펫.style.left = `${x}px`;
                펫.style.top = `${y}px`;

                requestAnimationFrame(update);
            }

            update();
        }

        let 현재보스이름 = "그루트"; // 이 줄만 수정하면 전부 연동됨

        // 보스화면보여주기
        document.getElementById("보스").addEventListener("click", () => {
            if (!유저데이터) return;
            화면잠금();
            document.getElementById("화면설명").innerHTML =
                "보스전에는 스태미너 10이 소모됩니다(월~금)<br>누적데미지 랭킹보상 1등부터 9등까지 티켓10장부터 차등지급";

            const 보스버튼 = document.getElementById("보스");
            fetch("/boss-ranking", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 유저UID: 유저데이터.유저UID })
            })
                .then(res => res.json())
                .then(결과 => {
                    if (결과.오류) {
                        return 메시지표시(보스, "", 결과.오류, "");
                    }

                    document.querySelectorAll(".전투로그컨테이너").forEach(e => e.remove());
                    document.getElementById("최종데미지").innerText = "";

                    모든화면숨기기();
                    document.getElementById("에너지박스").style.display = "block";
                    document.getElementById("보스화면").style.display = "block";

                    const 보스컨테이너 = document.getElementById("보스컨테이너");
                    보스컨테이너.style.marginTop = "15px";
                    보스컨테이너.style.width = "400px";
                    보스컨테이너.style.border = "0.2px solid #4b4b4b";
                    보스컨테이너.style.borderRadius = "10px";
                    보스컨테이너.style.padding = "15px";
                    보스컨테이너.style.display = "flex";
                    보스컨테이너.style.alignItems = "center";
                    보스컨테이너.style.justifyContent = "flex-start";
                    보스컨테이너.style.gap = "10px";

                    const 보스아이콘 = document.getElementById("보스아이콘");
                    보스아이콘.innerHTML = `
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <div style="width: 200px; height: 200px;">
            ${아이콘맵[현재보스이름 + "아이콘"]
                            .replace(/height:\s*\d+px/, 'height: 200px')
                            .replace(/width:\s*\d+px/, 'width: 200px')}
        </div>
    </div>
`;

                    const 목표1 = 999999;
                    const 목표2 = 9999999;
                    const 목표3 = 99999999;
                    const 누적 = 결과.누적데미지총합 || 0;

                    function 만들기단계라인(id, 현재값, 목표값) {
                        const div = document.createElement("div");
                        div.id = id;
                        div.style.border = "0.2px solid #4b4b4b";
                        div.style.display = "flex";
                        div.style.alignItems = "center";
                        div.style.justifyContent = "space-between";
                        div.style.borderRadius = "6px";
                        div.style.padding = "8px";

                        // ✅ 달성한 경우, 현재값을 목표값으로 강제 표기
                        const 표시값 = 현재값 >= 목표값 ? 목표값 : 현재값;

                        const 숫자표시 = `${표시값.toLocaleString()}/${목표값.toLocaleString()}`;
                        const 아이콘HTML = 현재값 >= 목표값 ? 아이콘맵["서클체크아이콘"] : "";

                        div.innerHTML = `
        <span>${숫자표시}</span>
        <span>${아이콘HTML}</span>
    `;
                        return div;
                    }

                    // 단계별 줄 생성
                    const 단계1 = 만들기단계라인("단계1", 누적, 목표1);
                    const 단계2 = 만들기단계라인("단계2", 누적, 목표2);
                    const 단계3 = 만들기단계라인("단계3", 누적, 목표3);

                    // 화면에 추가할 박스 준비
                    const 총합박스 = document.createElement("div");
                    총합박스.id = "단계박스";
                    총합박스.style.display = "flex";
                    총합박스.style.flexDirection = "column";
                    총합박스.style.gap = "10px";
                    총합박스.style.marginTop = "10px";

                    // 조건에 따라 단계별로 추가
                    총합박스.appendChild(단계1);

                    if (누적 >= 목표1) {
                        총합박스.appendChild(단계2);
                    }
                    if (누적 >= 목표2) {
                        총합박스.appendChild(단계3);
                    }

                    보스아이콘.appendChild(총합박스);

                    const 보스몬스터 = document.getElementById("보스몬스터");
                    보스몬스터.innerText = 현재보스이름;

                    const 누적데미지순위 = document.getElementById("누적데미지순위");
                    누적데미지순위.innerHTML = "";
                    누적데미지순위.style.display = "flex";
                    누적데미지순위.style.flexDirection = "column";
                    누적데미지순위.style.alignItems = "flex-start";
                    누적데미지순위.style.justifyContent = "flex-start";
                    누적데미지순위.style.gap = "10px";
                    누적데미지순위.style.textAlign = "left";

                    const 제목 = document.createElement("div");
                    제목.innerText = "누적데미지 순위";
                    누적데미지순위.appendChild(제목);

                    const 유저들 = 결과.순위 || [];
                    유저들.forEach((유저, index) => {
                        if (index >= 9) return;
                        const div = document.createElement("div");
                        div.innerText = `${index + 1}. ${유저.보스누적데미지.toLocaleString()} [${유저.유저아이디}]`;
                        누적데미지순위.appendChild(div);
                    });

                    if (결과.내정보) {
                        const div = document.createElement("div");
                        div.innerText = `${결과.내정보.순위}. ${결과.내정보.보스누적데미지.toLocaleString()} [${결과.내정보.유저아이디}]`;
                        div.style.marginTop = "8px";
                        div.style.backgroundColor = "#505050";
                        누적데미지순위.appendChild(div);
                    }
                    화면해제();

                })
                .catch(err => {
                    console.error("보스 순위 조회 실패", err);
                    화면해제();
                });
        });

        document.getElementById("보스몬스터").addEventListener("click", async () => {
            if (!유저데이터) return;
            공격버튼잠금();

            try {
                const 응답 = await fetch("/attack-boss", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        유저데이터,
                        보스이름: 현재보스이름
                    })
                });

                if (!응답.ok) {
                    const 에러결과 = await 응답.json();
                    const 메시지 = 에러결과.오류 || "오류 발생";
                    const 보스사냥컨테이너 = document.getElementById("보스사냥컨테이너");
                    메시지표시(보스사냥컨테이너, "", 메시지, "");
                    return;
                }

                const 결과 = await 응답.json();
                const 등급외테두리 = document.getElementById("등급외테두리");
                const 보스사냥컨테이너 = document.getElementById("보스사냥컨테이너");

                if (결과.결과 === "불가") {
                    메시지표시(보스사냥컨테이너, "", 결과.메시지 || "스태미너 부족", "");
                    return;
                }

                유저데이터 = 결과.유저데이터;

                // 기존 로그 제거
                document.querySelectorAll(".전투로그컨테이너").forEach(e => e.remove());

                // 전투 로그 출력
                if (Array.isArray(결과.전투로그)) {
                    결과.전투로그.slice().reverse().forEach(로그 => {
                        const 로그컨테이너 = document.createElement("div");
                        로그컨테이너.className = "전투로그컨테이너";
                        로그컨테이너.style.marginTop = "15px";
                        로그컨테이너.style.border = "0.2px solid #4b4b4b";
                        로그컨테이너.style.borderRadius = "10px";
                        로그컨테이너.style.padding = "15px";

                        const 아이콘HTML = (로그.아이콘 || []).map(이름 => 아이콘맵[이름] || "").join(" ");

                        let 데미지텍스트 = "";
                        let 회복텍스트 = "";

                        if (로그.타입 === "공격") {
                            데미지텍스트 = `<span><span style="color: #f63b3b;">${로그.몬스터이름}</span>에게 ${로그.효과} 피해를 입혔다!</span>`;
                        } else if (로그.타입 === "회복") {
                            회복텍스트 = `<span><span style="color: #3b82f6;">${로그.유저아이디}</span> 체력 ${로그.효과} 회복</span>`;
                        }

                        let 추가횟수표시 = "";
                        if (로그.타입 === "공격" && 로그.추가공격횟수 > 0) {
                            // 실제 타격 횟수 = 1(기본) + 로그.추가공격횟수
                            const 총공격횟수 = 1 + 로그.추가공격횟수;
                            추가횟수표시 = `<span style="margin-left: 4px; color: #f63b3b;">x${총공격횟수}</span>`;
                        }

                        // (2) innerHTML에서 공격 텍스트 뒤에 추가횟수표시 붙이기
                        로그컨테이너.innerHTML = `
    <div style="background: #4b4b4b; width: calc(100% + 30px); margin: -15px 0 0 -15px; padding: 6px 0; text-align: center; border-top-left-radius: 10px; border-top-right-radius: 10px;">
        <strong>Turn ${로그.턴}</strong>
    </div>
    <div class="가로정렬" style="margin: 4px 0; align-items: center; gap: 6px;">
        ${아이콘HTML}
        ${로그.타입 === "공격" ? 데미지텍스트 + 추가횟수표시 : ""}
        ${로그.타입 === "회복" ? 회복텍스트 : ""}
    </div>
    
    <div class="가로정렬" style="margin-top: 10px; justify-content: space-between; align-items: center; gap: 12px;">
                        <div style="border: 0.2px solid #3b82f6; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
                            <div>${로그.유저아이디}</div>
                            <div>
                                <div>공격력 ${로그.유저최종공격력}</div>
                                <div>체력 ${로그.유저체력}/${로그.유저최대체력}</div>
                            </div>
                        </div>
                        <div style="border: 0.2px solid #f63b3b; border-radius: 10px; padding: 6px 12px; flex: 1; display: flex; justify-content: space-between; color: white;">
                            <div>${로그.몬스터이름}</div>
                            <div>
                                <div>체력 ???</div>
                                <div>방어력 ???</div>
                            </div>
                        </div>
                    </div>
                `;

                        const 타겟 = document.getElementById("보스사냥컨테이너");
                        if (타겟 && 타겟.parentNode) {
                            타겟.parentNode.insertBefore(로그컨테이너, 타겟.nextSibling);
                        }
                    });
                }

                // 체력, 스태미너, 누적데미지 UI 업데이트
                document.getElementById("악마이름").innerText = 결과.유저데이터?.보스이름 || 현재보스이름;
                document.getElementById("악마체력").innerText = `체력 ???`;  // 보스는 체력 없음
                document.getElementById("악마방어력").innerText = `방어력 0`;
                document.getElementById("유저체력").innerText = `체력 ${유저데이터.남은체력}/${유저데이터.최대체력}`;
                document.getElementById("최종데미지").innerText = `총피해량 : ${결과.누적데미지.toLocaleString()}`;

                const 스태미너표시 = document.getElementById("스태미너표시");
                const 에너지바 = document.querySelector(".에너지바");
                if (스태미너표시 && 에너지바) {
                    const 최대 = 유저데이터.최대스태미너 ?? 100;
                    const 현재 = 유저데이터.현재스태미너 ?? 0;
                    스태미너표시.innerText = `${현재}/${최대}`;
                    에너지바.style.width = `${(현재 / 최대) * 100}%`;
                }

                document.getElementById("승리패배로그").innerText = "보스전 완료";
                document.getElementById("승리패배로그").style.color = "#ffa500";
            } catch (e) {
                메시지표시(메시지표시박스, "", "보스전 오류: " + e.message, "");
            } finally {
                공격버튼잠금해제();
            }
        });


        //캐시샵화면보여주기
        document.getElementById("캐시샵").addEventListener("click", () => {
            if (!유저데이터) return;

            화면잠금();
            모든화면숨기기();
            document.getElementById("화면설명").innerHTML =
                "gagl의 상품들은 소모성 또는 30일 기간제입니다<br>오픈톡 프로필 '가글주인장'에게 문의하세요";

            document.getElementById("캐시샵화면").style.display = "block";

            const 컨테이너 = document.getElementById("캐시샵컨테이너");
            컨테이너.innerHTML = "";

            function 줄추가(왼쪽내용, 오른쪽내용) {
                // 1) 줄 컨테이너
                const 줄 = document.createElement("div");
                줄.className = "밑줄 양쪽정렬";
                줄.style.display = "flex";
                줄.style.justifyContent = "space-between";
                줄.style.alignItems = "center";   // ← 부모 컨테이너 내에서 세로 가운데
                줄.style.width = "100%";

                // 2) 왼쪽 셀
                const leftDiv = document.createElement("div");
                leftDiv.style.display = "flex";      // ← 내부 요소 정렬을 flex로
                leftDiv.style.alignItems = "center"; // ← 아이콘+텍스트 세로 가운데
                leftDiv.style.flex = "0 0 auto";
                leftDiv.innerHTML = 왼쪽내용;

                // 3) 오른쪽 셀
                const rightDiv = document.createElement("div");
                // rightDiv.style.display = "flex";
                rightDiv.style.alignItems = "center"; // ← 텍스트 세로 가운데
                rightDiv.style.flex = "1";
                rightDiv.style.textAlign = "right";
                rightDiv.innerHTML = 오른쪽내용;

                // 4) 조립
                줄.appendChild(leftDiv);
                줄.appendChild(rightDiv);
                컨테이너.appendChild(줄);
            }

            // — 여기 데이터 배열에 원하는 만큼 줄 정보를 추가 —
            const 줄데이터 = [
                { 왼쪽: `${마법의팔레트아이콘}(마법의팔레트)`, 오른쪽: "아이디를 색칠할 수 있습니다(1,100원)" },
                { 왼쪽: `${플라워아이콘}(플라워)`, 오른쪽: "스킬을 초기화합니다(1,100원)" },
                { 왼쪽: `${뼈다구아이콘}(뼈다구)`, 오른쪽: "직업을 초기화합니다(1,100원)" },
                { 왼쪽: `${햄버거아이콘}(햄버거정기배송)`, 오른쪽: "매일 햄버거(스태미너+300) 배송(4,900원)" },
                { 왼쪽: `${현질아이콘}(1억골드)`, 오른쪽: "랭커로 만들어 드립니다(1,000,000원)" },

            ];

            // — 배열 순회하며 자동으로 줄 추가 —
            줄데이터.forEach(item => 줄추가(item.왼쪽, item.오른쪽));

            화면해제();
        });




    </script>
</body>

</html>